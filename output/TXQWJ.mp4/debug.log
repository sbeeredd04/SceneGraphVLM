2025-02-06 10:27:08,514 - INFO - Processing video: TXQWJ.mp4
2025-02-06 10:27:08,516 - INFO - Found 20 frames for video TXQWJ.mp4
2025-02-06 10:27:08,518 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 10:27:08,518 - DEBUG - Found scene graph for frame TXQWJ.mp4/000052.png
2025-02-06 10:27:08,518 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 10:27:08,519 - DEBUG - Found scene graph for frame TXQWJ.mp4/000153.png
2025-02-06 10:27:08,519 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 10:27:08,519 - DEBUG - Found scene graph for frame TXQWJ.mp4/000255.png
2025-02-06 10:27:08,519 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 10:27:08,519 - DEBUG - Found scene graph for frame TXQWJ.mp4/000353.png
2025-02-06 10:27:08,519 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 10:27:08,520 - DEBUG - Found scene graph for frame TXQWJ.mp4/000357.png
2025-02-06 10:27:08,520 - DEBUG - No valid objects found in annotations for frame TXQWJ.mp4/000421.png
2025-02-06 10:27:08,520 - WARNING - No scene graph found for frame TXQWJ.mp4/000421.png
2025-02-06 10:27:08,520 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 10:27:08,520 - DEBUG - Found scene graph for frame TXQWJ.mp4/000458.png
2025-02-06 10:27:08,521 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 10:27:08,521 - DEBUG - Found scene graph for frame TXQWJ.mp4/000486.png
2025-02-06 10:27:08,522 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 10:27:08,522 - DEBUG - Found scene graph for frame TXQWJ.mp4/000489.png
2025-02-06 10:27:08,522 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 10:27:08,522 - DEBUG - Found scene graph for frame TXQWJ.mp4/000533.png
2025-02-06 10:27:08,529 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 10:27:08,529 - DEBUG - Found scene graph for frame TXQWJ.mp4/000545.png
2025-02-06 10:27:08,529 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 10:27:08,529 - DEBUG - Found scene graph for frame TXQWJ.mp4/000557.png
2025-02-06 10:27:08,529 - DEBUG - Extracted scene graph with 4 objects and 12 relationships
2025-02-06 10:27:08,529 - DEBUG - Found scene graph for frame TXQWJ.mp4/000603.png
2025-02-06 10:27:08,530 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 10:27:08,530 - DEBUG - Found scene graph for frame TXQWJ.mp4/000625.png
2025-02-06 10:27:08,530 - DEBUG - Extracted scene graph with 4 objects and 12 relationships
2025-02-06 10:27:08,530 - DEBUG - Found scene graph for frame TXQWJ.mp4/000649.png
2025-02-06 10:27:08,530 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 10:27:08,530 - DEBUG - Found scene graph for frame TXQWJ.mp4/000661.png
2025-02-06 10:27:08,530 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 10:27:08,530 - DEBUG - Found scene graph for frame TXQWJ.mp4/000720.png
2025-02-06 10:27:08,530 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 10:27:08,531 - DEBUG - Found scene graph for frame TXQWJ.mp4/000765.png
2025-02-06 10:27:08,531 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 10:27:08,531 - DEBUG - Found scene graph for frame TXQWJ.mp4/000881.png
2025-02-06 10:27:08,531 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 10:27:08,531 - DEBUG - Found scene graph for frame TXQWJ.mp4/000997.png
2025-02-06 10:27:08,531 - INFO - Extracted 19 scene graphs
2025-02-06 10:27:08,531 - INFO - Split 19 graphs chronologically into 15 train and 4 test
2025-02-06 10:27:08,532 - DEBUG - Training frames: TXQWJ.mp4/000052.png to TXQWJ.mp4/000661.png
2025-02-06 10:27:08,532 - DEBUG - Testing frames: TXQWJ.mp4/000720.png to TXQWJ.mp4/000997.png
2025-02-06 10:27:08,532 - INFO - Generating 4 sequential predictions using closed vocabulary
2025-02-06 10:27:08,532 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 10:27:08,532 - DEBUG - Starting with 15 training frames
2025-02-06 10:27:08,532 - DEBUG - Frame numbers: [52, 153, 255, 353, 357, 458, 486, 489, 533, 545, 557, 603, 625, 649, 661]
2025-02-06 10:27:08,533 - DEBUG - ============================

2025-02-06 10:27:08,533 - INFO - Found 4 test frames to predict after frame 661
2025-02-06 10:27:08,533 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 10:27:08,533 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 10:27:08,533 - DEBUG - Predicting 4 frames: [720, 765, 881, 997]
2025-02-06 10:27:08,533 - DEBUG - Context has 15 frames
2025-02-06 10:27:08,533 - DEBUG - Last 3 context frames: [625, 649, 661]
2025-02-06 10:27:08,547 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000625:
Objects:
  - food
  - groceries
  - bag
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at groceries
  - person in_front_of groceries
  - person holding groceries
  - person looking_at bag
  - person in_front_of bag
  - person touching bag

Frame 000649:
Objects:
  - food
  - groceries
  - bag
  - cup/glass/bottle
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at groceries
  - person in_front_of groceries
  - person touching groceries
  - person looking_at bag
  - person in_front_of bag
  - person touching bag
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person not_contacting cup/glass/bottle

Frame 000661:
Objects:
  - food
  - groceries
  - bag
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at groceries
  - person in_front_of groceries
  - person touching groceries
  - person looking_at bag
  - person in_front_of bag
  - person touching bag

========================

2025-02-06 10:27:08,548 - DEBUG - 
=======PROMPT========

2025-02-06 10:27:08,548 - DEBUG - Given the sequence of scene graphs below, predict the next 4 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (15 frames, 52 to 661):
            
Frame 000052:
Objects:
  - cup/glass/bottle
Relationships:
  - person looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle


Frame 000153:
Objects:
  - cup/glass/bottle
Relationships:
  - person looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person drinking_from cup/glass/bottle


Frame 000255:
Objects:
  - cup/glass/bottle
Relationships:
  - person looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle
  - person drinking_from cup/glass/bottle


Frame 000353:
Objects:
  - cup/glass/bottle
Relationships:
  - person not_looking_at cup/glass/bottle
  - person beneath cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle


Frame 000357:
Objects:
  - cup/glass/bottle
Relationships:
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle


Frame 000458:
Objects:
  - bag
Relationships:
  - person unsure bag
  - person on_the_side_of bag
  - person in_front_of bag
  - person not_contacting bag


Frame 000486:
Objects:
  - food
  - bag
  - cup/glass/bottle
Relationships:
  - person looking_at food
  - person in_front_of food
  - person not_contacting food
  - person looking_at bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle


Frame 000489:
Objects:
  - food
  - groceries
  - bag
Relationships:
  - person not_looking_at food
  - person in_front_of food
  - person not_contacting food
  - person looking_at groceries
  - person in_front_of groceries
  - person not_contacting groceries
  - person looking_at bag
  - person in_front_of bag
  - person on_the_side_of bag
  - person not_contacting bag


Frame 000533:
Objects:
  - food
  - groceries
  - bag
Relationships:
  - person not_looking_at food
  - person in_front_of food
  - person not_contacting food
  - person unsure groceries
  - person in_front_of groceries
  - person not_contacting groceries
  - person unsure bag
  - person in_front_of bag
  - person not_contacting bag


Frame 000545:
Objects:
  - food
  - groceries
  - bag
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at groceries
  - person in_front_of groceries
  - person touching groceries
  - person looking_at bag
  - person in_front_of bag
  - person not_contacting bag


Frame 000557:
Objects:
  - food
  - groceries
  - bag
Relationships:
  - person looking_at food
  - person in_front_of food
  - person touching food
  - person looking_at groceries
  - person in_front_of groceries
  - person touching groceries
  - person looking_at bag
  - person in_front_of bag
  - person touching bag


Frame 000603:
Objects:
  - food
  - groceries
  - bag
  - cup/glass/bottle
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person looking_at groceries
  - person in_front_of groceries
  - person touching groceries
  - person looking_at bag
  - person in_front_of bag
  - person touching bag
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person not_contacting cup/glass/bottle


Frame 000625:
Objects:
  - food
  - groceries
  - bag
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at groceries
  - person in_front_of groceries
  - person holding groceries
  - person looking_at bag
  - person in_front_of bag
  - person touching bag


Frame 000649:
Objects:
  - food
  - groceries
  - bag
  - cup/glass/bottle
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at groceries
  - person in_front_of groceries
  - person touching groceries
  - person looking_at bag
  - person in_front_of bag
  - person touching bag
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person not_contacting cup/glass/bottle


Frame 000661:
Objects:
  - food
  - groceries
  - bag
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at groceries
  - person in_front_of groceries
  - person touching groceries
  - person looking_at bag
  - person in_front_of bag
  - person touching bag

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 4 frames ([720, 765, 881, 997]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 10:27:08,548 - DEBUG - 
===================

2025-02-06 10:27:15,411 - DEBUG - 
=======BATCH PREDICTIONS========
2025-02-06 10:27:15,413 - DEBUG - 
Prediction for frame 720:
2025-02-06 10:27:15,413 - DEBUG - Objects:
2025-02-06 10:27:15,413 - DEBUG -   - food
2025-02-06 10:27:15,413 - DEBUG -   - groceries
2025-02-06 10:27:15,414 - DEBUG -   - bag
2025-02-06 10:27:15,414 - DEBUG - Relationships:
2025-02-06 10:27:15,414 - DEBUG -   - person looking_at food
2025-02-06 10:27:15,414 - DEBUG -   - person in_front_of food
2025-02-06 10:27:15,414 - DEBUG -   - person holding food
2025-02-06 10:27:15,414 - DEBUG -   - person looking_at groceries
2025-02-06 10:27:15,414 - DEBUG -   - person in_front_of groceries
2025-02-06 10:27:15,414 - DEBUG -   - person holding groceries
2025-02-06 10:27:15,414 - DEBUG -   - person looking_at bag
2025-02-06 10:27:15,414 - DEBUG -   - person in_front_of bag
2025-02-06 10:27:15,414 - DEBUG -   - person carrying bag
2025-02-06 10:27:15,415 - DEBUG - 
Prediction for frame 765:
2025-02-06 10:27:15,415 - DEBUG - Objects:
2025-02-06 10:27:15,415 - DEBUG -   - food
2025-02-06 10:27:15,415 - DEBUG -   - groceries
2025-02-06 10:27:15,415 - DEBUG -   - bag
2025-02-06 10:27:15,415 - DEBUG -   - table
2025-02-06 10:27:15,415 - DEBUG - Relationships:
2025-02-06 10:27:15,415 - DEBUG -   - person looking_at table
2025-02-06 10:27:15,415 - DEBUG -   - person in_front_of table
2025-02-06 10:27:15,415 - DEBUG -   - person placing table
2025-02-06 10:27:15,416 - DEBUG -   - person placing table
2025-02-06 10:27:15,416 - DEBUG -   - person placing table
2025-02-06 10:27:15,416 - DEBUG -   - food on_the_side_of table
2025-02-06 10:27:15,416 - DEBUG -   - groceries on_the_side_of table
2025-02-06 10:27:15,416 - DEBUG -   - bag on_the_side_of table
2025-02-06 10:27:15,416 - DEBUG - 
Prediction for frame 881:
2025-02-06 10:27:15,416 - DEBUG - Objects:
2025-02-06 10:27:15,416 - DEBUG -   - table
2025-02-06 10:27:15,416 - DEBUG - Relationships:
2025-02-06 10:27:15,416 - DEBUG -   - person not_looking_at table
2025-02-06 10:27:15,416 - DEBUG -   - person behind table
2025-02-06 10:27:15,417 - DEBUG - 
Prediction for frame 997:
2025-02-06 10:27:15,417 - DEBUG - Objects:
2025-02-06 10:27:15,417 - DEBUG -   - chair
2025-02-06 10:27:15,417 - DEBUG -   - person
2025-02-06 10:27:15,417 - DEBUG - Relationships:
2025-02-06 10:27:15,417 - DEBUG -   - person sitting_on chair
2025-02-06 10:27:15,417 - DEBUG - Added 4 predictions to context
2025-02-06 10:27:15,417 - DEBUG - Context size now: 19 frames
2025-02-06 10:27:15,418 - DEBUG - ============================

2025-02-06 10:27:15,418 - INFO - Visualizing results...
2025-02-06 10:27:15,418 - DEBUG - Visualizing comparison for frame TXQWJ.mp4/000720.png
2025-02-06 10:27:15,540 - DEBUG - Visualizing comparison for frame TXQWJ.mp4/000765.png
2025-02-06 10:27:15,628 - DEBUG - Visualizing comparison for frame TXQWJ.mp4/000881.png
2025-02-06 10:27:15,711 - DEBUG - Visualizing comparison for frame TXQWJ.mp4/000997.png
2025-02-06 10:27:15,792 - INFO - Completed processing video: TXQWJ.mp4
2025-02-06 10:27:15,792 - INFO - Waiting 60 seconds before next video...
2025-02-06 10:28:15,792 - INFO - 
==================================================
Processing video: H51V5.mp4
==================================================
2025-02-06 10:28:15,801 - INFO - Processing video: H51V5.mp4
2025-02-06 10:28:15,803 - INFO - Found 33 frames for video H51V5.mp4
2025-02-06 10:28:15,804 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 10:28:15,804 - DEBUG - Found scene graph for frame H51V5.mp4/000052.png
2025-02-06 10:28:15,805 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 10:28:15,805 - DEBUG - Found scene graph for frame H51V5.mp4/000054.png
2025-02-06 10:28:15,805 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 10:28:15,805 - DEBUG - Found scene graph for frame H51V5.mp4/000087.png
2025-02-06 10:28:15,805 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 10:28:15,805 - DEBUG - Found scene graph for frame H51V5.mp4/000121.png
2025-02-06 10:28:15,805 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 10:28:15,806 - DEBUG - Found scene graph for frame H51V5.mp4/000154.png
2025-02-06 10:28:15,806 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 10:28:15,806 - DEBUG - Found scene graph for frame H51V5.mp4/000155.png
2025-02-06 10:28:15,806 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 10:28:15,806 - DEBUG - Found scene graph for frame H51V5.mp4/000175.png
2025-02-06 10:28:15,806 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 10:28:15,807 - DEBUG - Found scene graph for frame H51V5.mp4/000187.png
2025-02-06 10:28:15,807 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 10:28:15,807 - DEBUG - Found scene graph for frame H51V5.mp4/000216.png
2025-02-06 10:28:15,807 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 10:28:15,807 - DEBUG - Found scene graph for frame H51V5.mp4/000257.png
2025-02-06 10:28:15,808 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 10:28:15,808 - DEBUG - Found scene graph for frame H51V5.mp4/000258.png
2025-02-06 10:28:15,808 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 10:28:15,808 - DEBUG - Found scene graph for frame H51V5.mp4/000284.png
2025-02-06 10:28:15,808 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 10:28:15,808 - DEBUG - Found scene graph for frame H51V5.mp4/000286.png
2025-02-06 10:28:15,809 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 10:28:15,809 - DEBUG - Found scene graph for frame H51V5.mp4/000298.png
2025-02-06 10:28:15,809 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 10:28:15,809 - DEBUG - Found scene graph for frame H51V5.mp4/000317.png
2025-02-06 10:28:15,809 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 10:28:15,809 - DEBUG - Found scene graph for frame H51V5.mp4/000339.png
2025-02-06 10:28:15,809 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 10:28:15,809 - DEBUG - Found scene graph for frame H51V5.mp4/000350.png
2025-02-06 10:28:15,810 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 10:28:15,810 - DEBUG - Found scene graph for frame H51V5.mp4/000361.png
2025-02-06 10:28:15,810 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 10:28:15,810 - DEBUG - Found scene graph for frame H51V5.mp4/000383.png
2025-02-06 10:28:15,810 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 10:28:15,810 - DEBUG - Found scene graph for frame H51V5.mp4/000392.png
2025-02-06 10:28:15,811 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 10:28:15,811 - DEBUG - Found scene graph for frame H51V5.mp4/000413.png
2025-02-06 10:28:15,811 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 10:28:15,811 - DEBUG - Found scene graph for frame H51V5.mp4/000415.png
2025-02-06 10:28:15,811 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 10:28:15,811 - DEBUG - Found scene graph for frame H51V5.mp4/000416.png
2025-02-06 10:28:15,811 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 10:28:15,812 - DEBUG - Found scene graph for frame H51V5.mp4/000444.png
2025-02-06 10:28:15,812 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 10:28:15,812 - DEBUG - Found scene graph for frame H51V5.mp4/000448.png
2025-02-06 10:28:15,812 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 10:28:15,812 - DEBUG - Found scene graph for frame H51V5.mp4/000464.png
2025-02-06 10:28:15,812 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 10:28:15,812 - DEBUG - Found scene graph for frame H51V5.mp4/000476.png
2025-02-06 10:28:15,813 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 10:28:15,813 - DEBUG - Found scene graph for frame H51V5.mp4/000481.png
2025-02-06 10:28:15,813 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 10:28:15,813 - DEBUG - Found scene graph for frame H51V5.mp4/000497.png
2025-02-06 10:28:15,813 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 10:28:15,813 - DEBUG - Found scene graph for frame H51V5.mp4/000507.png
2025-02-06 10:28:15,813 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 10:28:15,813 - DEBUG - Found scene graph for frame H51V5.mp4/000514.png
2025-02-06 10:28:15,813 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 10:28:15,813 - DEBUG - Found scene graph for frame H51V5.mp4/000538.png
2025-02-06 10:28:15,814 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 10:28:15,814 - DEBUG - Found scene graph for frame H51V5.mp4/000547.png
2025-02-06 10:28:15,814 - INFO - Extracted 33 scene graphs
2025-02-06 10:28:15,814 - INFO - Split 33 graphs chronologically into 26 train and 7 test
2025-02-06 10:28:15,814 - DEBUG - Training frames: H51V5.mp4/000052.png to H51V5.mp4/000464.png
2025-02-06 10:28:15,814 - DEBUG - Testing frames: H51V5.mp4/000476.png to H51V5.mp4/000547.png
2025-02-06 10:28:15,815 - INFO - Generating 7 sequential predictions using closed vocabulary
2025-02-06 10:28:15,815 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 10:28:15,815 - DEBUG - Starting with 26 training frames
2025-02-06 10:28:15,815 - DEBUG - Frame numbers: [52, 54, 87, 121, 154, 155, 175, 187, 216, 257, 258, 284, 286, 298, 317, 339, 350, 361, 383, 392, 413, 415, 416, 444, 448, 464]
2025-02-06 10:28:15,815 - DEBUG - ============================

2025-02-06 10:28:15,816 - INFO - Found 7 test frames to predict after frame 464
2025-02-06 10:28:15,816 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 10:28:15,816 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 10:28:15,816 - DEBUG - Predicting 5 frames: [476, 481, 497, 507, 514]
2025-02-06 10:28:15,816 - DEBUG - Context has 26 frames
2025-02-06 10:28:15,816 - DEBUG - Last 3 context frames: [444, 448, 464]
2025-02-06 10:28:15,839 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000444:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish

Frame 000448:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person beneath table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish

Frame 000464:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person beneath food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish

========================

2025-02-06 10:28:15,839 - DEBUG - 
=======PROMPT========

2025-02-06 10:28:15,839 - DEBUG - Given the sequence of scene graphs below, predict the next 5 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (26 frames, 52 to 464):
            
Frame 000052:
Objects:
  - food
  - dish
Relationships:
  - person not_looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000054:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000087:
Objects:
  - food
  - dish
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000121:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000154:
Objects:
  - food
  - dish
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000155:
Objects:
  - food
  - dish
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000175:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000187:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person not_contacting food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000216:
Objects:
  - dish
Relationships:
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000257:
Objects:
  - dish
Relationships:
  - person looking_at dish
  - person in_front_of dish
  - person touching dish


Frame 000258:
Objects:
  - dish
Relationships:
  - person looking_at dish
  - person in_front_of dish
  - person not_contacting dish


Frame 000284:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person touching dish


Frame 000286:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person touching dish


Frame 000298:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000317:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000339:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000350:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000361:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000383:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000392:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000413:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000415:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000416:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000444:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000448:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person beneath table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000464:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person beneath food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 5 frames ([476, 481, 497, 507, 514]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 10:28:15,839 - DEBUG - 
===================

2025-02-06 10:28:28,103 - DEBUG - 
=======BATCH PREDICTIONS========
2025-02-06 10:28:28,106 - DEBUG - 
Prediction for frame 476:
2025-02-06 10:28:28,107 - DEBUG - Objects:
2025-02-06 10:28:28,107 - DEBUG -   - table
2025-02-06 10:28:28,107 - DEBUG -   - food
2025-02-06 10:28:28,108 - DEBUG -   - dish
2025-02-06 10:28:28,108 - DEBUG - Relationships:
2025-02-06 10:28:28,108 - DEBUG -   - person not_looking_at table
2025-02-06 10:28:28,109 - DEBUG -   - person in_front_of table
2025-02-06 10:28:28,109 - DEBUG -   - person not_contacting table
2025-02-06 10:28:28,110 - DEBUG -   - person looking_at food
2025-02-06 10:28:28,110 - DEBUG -   - person beneath food
2025-02-06 10:28:28,110 - DEBUG -   - person holding food
2025-02-06 10:28:28,110 - DEBUG -   - person looking_at dish
2025-02-06 10:28:28,110 - DEBUG -   - person in_front_of dish
2025-02-06 10:28:28,111 - DEBUG -   - person holding dish
2025-02-06 10:28:28,111 - DEBUG - 
Prediction for frame 481:
2025-02-06 10:28:28,111 - DEBUG - Objects:
2025-02-06 10:28:28,111 - DEBUG -   - table
2025-02-06 10:28:28,111 - DEBUG -   - food
2025-02-06 10:28:28,111 - DEBUG -   - dish
2025-02-06 10:28:28,111 - DEBUG - Relationships:
2025-02-06 10:28:28,111 - DEBUG -   - person not_looking_at table
2025-02-06 10:28:28,111 - DEBUG -   - person in_front_of table
2025-02-06 10:28:28,112 - DEBUG -   - person not_contacting table
2025-02-06 10:28:28,112 - DEBUG -   - person looking_at food
2025-02-06 10:28:28,112 - DEBUG -   - person beneath food
2025-02-06 10:28:28,112 - DEBUG -   - person holding food
2025-02-06 10:28:28,112 - DEBUG -   - person looking_at dish
2025-02-06 10:28:28,112 - DEBUG -   - person in_front_of dish
2025-02-06 10:28:28,112 - DEBUG -   - person holding dish
2025-02-06 10:28:28,112 - DEBUG - 
Prediction for frame 497:
2025-02-06 10:28:28,112 - DEBUG - Objects:
2025-02-06 10:28:28,112 - DEBUG -   - table
2025-02-06 10:28:28,112 - DEBUG -   - food
2025-02-06 10:28:28,113 - DEBUG -   - dish
2025-02-06 10:28:28,113 - DEBUG - Relationships:
2025-02-06 10:28:28,113 - DEBUG -   - person not_looking_at table
2025-02-06 10:28:28,113 - DEBUG -   - person in_front_of table
2025-02-06 10:28:28,113 - DEBUG -   - person not_contacting table
2025-02-06 10:28:28,113 - DEBUG -   - person looking_at food
2025-02-06 10:28:28,113 - DEBUG -   - person in_front_of food
2025-02-06 10:28:28,113 - DEBUG -   - person holding food
2025-02-06 10:28:28,113 - DEBUG -   - person looking_at dish
2025-02-06 10:28:28,113 - DEBUG -   - person in_front_of dish
2025-02-06 10:28:28,114 - DEBUG -   - person holding dish
2025-02-06 10:28:28,114 - DEBUG - 
Prediction for frame 507:
2025-02-06 10:28:28,114 - DEBUG - Objects:
2025-02-06 10:28:28,114 - DEBUG -   - table
2025-02-06 10:28:28,114 - DEBUG -   - food
2025-02-06 10:28:28,114 - DEBUG -   - dish
2025-02-06 10:28:28,114 - DEBUG - Relationships:
2025-02-06 10:28:28,114 - DEBUG -   - person not_looking_at table
2025-02-06 10:28:28,114 - DEBUG -   - person in_front_of table
2025-02-06 10:28:28,115 - DEBUG -   - person not_contacting table
2025-02-06 10:28:28,115 - DEBUG -   - person looking_at food
2025-02-06 10:28:28,115 - DEBUG -   - person in_front_of food
2025-02-06 10:28:28,115 - DEBUG -   - person holding food
2025-02-06 10:28:28,115 - DEBUG -   - person looking_at dish
2025-02-06 10:28:28,115 - DEBUG -   - person in_front_of dish
2025-02-06 10:28:28,115 - DEBUG -   - person holding dish
2025-02-06 10:28:28,115 - DEBUG - 
Prediction for frame 514:
2025-02-06 10:28:28,115 - DEBUG - Objects:
2025-02-06 10:28:28,115 - DEBUG -   - table
2025-02-06 10:28:28,116 - DEBUG -   - dish
2025-02-06 10:28:28,116 - DEBUG - Relationships:
2025-02-06 10:28:28,116 - DEBUG -   - person not_looking_at table
2025-02-06 10:28:28,116 - DEBUG -   - person in_front_of table
2025-02-06 10:28:28,116 - DEBUG -   - person not_contacting table
2025-02-06 10:28:28,116 - DEBUG -   - person looking_at dish
2025-02-06 10:28:28,116 - DEBUG -   - person in_front_of dish
2025-02-06 10:28:28,116 - DEBUG -   - person holding dish
2025-02-06 10:28:28,116 - DEBUG - Added 5 predictions to context
2025-02-06 10:28:28,116 - DEBUG - Context size now: 31 frames
2025-02-06 10:28:28,117 - DEBUG - ============================

2025-02-06 10:28:28,117 - DEBUG - 
=======BATCH PREDICTION 2========
2025-02-06 10:28:28,117 - DEBUG - Predicting 2 frames: [538, 547]
2025-02-06 10:28:28,117 - DEBUG - Context has 31 frames
2025-02-06 10:28:28,117 - DEBUG - Last 3 context frames: [497, 507, 514]
2025-02-06 10:28:28,142 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000497:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish

Frame 000507:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish

Frame 000514:
Objects:
  - table
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at dish
  - person in_front_of dish
  - person holding dish

========================

2025-02-06 10:28:28,143 - DEBUG - 
=======PROMPT========

2025-02-06 10:28:28,143 - DEBUG - Given the sequence of scene graphs below, predict the next 2 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (31 frames, 52 to 514):
            
Frame 000052:
Objects:
  - food
  - dish
Relationships:
  - person not_looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000054:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000087:
Objects:
  - food
  - dish
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000121:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000154:
Objects:
  - food
  - dish
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000155:
Objects:
  - food
  - dish
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000175:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000187:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person not_contacting food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000216:
Objects:
  - dish
Relationships:
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000257:
Objects:
  - dish
Relationships:
  - person looking_at dish
  - person in_front_of dish
  - person touching dish


Frame 000258:
Objects:
  - dish
Relationships:
  - person looking_at dish
  - person in_front_of dish
  - person not_contacting dish


Frame 000284:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person touching dish


Frame 000286:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person touching dish


Frame 000298:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000317:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000339:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000350:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000361:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000383:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000392:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000413:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000415:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000416:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000444:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000448:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person beneath table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000464:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person beneath food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000476:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person beneath food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000481:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person beneath food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000497:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000507:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000514:
Objects:
  - table
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at dish
  - person in_front_of dish
  - person holding dish

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 2 frames ([538, 547]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 10:28:28,144 - DEBUG - 
===================

2025-02-06 10:28:31,908 - DEBUG - 
=======BATCH PREDICTIONS========
2025-02-06 10:28:31,908 - DEBUG - 
Prediction for frame 538:
2025-02-06 10:28:31,908 - DEBUG - Objects:
2025-02-06 10:28:31,908 - DEBUG -   - table
2025-02-06 10:28:31,908 - DEBUG -   - dish
2025-02-06 10:28:31,908 - DEBUG - Relationships:
2025-02-06 10:28:31,909 - DEBUG -   - person not_looking_at table
2025-02-06 10:28:31,909 - DEBUG -   - person in_front_of table
2025-02-06 10:28:31,909 - DEBUG -   - person not_contacting table
2025-02-06 10:28:31,909 - DEBUG -   - person looking_at dish
2025-02-06 10:28:31,909 - DEBUG -   - person in_front_of dish
2025-02-06 10:28:31,909 - DEBUG -   - person holding dish
2025-02-06 10:28:31,909 - DEBUG - 
Prediction for frame 547:
2025-02-06 10:28:31,909 - DEBUG - Objects:
2025-02-06 10:28:31,909 - DEBUG -   - table
2025-02-06 10:28:31,909 - DEBUG -   - dish
2025-02-06 10:28:31,910 - DEBUG - Relationships:
2025-02-06 10:28:31,910 - DEBUG -   - person not_looking_at table
2025-02-06 10:28:31,910 - DEBUG -   - person in_front_of table
2025-02-06 10:28:31,910 - DEBUG -   - person not_contacting table
2025-02-06 10:28:31,910 - DEBUG -   - person not_looking_at dish
2025-02-06 10:28:31,910 - DEBUG -   - person in_front_of dish
2025-02-06 10:28:31,910 - DEBUG -   - person holding dish
2025-02-06 10:28:31,910 - DEBUG - Added 2 predictions to context
2025-02-06 10:28:31,910 - DEBUG - Context size now: 33 frames
2025-02-06 10:28:31,910 - DEBUG - ============================

2025-02-06 10:28:31,911 - INFO - Visualizing results...
2025-02-06 10:28:31,911 - DEBUG - Visualizing comparison for frame H51V5.mp4/000476.png
2025-02-06 10:28:32,032 - DEBUG - Visualizing comparison for frame H51V5.mp4/000481.png
2025-02-06 10:28:32,121 - DEBUG - Visualizing comparison for frame H51V5.mp4/000497.png
2025-02-06 10:28:32,211 - DEBUG - Visualizing comparison for frame H51V5.mp4/000507.png
2025-02-06 10:28:32,298 - DEBUG - Visualizing comparison for frame H51V5.mp4/000514.png
2025-02-06 10:28:33,549 - DEBUG - Visualizing comparison for frame H51V5.mp4/000538.png
2025-02-06 10:28:33,652 - DEBUG - Visualizing comparison for frame H51V5.mp4/000547.png
2025-02-06 10:28:33,745 - INFO - Completed processing video: H51V5.mp4
2025-02-06 10:28:33,745 - INFO - Waiting 60 seconds before next video...
2025-02-06 10:29:33,744 - INFO - 
==================================================
Processing video: CXZW3.mp4
==================================================
2025-02-06 10:29:33,751 - INFO - Processing video: CXZW3.mp4
2025-02-06 10:29:33,752 - INFO - Found 10 frames for video CXZW3.mp4
2025-02-06 10:29:33,760 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 10:29:33,760 - DEBUG - Found scene graph for frame CXZW3.mp4/000093.png
2025-02-06 10:29:33,761 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 10:29:33,761 - DEBUG - Found scene graph for frame CXZW3.mp4/000177.png
2025-02-06 10:29:33,762 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 10:29:33,762 - DEBUG - Found scene graph for frame CXZW3.mp4/000224.png
2025-02-06 10:29:33,762 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 10:29:33,762 - DEBUG - Found scene graph for frame CXZW3.mp4/000271.png
2025-02-06 10:29:33,762 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 10:29:33,762 - DEBUG - Found scene graph for frame CXZW3.mp4/000277.png
2025-02-06 10:29:33,762 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 10:29:33,762 - DEBUG - Found scene graph for frame CXZW3.mp4/000317.png
2025-02-06 10:29:33,763 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 10:29:33,763 - DEBUG - Found scene graph for frame CXZW3.mp4/000364.png
2025-02-06 10:29:33,763 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 10:29:33,763 - DEBUG - Found scene graph for frame CXZW3.mp4/000461.png
2025-02-06 10:29:33,763 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 10:29:33,763 - DEBUG - Found scene graph for frame CXZW3.mp4/000644.png
2025-02-06 10:29:33,763 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 10:29:33,764 - DEBUG - Found scene graph for frame CXZW3.mp4/000828.png
2025-02-06 10:29:33,764 - INFO - Extracted 10 scene graphs
2025-02-06 10:29:33,764 - INFO - Split 10 graphs chronologically into 8 train and 2 test
2025-02-06 10:29:33,764 - DEBUG - Training frames: CXZW3.mp4/000093.png to CXZW3.mp4/000461.png
2025-02-06 10:29:33,764 - DEBUG - Testing frames: CXZW3.mp4/000644.png to CXZW3.mp4/000828.png
2025-02-06 10:29:33,765 - INFO - Generating 2 sequential predictions using closed vocabulary
2025-02-06 10:29:33,765 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 10:29:33,765 - DEBUG - Starting with 8 training frames
2025-02-06 10:29:33,765 - DEBUG - Frame numbers: [93, 177, 224, 271, 277, 317, 364, 461]
2025-02-06 10:29:33,765 - DEBUG - ============================

2025-02-06 10:29:33,766 - INFO - Found 2 test frames to predict after frame 461
2025-02-06 10:29:33,766 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 10:29:33,766 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 10:29:33,766 - DEBUG - Predicting 2 frames: [644, 828]
2025-02-06 10:29:33,766 - DEBUG - Context has 8 frames
2025-02-06 10:29:33,766 - DEBUG - Last 3 context frames: [317, 364, 461]
2025-02-06 10:29:33,773 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000317:
Objects:
  - paper/notebook
Relationships:
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook

Frame 000364:
Objects:
  - paper/notebook
Relationships:
  - person not_looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook

Frame 000461:
Objects:
  - paper/notebook
Relationships:
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook

========================

2025-02-06 10:29:33,774 - DEBUG - 
=======PROMPT========

2025-02-06 10:29:33,774 - DEBUG - Given the sequence of scene graphs below, predict the next 2 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (8 frames, 93 to 461):
            
Frame 000093:
Objects:
  - paper/notebook
Relationships:
  - person not_looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000177:
Objects:
  - paper/notebook
Relationships:
  - person not_looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000224:
Objects:
  - paper/notebook
Relationships:
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000271:
Objects:
  - paper/notebook
Relationships:
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person writing_on paper/notebook


Frame 000277:
Objects:
  - paper/notebook
Relationships:
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000317:
Objects:
  - paper/notebook
Relationships:
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000364:
Objects:
  - paper/notebook
Relationships:
  - person not_looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000461:
Objects:
  - paper/notebook
Relationships:
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 2 frames ([644, 828]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 10:29:33,774 - DEBUG - 
===================

2025-02-06 12:06:58,802 - INFO - Processing video: TXQWJ.mp4
2025-02-06 12:06:58,803 - INFO - Found 20 frames for video TXQWJ.mp4
2025-02-06 12:06:58,804 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:06:58,804 - DEBUG - Found scene graph for frame TXQWJ.mp4/000052.png
2025-02-06 12:06:58,804 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:06:58,804 - DEBUG - Found scene graph for frame TXQWJ.mp4/000153.png
2025-02-06 12:06:58,804 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:06:58,804 - DEBUG - Found scene graph for frame TXQWJ.mp4/000255.png
2025-02-06 12:06:58,804 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:06:58,804 - DEBUG - Found scene graph for frame TXQWJ.mp4/000353.png
2025-02-06 12:06:58,804 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:06:58,805 - DEBUG - Found scene graph for frame TXQWJ.mp4/000357.png
2025-02-06 12:06:58,805 - DEBUG - No valid objects found in annotations for frame TXQWJ.mp4/000421.png
2025-02-06 12:06:58,805 - WARNING - No scene graph found for frame TXQWJ.mp4/000421.png
2025-02-06 12:06:58,805 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:06:58,805 - DEBUG - Found scene graph for frame TXQWJ.mp4/000458.png
2025-02-06 12:06:58,805 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:06:58,805 - DEBUG - Found scene graph for frame TXQWJ.mp4/000486.png
2025-02-06 12:06:58,805 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:06:58,806 - DEBUG - Found scene graph for frame TXQWJ.mp4/000489.png
2025-02-06 12:06:58,806 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:06:58,806 - DEBUG - Found scene graph for frame TXQWJ.mp4/000533.png
2025-02-06 12:06:58,806 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:06:58,806 - DEBUG - Found scene graph for frame TXQWJ.mp4/000545.png
2025-02-06 12:06:58,806 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:06:58,806 - DEBUG - Found scene graph for frame TXQWJ.mp4/000557.png
2025-02-06 12:06:58,806 - DEBUG - Extracted scene graph with 4 objects and 12 relationships
2025-02-06 12:06:58,806 - DEBUG - Found scene graph for frame TXQWJ.mp4/000603.png
2025-02-06 12:06:58,806 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:06:58,806 - DEBUG - Found scene graph for frame TXQWJ.mp4/000625.png
2025-02-06 12:06:58,807 - DEBUG - Extracted scene graph with 4 objects and 12 relationships
2025-02-06 12:06:58,807 - DEBUG - Found scene graph for frame TXQWJ.mp4/000649.png
2025-02-06 12:06:58,807 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:06:58,807 - DEBUG - Found scene graph for frame TXQWJ.mp4/000661.png
2025-02-06 12:06:58,807 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:06:58,807 - DEBUG - Found scene graph for frame TXQWJ.mp4/000720.png
2025-02-06 12:06:58,807 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:06:58,807 - DEBUG - Found scene graph for frame TXQWJ.mp4/000765.png
2025-02-06 12:06:58,807 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:06:58,807 - DEBUG - Found scene graph for frame TXQWJ.mp4/000881.png
2025-02-06 12:06:58,808 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:06:58,808 - DEBUG - Found scene graph for frame TXQWJ.mp4/000997.png
2025-02-06 12:06:58,808 - INFO - Extracted 19 scene graphs
2025-02-06 12:06:58,808 - INFO - Split 19 graphs chronologically into 15 train and 4 test
2025-02-06 12:06:58,809 - DEBUG - Training frames: TXQWJ.mp4/000052.png to TXQWJ.mp4/000661.png
2025-02-06 12:06:58,809 - DEBUG - Testing frames: TXQWJ.mp4/000720.png to TXQWJ.mp4/000997.png
2025-02-06 12:06:58,809 - INFO - 
=== Starting Llama Scene Graph Prediction (Closed Vocabulary) ===
2025-02-06 12:06:58,809 - INFO - Will generate 4 sequential predictions
2025-02-06 12:06:58,809 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:06:58,809 - DEBUG - Starting with 15 training frames
2025-02-06 12:06:58,809 - DEBUG - Frame numbers: [52, 153, 255, 353, 357, 458, 486, 489, 533, 545, 557, 603, 625, 649, 661]
2025-02-06 12:06:58,809 - DEBUG - ============================

2025-02-06 12:06:58,809 - INFO - Found 4 test frames to predict after frame 661
2025-02-06 12:06:58,810 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:06:58,810 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:06:58,810 - DEBUG - Predicting 4 frames: [720, 765, 881, 997]
2025-02-06 12:06:58,810 - DEBUG - Context has 15 frames
2025-02-06 12:06:58,810 - DEBUG - Last 3 context frames: [625, 649, 661]
2025-02-06 12:06:58,820 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000625:
Objects:
  - food
  - groceries
  - bag
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at groceries
  - person in_front_of groceries
  - person holding groceries
  - person looking_at bag
  - person in_front_of bag
  - person touching bag

Frame 000649:
Objects:
  - food
  - groceries
  - bag
  - cup/glass/bottle
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at groceries
  - person in_front_of groceries
  - person touching groceries
  - person looking_at bag
  - person in_front_of bag
  - person touching bag
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person not_contacting cup/glass/bottle

Frame 000661:
Objects:
  - food
  - groceries
  - bag
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at groceries
  - person in_front_of groceries
  - person touching groceries
  - person looking_at bag
  - person in_front_of bag
  - person touching bag

========================

2025-02-06 12:06:58,820 - DEBUG - 
=======PROMPT========

2025-02-06 12:06:58,820 - DEBUG - Given the sequence of scene graphs below, predict the next 4 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (15 frames, 52 to 661):
            
Frame 000052:
Objects:
  - cup/glass/bottle
Relationships:
  - person looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle


Frame 000153:
Objects:
  - cup/glass/bottle
Relationships:
  - person looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person drinking_from cup/glass/bottle


Frame 000255:
Objects:
  - cup/glass/bottle
Relationships:
  - person looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle
  - person drinking_from cup/glass/bottle


Frame 000353:
Objects:
  - cup/glass/bottle
Relationships:
  - person not_looking_at cup/glass/bottle
  - person beneath cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle


Frame 000357:
Objects:
  - cup/glass/bottle
Relationships:
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle


Frame 000458:
Objects:
  - bag
Relationships:
  - person unsure bag
  - person on_the_side_of bag
  - person in_front_of bag
  - person not_contacting bag


Frame 000486:
Objects:
  - food
  - bag
  - cup/glass/bottle
Relationships:
  - person looking_at food
  - person in_front_of food
  - person not_contacting food
  - person looking_at bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle


Frame 000489:
Objects:
  - food
  - groceries
  - bag
Relationships:
  - person not_looking_at food
  - person in_front_of food
  - person not_contacting food
  - person looking_at groceries
  - person in_front_of groceries
  - person not_contacting groceries
  - person looking_at bag
  - person in_front_of bag
  - person on_the_side_of bag
  - person not_contacting bag


Frame 000533:
Objects:
  - food
  - groceries
  - bag
Relationships:
  - person not_looking_at food
  - person in_front_of food
  - person not_contacting food
  - person unsure groceries
  - person in_front_of groceries
  - person not_contacting groceries
  - person unsure bag
  - person in_front_of bag
  - person not_contacting bag


Frame 000545:
Objects:
  - food
  - groceries
  - bag
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at groceries
  - person in_front_of groceries
  - person touching groceries
  - person looking_at bag
  - person in_front_of bag
  - person not_contacting bag


Frame 000557:
Objects:
  - food
  - groceries
  - bag
Relationships:
  - person looking_at food
  - person in_front_of food
  - person touching food
  - person looking_at groceries
  - person in_front_of groceries
  - person touching groceries
  - person looking_at bag
  - person in_front_of bag
  - person touching bag


Frame 000603:
Objects:
  - food
  - groceries
  - bag
  - cup/glass/bottle
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person looking_at groceries
  - person in_front_of groceries
  - person touching groceries
  - person looking_at bag
  - person in_front_of bag
  - person touching bag
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person not_contacting cup/glass/bottle


Frame 000625:
Objects:
  - food
  - groceries
  - bag
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at groceries
  - person in_front_of groceries
  - person holding groceries
  - person looking_at bag
  - person in_front_of bag
  - person touching bag


Frame 000649:
Objects:
  - food
  - groceries
  - bag
  - cup/glass/bottle
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at groceries
  - person in_front_of groceries
  - person touching groceries
  - person looking_at bag
  - person in_front_of bag
  - person touching bag
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person not_contacting cup/glass/bottle


Frame 000661:
Objects:
  - food
  - groceries
  - bag
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at groceries
  - person in_front_of groceries
  - person touching groceries
  - person looking_at bag
  - person in_front_of bag
  - person touching bag

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 4 frames ([720, 765, 881, 997]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:06:58,820 - DEBUG - 
===================

2025-02-06 12:06:59,375 - ERROR - Prediction failed: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:06:59,377 - DEBUG - Traceback: Traceback (most recent call last):
  File "/Users/sriujjwalreddyb/SceneGraphVLM/llamaAPI.py", line 423, in predict_scene_graphs
    response = model.run(api_request_json)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 67, in run
    return self.run_sync(api_request_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 53, in run_sync
    raise Exception(f"POST {response.status_code} {response.json()['detail']}")
Exception: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.

2025-02-06 12:06:59,377 - ERROR - Failed to process video TXQWJ.mp4: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:06:59,379 - INFO - 
==================================================
Processing video: H51V5.mp4
==================================================
2025-02-06 12:06:59,380 - INFO - Processing video: H51V5.mp4
2025-02-06 12:06:59,381 - INFO - Found 33 frames for video H51V5.mp4
2025-02-06 12:06:59,382 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:06:59,383 - DEBUG - Found scene graph for frame H51V5.mp4/000052.png
2025-02-06 12:06:59,383 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:06:59,383 - DEBUG - Found scene graph for frame H51V5.mp4/000054.png
2025-02-06 12:06:59,384 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:06:59,384 - DEBUG - Found scene graph for frame H51V5.mp4/000087.png
2025-02-06 12:06:59,384 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:06:59,384 - DEBUG - Found scene graph for frame H51V5.mp4/000121.png
2025-02-06 12:06:59,384 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:06:59,384 - DEBUG - Found scene graph for frame H51V5.mp4/000154.png
2025-02-06 12:06:59,384 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:06:59,384 - DEBUG - Found scene graph for frame H51V5.mp4/000155.png
2025-02-06 12:06:59,384 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:06:59,385 - DEBUG - Found scene graph for frame H51V5.mp4/000175.png
2025-02-06 12:06:59,385 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:06:59,385 - DEBUG - Found scene graph for frame H51V5.mp4/000187.png
2025-02-06 12:06:59,385 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:06:59,385 - DEBUG - Found scene graph for frame H51V5.mp4/000216.png
2025-02-06 12:06:59,385 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:06:59,385 - DEBUG - Found scene graph for frame H51V5.mp4/000257.png
2025-02-06 12:06:59,385 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:06:59,386 - DEBUG - Found scene graph for frame H51V5.mp4/000258.png
2025-02-06 12:06:59,386 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:06:59,386 - DEBUG - Found scene graph for frame H51V5.mp4/000284.png
2025-02-06 12:06:59,386 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:06:59,386 - DEBUG - Found scene graph for frame H51V5.mp4/000286.png
2025-02-06 12:06:59,386 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:06:59,386 - DEBUG - Found scene graph for frame H51V5.mp4/000298.png
2025-02-06 12:06:59,386 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:06:59,387 - DEBUG - Found scene graph for frame H51V5.mp4/000317.png
2025-02-06 12:06:59,387 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:06:59,387 - DEBUG - Found scene graph for frame H51V5.mp4/000339.png
2025-02-06 12:06:59,387 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:06:59,387 - DEBUG - Found scene graph for frame H51V5.mp4/000350.png
2025-02-06 12:06:59,387 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:06:59,387 - DEBUG - Found scene graph for frame H51V5.mp4/000361.png
2025-02-06 12:06:59,387 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:06:59,387 - DEBUG - Found scene graph for frame H51V5.mp4/000383.png
2025-02-06 12:06:59,387 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:06:59,388 - DEBUG - Found scene graph for frame H51V5.mp4/000392.png
2025-02-06 12:06:59,388 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:06:59,388 - DEBUG - Found scene graph for frame H51V5.mp4/000413.png
2025-02-06 12:06:59,388 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:06:59,388 - DEBUG - Found scene graph for frame H51V5.mp4/000415.png
2025-02-06 12:06:59,388 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:06:59,388 - DEBUG - Found scene graph for frame H51V5.mp4/000416.png
2025-02-06 12:06:59,389 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:06:59,389 - DEBUG - Found scene graph for frame H51V5.mp4/000444.png
2025-02-06 12:06:59,389 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:06:59,389 - DEBUG - Found scene graph for frame H51V5.mp4/000448.png
2025-02-06 12:06:59,389 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:06:59,389 - DEBUG - Found scene graph for frame H51V5.mp4/000464.png
2025-02-06 12:06:59,389 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:06:59,389 - DEBUG - Found scene graph for frame H51V5.mp4/000476.png
2025-02-06 12:06:59,389 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:06:59,389 - DEBUG - Found scene graph for frame H51V5.mp4/000481.png
2025-02-06 12:06:59,390 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:06:59,390 - DEBUG - Found scene graph for frame H51V5.mp4/000497.png
2025-02-06 12:06:59,390 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:06:59,390 - DEBUG - Found scene graph for frame H51V5.mp4/000507.png
2025-02-06 12:06:59,390 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:06:59,390 - DEBUG - Found scene graph for frame H51V5.mp4/000514.png
2025-02-06 12:06:59,390 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:06:59,390 - DEBUG - Found scene graph for frame H51V5.mp4/000538.png
2025-02-06 12:06:59,390 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:06:59,390 - DEBUG - Found scene graph for frame H51V5.mp4/000547.png
2025-02-06 12:06:59,391 - INFO - Extracted 33 scene graphs
2025-02-06 12:06:59,391 - INFO - Split 33 graphs chronologically into 26 train and 7 test
2025-02-06 12:06:59,391 - DEBUG - Training frames: H51V5.mp4/000052.png to H51V5.mp4/000464.png
2025-02-06 12:06:59,391 - DEBUG - Testing frames: H51V5.mp4/000476.png to H51V5.mp4/000547.png
2025-02-06 12:06:59,391 - INFO - 
=== Starting Llama Scene Graph Prediction (Closed Vocabulary) ===
2025-02-06 12:06:59,391 - INFO - Will generate 7 sequential predictions
2025-02-06 12:06:59,391 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:06:59,391 - DEBUG - Starting with 26 training frames
2025-02-06 12:06:59,391 - DEBUG - Frame numbers: [52, 54, 87, 121, 154, 155, 175, 187, 216, 257, 258, 284, 286, 298, 317, 339, 350, 361, 383, 392, 413, 415, 416, 444, 448, 464]
2025-02-06 12:06:59,391 - DEBUG - ============================

2025-02-06 12:06:59,392 - INFO - Found 7 test frames to predict after frame 464
2025-02-06 12:06:59,392 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:06:59,392 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:06:59,392 - DEBUG - Predicting 5 frames: [476, 481, 497, 507, 514]
2025-02-06 12:06:59,392 - DEBUG - Context has 26 frames
2025-02-06 12:06:59,392 - DEBUG - Last 3 context frames: [444, 448, 464]
2025-02-06 12:06:59,412 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000444:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish

Frame 000448:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person beneath table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish

Frame 000464:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person beneath food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish

========================

2025-02-06 12:06:59,413 - DEBUG - 
=======PROMPT========

2025-02-06 12:06:59,413 - DEBUG - Given the sequence of scene graphs below, predict the next 5 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (26 frames, 52 to 464):
            
Frame 000052:
Objects:
  - food
  - dish
Relationships:
  - person not_looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000054:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000087:
Objects:
  - food
  - dish
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000121:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000154:
Objects:
  - food
  - dish
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000155:
Objects:
  - food
  - dish
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000175:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000187:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person not_contacting food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000216:
Objects:
  - dish
Relationships:
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000257:
Objects:
  - dish
Relationships:
  - person looking_at dish
  - person in_front_of dish
  - person touching dish


Frame 000258:
Objects:
  - dish
Relationships:
  - person looking_at dish
  - person in_front_of dish
  - person not_contacting dish


Frame 000284:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person touching dish


Frame 000286:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person touching dish


Frame 000298:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000317:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000339:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000350:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000361:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000383:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000392:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000413:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000415:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000416:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000444:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000448:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person beneath table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000464:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person beneath food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 5 frames ([476, 481, 497, 507, 514]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:06:59,413 - DEBUG - 
===================

2025-02-06 12:06:59,761 - ERROR - Prediction failed: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:06:59,762 - DEBUG - Traceback: Traceback (most recent call last):
  File "/Users/sriujjwalreddyb/SceneGraphVLM/llamaAPI.py", line 423, in predict_scene_graphs
    response = model.run(api_request_json)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 67, in run
    return self.run_sync(api_request_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 53, in run_sync
    raise Exception(f"POST {response.status_code} {response.json()['detail']}")
Exception: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.

2025-02-06 12:06:59,763 - ERROR - Failed to process video H51V5.mp4: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:06:59,764 - INFO - 
==================================================
Processing video: CXZW3.mp4
==================================================
2025-02-06 12:06:59,766 - INFO - Processing video: CXZW3.mp4
2025-02-06 12:06:59,767 - INFO - Found 10 frames for video CXZW3.mp4
2025-02-06 12:06:59,768 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:06:59,768 - DEBUG - Found scene graph for frame CXZW3.mp4/000093.png
2025-02-06 12:06:59,768 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:06:59,768 - DEBUG - Found scene graph for frame CXZW3.mp4/000177.png
2025-02-06 12:06:59,768 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:06:59,769 - DEBUG - Found scene graph for frame CXZW3.mp4/000224.png
2025-02-06 12:06:59,769 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:06:59,769 - DEBUG - Found scene graph for frame CXZW3.mp4/000271.png
2025-02-06 12:06:59,769 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:06:59,769 - DEBUG - Found scene graph for frame CXZW3.mp4/000277.png
2025-02-06 12:06:59,769 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:06:59,769 - DEBUG - Found scene graph for frame CXZW3.mp4/000317.png
2025-02-06 12:06:59,769 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:06:59,769 - DEBUG - Found scene graph for frame CXZW3.mp4/000364.png
2025-02-06 12:06:59,769 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:06:59,770 - DEBUG - Found scene graph for frame CXZW3.mp4/000461.png
2025-02-06 12:06:59,770 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:06:59,770 - DEBUG - Found scene graph for frame CXZW3.mp4/000644.png
2025-02-06 12:06:59,770 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:06:59,770 - DEBUG - Found scene graph for frame CXZW3.mp4/000828.png
2025-02-06 12:06:59,770 - INFO - Extracted 10 scene graphs
2025-02-06 12:06:59,770 - INFO - Split 10 graphs chronologically into 8 train and 2 test
2025-02-06 12:06:59,770 - DEBUG - Training frames: CXZW3.mp4/000093.png to CXZW3.mp4/000461.png
2025-02-06 12:06:59,771 - DEBUG - Testing frames: CXZW3.mp4/000644.png to CXZW3.mp4/000828.png
2025-02-06 12:06:59,771 - INFO - 
=== Starting Llama Scene Graph Prediction (Closed Vocabulary) ===
2025-02-06 12:06:59,771 - INFO - Will generate 2 sequential predictions
2025-02-06 12:06:59,771 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:06:59,771 - DEBUG - Starting with 8 training frames
2025-02-06 12:06:59,772 - DEBUG - Frame numbers: [93, 177, 224, 271, 277, 317, 364, 461]
2025-02-06 12:06:59,772 - DEBUG - ============================

2025-02-06 12:06:59,772 - INFO - Found 2 test frames to predict after frame 461
2025-02-06 12:06:59,772 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:06:59,772 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:06:59,772 - DEBUG - Predicting 2 frames: [644, 828]
2025-02-06 12:06:59,773 - DEBUG - Context has 8 frames
2025-02-06 12:06:59,773 - DEBUG - Last 3 context frames: [317, 364, 461]
2025-02-06 12:06:59,778 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000317:
Objects:
  - paper/notebook
Relationships:
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook

Frame 000364:
Objects:
  - paper/notebook
Relationships:
  - person not_looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook

Frame 000461:
Objects:
  - paper/notebook
Relationships:
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook

========================

2025-02-06 12:06:59,779 - DEBUG - 
=======PROMPT========

2025-02-06 12:06:59,779 - DEBUG - Given the sequence of scene graphs below, predict the next 2 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (8 frames, 93 to 461):
            
Frame 000093:
Objects:
  - paper/notebook
Relationships:
  - person not_looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000177:
Objects:
  - paper/notebook
Relationships:
  - person not_looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000224:
Objects:
  - paper/notebook
Relationships:
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000271:
Objects:
  - paper/notebook
Relationships:
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person writing_on paper/notebook


Frame 000277:
Objects:
  - paper/notebook
Relationships:
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000317:
Objects:
  - paper/notebook
Relationships:
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000364:
Objects:
  - paper/notebook
Relationships:
  - person not_looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000461:
Objects:
  - paper/notebook
Relationships:
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 2 frames ([644, 828]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:06:59,779 - DEBUG - 
===================

2025-02-06 12:07:00,154 - ERROR - Prediction failed: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:00,156 - DEBUG - Traceback: Traceback (most recent call last):
  File "/Users/sriujjwalreddyb/SceneGraphVLM/llamaAPI.py", line 423, in predict_scene_graphs
    response = model.run(api_request_json)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 67, in run
    return self.run_sync(api_request_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 53, in run_sync
    raise Exception(f"POST {response.status_code} {response.json()['detail']}")
Exception: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.

2025-02-06 12:07:00,156 - ERROR - Failed to process video CXZW3.mp4: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:00,157 - INFO - 
==================================================
Processing video: 1GQAJ.mp4
==================================================
2025-02-06 12:07:00,159 - INFO - Processing video: 1GQAJ.mp4
2025-02-06 12:07:00,160 - INFO - Found 30 frames for video 1GQAJ.mp4
2025-02-06 12:07:00,161 - DEBUG - No valid objects found in annotations for frame 1GQAJ.mp4/000021.png
2025-02-06 12:07:00,161 - WARNING - No scene graph found for frame 1GQAJ.mp4/000021.png
2025-02-06 12:07:00,161 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:00,161 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000052.png
2025-02-06 12:07:00,161 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:00,161 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000082.png
2025-02-06 12:07:00,162 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:00,162 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000086.png
2025-02-06 12:07:00,162 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:00,162 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000112.png
2025-02-06 12:07:00,162 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:00,162 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000143.png
2025-02-06 12:07:00,162 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:00,163 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000165.png
2025-02-06 12:07:00,163 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:00,163 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000196.png
2025-02-06 12:07:00,163 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:00,163 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000244.png
2025-02-06 12:07:00,163 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:00,163 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000246.png
2025-02-06 12:07:00,163 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:00,163 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000256.png
2025-02-06 12:07:00,164 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:00,164 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000290.png
2025-02-06 12:07:00,164 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:07:00,164 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000312.png
2025-02-06 12:07:00,164 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:00,164 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000323.png
2025-02-06 12:07:00,164 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:00,164 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000324.png
2025-02-06 12:07:00,165 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:00,165 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000357.png
2025-02-06 12:07:00,165 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:00,165 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000378.png
2025-02-06 12:07:00,165 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:00,165 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000385.png
2025-02-06 12:07:00,165 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:00,165 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000402.png
2025-02-06 12:07:00,166 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:00,166 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000425.png
2025-02-06 12:07:00,166 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:00,166 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000443.png
2025-02-06 12:07:00,166 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:00,166 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000458.png
2025-02-06 12:07:00,166 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:07:00,166 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000479.png
2025-02-06 12:07:00,166 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:00,167 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000509.png
2025-02-06 12:07:00,167 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:00,167 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000526.png
2025-02-06 12:07:00,167 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:00,167 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000559.png
2025-02-06 12:07:00,167 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:00,167 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000573.png
2025-02-06 12:07:00,167 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:00,167 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000627.png
2025-02-06 12:07:00,168 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:00,168 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000660.png
2025-02-06 12:07:00,168 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:00,168 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000728.png
2025-02-06 12:07:00,168 - INFO - Extracted 29 scene graphs
2025-02-06 12:07:00,168 - INFO - Split 29 graphs chronologically into 23 train and 6 test
2025-02-06 12:07:00,168 - DEBUG - Training frames: 1GQAJ.mp4/000052.png to 1GQAJ.mp4/000509.png
2025-02-06 12:07:00,168 - DEBUG - Testing frames: 1GQAJ.mp4/000526.png to 1GQAJ.mp4/000728.png
2025-02-06 12:07:00,169 - INFO - 
=== Starting Llama Scene Graph Prediction (Closed Vocabulary) ===
2025-02-06 12:07:00,169 - INFO - Will generate 6 sequential predictions
2025-02-06 12:07:00,169 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:07:00,169 - DEBUG - Starting with 23 training frames
2025-02-06 12:07:00,169 - DEBUG - Frame numbers: [52, 82, 86, 112, 143, 165, 196, 244, 246, 256, 290, 312, 323, 324, 357, 378, 385, 402, 425, 443, 458, 479, 509]
2025-02-06 12:07:00,169 - DEBUG - ============================

2025-02-06 12:07:00,169 - INFO - Found 6 test frames to predict after frame 509
2025-02-06 12:07:00,169 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:07:00,170 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:07:00,170 - DEBUG - Predicting 5 frames: [526, 559, 573, 627, 660]
2025-02-06 12:07:00,170 - DEBUG - Context has 23 frames
2025-02-06 12:07:00,170 - DEBUG - Last 3 context frames: [458, 479, 509]
2025-02-06 12:07:00,187 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000458:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom

Frame 000479:
Objects:
  - floor
  - door
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure door
  - person behind door
  - person not_contacting door
  - person unsure broom
  - person in_front_of broom
  - person holding broom

Frame 000509:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom

========================

2025-02-06 12:07:00,188 - DEBUG - 
=======PROMPT========

2025-02-06 12:07:00,188 - DEBUG - Given the sequence of scene graphs below, predict the next 5 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (23 frames, 52 to 509):
            
Frame 000052:
Objects:
  - doorway
Relationships:
  - person not_looking_at doorway
  - person in doorway
  - person holding doorway


Frame 000082:
Objects:
  - broom
  - doorway
Relationships:
  - person looking_at broom
  - person in_front_of broom
  - person holding broom
  - person not_looking_at doorway
  - person in doorway
  - person touching doorway


Frame 000086:
Objects:
  - broom
  - doorway
Relationships:
  - person looking_at broom
  - person on_the_side_of broom
  - person holding broom
  - person not_looking_at doorway
  - person in doorway
  - person touching doorway


Frame 000112:
Objects:
  - broom
  - doorway
Relationships:
  - person looking_at broom
  - person on_the_side_of broom
  - person holding broom
  - person not_looking_at doorway
  - person in doorway
  - person touching doorway


Frame 000143:
Objects:
  - broom
  - doorway
Relationships:
  - person unsure broom
  - person in_front_of broom
  - person holding broom
  - person not_looking_at doorway
  - person on_the_side_of doorway
  - person not_contacting doorway


Frame 000165:
Objects:
  - broom
Relationships:
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000196:
Objects:
  - broom
Relationships:
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000244:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000246:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000256:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000290:
Objects:
  - floor
  - broom
Relationships:
  - person looking_at floor
  - person beneath floor
  - person in_front_of floor
  - person standing_on floor
  - person looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000312:
Objects:
  - floor
  - broom
Relationships:
  - person looking_at floor
  - person beneath floor
  - person in_front_of floor
  - person standing_on floor
  - person not_looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000323:
Objects:
  - floor
  - broom
Relationships:
  - person looking_at floor
  - person beneath floor
  - person standing_on floor
  - person looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000324:
Objects:
  - floor
  - broom
Relationships:
  - person looking_at floor
  - person beneath floor
  - person in_front_of floor
  - person standing_on floor
  - person looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000357:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000378:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000385:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000402:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000425:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000443:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000458:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000479:
Objects:
  - floor
  - door
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure door
  - person behind door
  - person not_contacting door
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000509:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 5 frames ([526, 559, 573, 627, 660]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:07:00,188 - DEBUG - 
===================

2025-02-06 12:07:00,580 - ERROR - Prediction failed: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:00,582 - DEBUG - Traceback: Traceback (most recent call last):
  File "/Users/sriujjwalreddyb/SceneGraphVLM/llamaAPI.py", line 423, in predict_scene_graphs
    response = model.run(api_request_json)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 67, in run
    return self.run_sync(api_request_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 53, in run_sync
    raise Exception(f"POST {response.status_code} {response.json()['detail']}")
Exception: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.

2025-02-06 12:07:00,582 - ERROR - Failed to process video 1GQAJ.mp4: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:00,583 - INFO - 
==================================================
Processing video: 0R5GS.mp4
==================================================
2025-02-06 12:07:00,583 - INFO - Processing video: 0R5GS.mp4
2025-02-06 12:07:00,584 - INFO - Found 20 frames for video 0R5GS.mp4
2025-02-06 12:07:00,584 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:07:00,585 - DEBUG - Found scene graph for frame 0R5GS.mp4/000050.png
2025-02-06 12:07:00,585 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:00,585 - DEBUG - Found scene graph for frame 0R5GS.mp4/000087.png
2025-02-06 12:07:00,585 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:00,585 - DEBUG - Found scene graph for frame 0R5GS.mp4/000124.png
2025-02-06 12:07:00,585 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:00,585 - DEBUG - Found scene graph for frame 0R5GS.mp4/000138.png
2025-02-06 12:07:00,585 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:00,585 - DEBUG - Found scene graph for frame 0R5GS.mp4/000161.png
2025-02-06 12:07:00,586 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:00,586 - DEBUG - Found scene graph for frame 0R5GS.mp4/000198.png
2025-02-06 12:07:00,586 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:00,586 - DEBUG - Found scene graph for frame 0R5GS.mp4/000316.png
2025-02-06 12:07:00,586 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:00,586 - DEBUG - Found scene graph for frame 0R5GS.mp4/000389.png
2025-02-06 12:07:00,586 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:00,586 - DEBUG - Found scene graph for frame 0R5GS.mp4/000408.png
2025-02-06 12:07:00,587 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:00,587 - DEBUG - Found scene graph for frame 0R5GS.mp4/000494.png
2025-02-06 12:07:00,587 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:00,587 - DEBUG - Found scene graph for frame 0R5GS.mp4/000511.png
2025-02-06 12:07:00,587 - DEBUG - No valid objects found in annotations for frame 0R5GS.mp4/000515.png
2025-02-06 12:07:00,587 - WARNING - No scene graph found for frame 0R5GS.mp4/000515.png
2025-02-06 12:07:00,587 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:00,588 - DEBUG - Found scene graph for frame 0R5GS.mp4/000622.png
2025-02-06 12:07:00,588 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:00,588 - DEBUG - Found scene graph for frame 0R5GS.mp4/000634.png
2025-02-06 12:07:00,588 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:00,588 - DEBUG - Found scene graph for frame 0R5GS.mp4/000672.png
2025-02-06 12:07:00,588 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:00,588 - DEBUG - Found scene graph for frame 0R5GS.mp4/000728.png
2025-02-06 12:07:00,588 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:00,589 - DEBUG - Found scene graph for frame 0R5GS.mp4/000756.png
2025-02-06 12:07:00,589 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:00,589 - DEBUG - Found scene graph for frame 0R5GS.mp4/000835.png
2025-02-06 12:07:00,589 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:00,589 - DEBUG - Found scene graph for frame 0R5GS.mp4/000850.png
2025-02-06 12:07:00,589 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:00,589 - DEBUG - Found scene graph for frame 0R5GS.mp4/000878.png
2025-02-06 12:07:00,590 - INFO - Extracted 19 scene graphs
2025-02-06 12:07:00,590 - INFO - Split 19 graphs chronologically into 15 train and 4 test
2025-02-06 12:07:00,590 - DEBUG - Training frames: 0R5GS.mp4/000050.png to 0R5GS.mp4/000728.png
2025-02-06 12:07:00,590 - DEBUG - Testing frames: 0R5GS.mp4/000756.png to 0R5GS.mp4/000878.png
2025-02-06 12:07:00,590 - INFO - 
=== Starting Llama Scene Graph Prediction (Closed Vocabulary) ===
2025-02-06 12:07:00,590 - INFO - Will generate 4 sequential predictions
2025-02-06 12:07:00,590 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:07:00,590 - DEBUG - Starting with 15 training frames
2025-02-06 12:07:00,591 - DEBUG - Frame numbers: [50, 87, 124, 138, 161, 198, 316, 389, 408, 494, 511, 622, 634, 672, 728]
2025-02-06 12:07:00,591 - DEBUG - ============================

2025-02-06 12:07:00,591 - INFO - Found 4 test frames to predict after frame 728
2025-02-06 12:07:00,591 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:07:00,591 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:07:00,591 - DEBUG - Predicting 4 frames: [756, 835, 850, 878]
2025-02-06 12:07:00,591 - DEBUG - Context has 15 frames
2025-02-06 12:07:00,592 - DEBUG - Last 3 context frames: [634, 672, 728]
2025-02-06 12:07:00,600 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000634:
Objects:
  - box
Relationships:
  - person not_looking_at box
  - person in_front_of box
  - person holding box

Frame 000672:
Objects:
  - mirror
Relationships:
  - person unsure mirror
  - person on_the_side_of mirror
  - person not_contacting mirror

Frame 000728:
Objects:
  - box
Relationships:
  - person not_looking_at box
  - person in_front_of box
  - person holding box

========================

2025-02-06 12:07:00,601 - DEBUG - 
=======PROMPT========

2025-02-06 12:07:00,601 - DEBUG - Given the sequence of scene graphs below, predict the next 4 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (15 frames, 50 to 728):
            
Frame 000050:
Objects:
  - box
Relationships:
  - person looking_at box
  - person in_front_of box
  - person on_the_side_of box
  - person not_contacting box


Frame 000087:
Objects:
  - box
Relationships:
  - person looking_at box
  - person in_front_of box
  - person touching box


Frame 000124:
Objects:
  - box
Relationships:
  - person looking_at box
  - person in_front_of box
  - person holding box


Frame 000138:
Objects:
  - box
Relationships:
  - person looking_at box
  - person in_front_of box
  - person holding box


Frame 000161:
Objects:
  - box
Relationships:
  - person looking_at box
  - person in_front_of box
  - person holding box


Frame 000198:
Objects:
  - box
Relationships:
  - person looking_at box
  - person in_front_of box
  - person holding box


Frame 000316:
Objects:
  - box
Relationships:
  - person looking_at box
  - person in_front_of box
  - person holding box


Frame 000389:
Objects:
  - box
  - mirror
Relationships:
  - person not_looking_at box
  - person in_front_of box
  - person holding box
  - person not_looking_at mirror
  - person in_front_of mirror
  - person not_contacting mirror


Frame 000408:
Objects:
  - mirror
Relationships:
  - person unsure mirror
  - person in_front_of mirror
  - person not_contacting mirror


Frame 000494:
Objects:
  - box
  - mirror
Relationships:
  - person not_looking_at box
  - person in_front_of box
  - person holding box
  - person not_looking_at mirror
  - person on_the_side_of mirror
  - person not_contacting mirror


Frame 000511:
Objects:
  - mirror
Relationships:
  - person not_looking_at mirror
  - person behind mirror
  - person not_contacting mirror


Frame 000622:
Objects:
  - box
  - mirror
Relationships:
  - person not_looking_at box
  - person in_front_of box
  - person holding box
  - person not_looking_at mirror
  - person on_the_side_of mirror
  - person behind mirror
  - person not_contacting mirror


Frame 000634:
Objects:
  - box
Relationships:
  - person not_looking_at box
  - person in_front_of box
  - person holding box


Frame 000672:
Objects:
  - mirror
Relationships:
  - person unsure mirror
  - person on_the_side_of mirror
  - person not_contacting mirror


Frame 000728:
Objects:
  - box
Relationships:
  - person not_looking_at box
  - person in_front_of box
  - person holding box

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 4 frames ([756, 835, 850, 878]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:07:00,601 - DEBUG - 
===================

2025-02-06 12:07:01,252 - ERROR - Prediction failed: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:01,253 - DEBUG - Traceback: Traceback (most recent call last):
  File "/Users/sriujjwalreddyb/SceneGraphVLM/llamaAPI.py", line 423, in predict_scene_graphs
    response = model.run(api_request_json)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 67, in run
    return self.run_sync(api_request_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 53, in run_sync
    raise Exception(f"POST {response.status_code} {response.json()['detail']}")
Exception: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.

2025-02-06 12:07:01,253 - ERROR - Failed to process video 0R5GS.mp4: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:01,254 - INFO - 
==================================================
Processing video: FNJ2G.mp4
==================================================
2025-02-06 12:07:01,254 - INFO - Processing video: FNJ2G.mp4
2025-02-06 12:07:01,255 - INFO - Found 20 frames for video FNJ2G.mp4
2025-02-06 12:07:01,255 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:07:01,256 - DEBUG - Found scene graph for frame FNJ2G.mp4/000037.png
2025-02-06 12:07:01,256 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:01,256 - DEBUG - Found scene graph for frame FNJ2G.mp4/000098.png
2025-02-06 12:07:01,256 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:01,256 - DEBUG - Found scene graph for frame FNJ2G.mp4/000109.png
2025-02-06 12:07:01,256 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:01,256 - DEBUG - Found scene graph for frame FNJ2G.mp4/000181.png
2025-02-06 12:07:01,257 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:01,257 - DEBUG - Found scene graph for frame FNJ2G.mp4/000227.png
2025-02-06 12:07:01,257 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:07:01,257 - DEBUG - Found scene graph for frame FNJ2G.mp4/000252.png
2025-02-06 12:07:01,257 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:07:01,257 - DEBUG - Found scene graph for frame FNJ2G.mp4/000291.png
2025-02-06 12:07:01,257 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:01,257 - DEBUG - Found scene graph for frame FNJ2G.mp4/000314.png
2025-02-06 12:07:01,258 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:01,258 - DEBUG - Found scene graph for frame FNJ2G.mp4/000324.png
2025-02-06 12:07:01,258 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:01,258 - DEBUG - Found scene graph for frame FNJ2G.mp4/000391.png
2025-02-06 12:07:01,258 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:01,258 - DEBUG - Found scene graph for frame FNJ2G.mp4/000459.png
2025-02-06 12:07:01,258 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:07:01,259 - DEBUG - Found scene graph for frame FNJ2G.mp4/000484.png
2025-02-06 12:07:01,259 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:01,259 - DEBUG - Found scene graph for frame FNJ2G.mp4/000556.png
2025-02-06 12:07:01,259 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:01,259 - DEBUG - Found scene graph for frame FNJ2G.mp4/000604.png
2025-02-06 12:07:01,259 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:01,259 - DEBUG - Found scene graph for frame FNJ2G.mp4/000677.png
2025-02-06 12:07:01,260 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:01,260 - DEBUG - Found scene graph for frame FNJ2G.mp4/000720.png
2025-02-06 12:07:01,260 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:01,260 - DEBUG - Found scene graph for frame FNJ2G.mp4/000749.png
2025-02-06 12:07:01,261 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:01,261 - DEBUG - Found scene graph for frame FNJ2G.mp4/000870.png
2025-02-06 12:07:01,261 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:01,261 - DEBUG - Found scene graph for frame FNJ2G.mp4/000884.png
2025-02-06 12:07:01,261 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:01,261 - DEBUG - Found scene graph for frame FNJ2G.mp4/000894.png
2025-02-06 12:07:01,262 - INFO - Extracted 20 scene graphs
2025-02-06 12:07:01,262 - INFO - Split 20 graphs chronologically into 16 train and 4 test
2025-02-06 12:07:01,262 - DEBUG - Training frames: FNJ2G.mp4/000037.png to FNJ2G.mp4/000720.png
2025-02-06 12:07:01,262 - DEBUG - Testing frames: FNJ2G.mp4/000749.png to FNJ2G.mp4/000894.png
2025-02-06 12:07:01,262 - INFO - 
=== Starting Llama Scene Graph Prediction (Closed Vocabulary) ===
2025-02-06 12:07:01,262 - INFO - Will generate 4 sequential predictions
2025-02-06 12:07:01,262 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:07:01,262 - DEBUG - Starting with 16 training frames
2025-02-06 12:07:01,263 - DEBUG - Frame numbers: [37, 98, 109, 181, 227, 252, 291, 314, 324, 391, 459, 484, 556, 604, 677, 720]
2025-02-06 12:07:01,263 - DEBUG - ============================

2025-02-06 12:07:01,263 - INFO - Found 4 test frames to predict after frame 720
2025-02-06 12:07:01,263 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:07:01,263 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:07:01,263 - DEBUG - Predicting 4 frames: [749, 870, 884, 894]
2025-02-06 12:07:01,264 - DEBUG - Context has 16 frames
2025-02-06 12:07:01,264 - DEBUG - Last 3 context frames: [604, 677, 720]
2025-02-06 12:07:01,274 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000604:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom

Frame 000677:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person on_the_side_of broom
  - person holding broom

Frame 000720:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person on_the_side_of broom
  - person holding broom

========================

2025-02-06 12:07:01,275 - DEBUG - 
=======PROMPT========

2025-02-06 12:07:01,275 - DEBUG - Given the sequence of scene graphs below, predict the next 4 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (16 frames, 37 to 720):
            
Frame 000037:
Objects:
  - broom
Relationships:
  - person not_looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000098:
Objects:
  - broom
Relationships:
  - person not_looking_at broom
  - person on_the_side_of broom
  - person holding broom


Frame 000109:
Objects:
  - broom
Relationships:
  - person not_looking_at broom
  - person on_the_side_of broom
  - person holding broom


Frame 000181:
Objects:
  - broom
Relationships:
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000227:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person on_the_side_of broom
  - person holding broom


Frame 000252:
Objects:
  - broom
Relationships:
  - person not_looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000291:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person above phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000314:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000324:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person on_the_side_of broom
  - person holding broom


Frame 000391:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000459:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000484:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person touching phone/camera
  - person holding phone/camera
  - person looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000556:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person on_the_side_of broom
  - person holding broom


Frame 000604:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000677:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person on_the_side_of broom
  - person holding broom


Frame 000720:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person on_the_side_of broom
  - person holding broom

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 4 frames ([749, 870, 884, 894]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:07:01,275 - DEBUG - 
===================

2025-02-06 12:07:01,865 - ERROR - Prediction failed: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:01,866 - DEBUG - Traceback: Traceback (most recent call last):
  File "/Users/sriujjwalreddyb/SceneGraphVLM/llamaAPI.py", line 423, in predict_scene_graphs
    response = model.run(api_request_json)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 67, in run
    return self.run_sync(api_request_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 53, in run_sync
    raise Exception(f"POST {response.status_code} {response.json()['detail']}")
Exception: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.

2025-02-06 12:07:01,866 - ERROR - Failed to process video FNJ2G.mp4: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:01,866 - INFO - 
==================================================
Processing video: P76D1.mp4
==================================================
2025-02-06 12:07:01,867 - INFO - Processing video: P76D1.mp4
2025-02-06 12:07:01,868 - INFO - Found 32 frames for video P76D1.mp4
2025-02-06 12:07:01,869 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:01,869 - DEBUG - Found scene graph for frame P76D1.mp4/000025.png
2025-02-06 12:07:01,869 - DEBUG - Extracted scene graph with 2 objects and 9 relationships
2025-02-06 12:07:01,869 - DEBUG - Found scene graph for frame P76D1.mp4/000026.png
2025-02-06 12:07:01,869 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:01,869 - DEBUG - Found scene graph for frame P76D1.mp4/000031.png
2025-02-06 12:07:01,870 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:07:01,870 - DEBUG - Found scene graph for frame P76D1.mp4/000074.png
2025-02-06 12:07:01,870 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:07:01,870 - DEBUG - Found scene graph for frame P76D1.mp4/000077.png
2025-02-06 12:07:01,870 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:07:01,870 - DEBUG - Found scene graph for frame P76D1.mp4/000090.png
2025-02-06 12:07:01,871 - DEBUG - Extracted scene graph with 2 objects and 9 relationships
2025-02-06 12:07:01,871 - DEBUG - Found scene graph for frame P76D1.mp4/000123.png
2025-02-06 12:07:01,871 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:07:01,871 - DEBUG - Found scene graph for frame P76D1.mp4/000127.png
2025-02-06 12:07:01,871 - DEBUG - Extracted scene graph with 2 objects and 9 relationships
2025-02-06 12:07:01,871 - DEBUG - Found scene graph for frame P76D1.mp4/000149.png
2025-02-06 12:07:01,871 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:01,871 - DEBUG - Found scene graph for frame P76D1.mp4/000150.png
2025-02-06 12:07:01,872 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:07:01,872 - DEBUG - Found scene graph for frame P76D1.mp4/000171.png
2025-02-06 12:07:01,872 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:07:01,872 - DEBUG - Found scene graph for frame P76D1.mp4/000177.png
2025-02-06 12:07:01,872 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:07:01,873 - DEBUG - Found scene graph for frame P76D1.mp4/000204.png
2025-02-06 12:07:01,873 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:07:01,873 - DEBUG - Found scene graph for frame P76D1.mp4/000208.png
2025-02-06 12:07:01,873 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:07:01,873 - DEBUG - Found scene graph for frame P76D1.mp4/000209.png
2025-02-06 12:07:01,873 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:07:01,873 - DEBUG - Found scene graph for frame P76D1.mp4/000210.png
2025-02-06 12:07:01,874 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:07:01,874 - DEBUG - Found scene graph for frame P76D1.mp4/000217.png
2025-02-06 12:07:01,874 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:07:01,874 - DEBUG - Found scene graph for frame P76D1.mp4/000220.png
2025-02-06 12:07:01,874 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:07:01,874 - DEBUG - Found scene graph for frame P76D1.mp4/000223.png
2025-02-06 12:07:01,874 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:07:01,874 - DEBUG - Found scene graph for frame P76D1.mp4/000228.png
2025-02-06 12:07:01,875 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:07:01,875 - DEBUG - Found scene graph for frame P76D1.mp4/000231.png
2025-02-06 12:07:01,875 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:07:01,875 - DEBUG - Found scene graph for frame P76D1.mp4/000236.png
2025-02-06 12:07:01,875 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:07:01,875 - DEBUG - Found scene graph for frame P76D1.mp4/000243.png
2025-02-06 12:07:01,875 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:01,875 - DEBUG - Found scene graph for frame P76D1.mp4/000254.png
2025-02-06 12:07:01,876 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:01,876 - DEBUG - Found scene graph for frame P76D1.mp4/000256.png
2025-02-06 12:07:01,876 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:01,876 - DEBUG - Found scene graph for frame P76D1.mp4/000262.png
2025-02-06 12:07:01,876 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:01,876 - DEBUG - Found scene graph for frame P76D1.mp4/000267.png
2025-02-06 12:07:01,876 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:01,876 - DEBUG - Found scene graph for frame P76D1.mp4/000269.png
2025-02-06 12:07:01,877 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:01,877 - DEBUG - Found scene graph for frame P76D1.mp4/000276.png
2025-02-06 12:07:01,877 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:01,877 - DEBUG - Found scene graph for frame P76D1.mp4/000281.png
2025-02-06 12:07:01,877 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:01,877 - DEBUG - Found scene graph for frame P76D1.mp4/000295.png
2025-02-06 12:07:01,877 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:01,878 - DEBUG - Found scene graph for frame P76D1.mp4/000298.png
2025-02-06 12:07:01,878 - INFO - Extracted 32 scene graphs
2025-02-06 12:07:01,878 - INFO - Split 32 graphs chronologically into 25 train and 7 test
2025-02-06 12:07:01,878 - DEBUG - Training frames: P76D1.mp4/000025.png to P76D1.mp4/000256.png
2025-02-06 12:07:01,878 - DEBUG - Testing frames: P76D1.mp4/000262.png to P76D1.mp4/000298.png
2025-02-06 12:07:01,878 - INFO - 
=== Starting Llama Scene Graph Prediction (Closed Vocabulary) ===
2025-02-06 12:07:01,878 - INFO - Will generate 7 sequential predictions
2025-02-06 12:07:01,879 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:07:01,879 - DEBUG - Starting with 25 training frames
2025-02-06 12:07:01,879 - DEBUG - Frame numbers: [25, 26, 31, 74, 77, 90, 123, 127, 149, 150, 171, 177, 204, 208, 209, 210, 217, 220, 223, 228, 231, 236, 243, 254, 256]
2025-02-06 12:07:01,879 - DEBUG - ============================

2025-02-06 12:07:01,879 - INFO - Found 7 test frames to predict after frame 256
2025-02-06 12:07:01,879 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:07:01,880 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:07:01,880 - DEBUG - Predicting 5 frames: [262, 267, 269, 276, 281]
2025-02-06 12:07:01,880 - DEBUG - Context has 25 frames
2025-02-06 12:07:01,880 - DEBUG - Last 3 context frames: [243, 254, 256]
2025-02-06 12:07:01,901 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000243:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish
  - person not_looking_at chair
  - person behind chair
  - person beneath chair
  - person not_contacting chair

Frame 000254:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person on_the_side_of food
  - person holding food
  - person looking_at dish
  - person behind dish
  - person on_the_side_of dish
  - person holding dish

Frame 000256:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person on_the_side_of dish
  - person holding dish

========================

2025-02-06 12:07:01,901 - DEBUG - 
=======PROMPT========

2025-02-06 12:07:01,902 - DEBUG - Given the sequence of scene graphs below, predict the next 5 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (25 frames, 25 to 256):
            
Frame 000025:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person beneath food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair


Frame 000026:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person beneath food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person leaning_on chair
  - person other_relationship chair


Frame 000031:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair


Frame 000074:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000077:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000090:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person leaning_on chair


Frame 000123:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person leaning_on chair
  - person other_relationship chair


Frame 000127:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000149:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person leaning_on chair
  - person other_relationship chair


Frame 000150:
Objects:
  - food
  - chair
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair


Frame 000171:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person leaning_on chair


Frame 000177:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000204:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish
  - person touching dish
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000208:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000209:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person touching dish
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000210:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person touching dish
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person leaning_on chair
  - person other_relationship chair


Frame 000217:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person touching dish
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000220:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person touching dish
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000223:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person not_looking_at food
  - person beneath food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish
  - person not_looking_at chair
  - person behind chair
  - person beneath chair
  - person sitting_on chair
  - person leaning_on chair
  - person other_relationship chair


Frame 000228:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000231:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person not_looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000236:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish
  - person not_looking_at chair
  - person behind chair
  - person not_contacting chair


Frame 000243:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish
  - person not_looking_at chair
  - person behind chair
  - person beneath chair
  - person not_contacting chair


Frame 000254:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person on_the_side_of food
  - person holding food
  - person looking_at dish
  - person behind dish
  - person on_the_side_of dish
  - person holding dish


Frame 000256:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person on_the_side_of dish
  - person holding dish

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 5 frames ([262, 267, 269, 276, 281]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:07:01,902 - DEBUG - 
===================

2025-02-06 12:07:02,873 - ERROR - Prediction failed: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:02,876 - DEBUG - Traceback: Traceback (most recent call last):
  File "/Users/sriujjwalreddyb/SceneGraphVLM/llamaAPI.py", line 423, in predict_scene_graphs
    response = model.run(api_request_json)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 67, in run
    return self.run_sync(api_request_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 53, in run_sync
    raise Exception(f"POST {response.status_code} {response.json()['detail']}")
Exception: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.

2025-02-06 12:07:02,877 - ERROR - Failed to process video P76D1.mp4: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:02,879 - INFO - 
==================================================
Processing video: WTU0I.mp4
==================================================
2025-02-06 12:07:02,880 - INFO - Processing video: WTU0I.mp4
2025-02-06 12:07:02,880 - INFO - Found 48 frames for video WTU0I.mp4
2025-02-06 12:07:02,881 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:02,881 - DEBUG - Found scene graph for frame WTU0I.mp4/000010.png
2025-02-06 12:07:02,881 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:02,881 - DEBUG - Found scene graph for frame WTU0I.mp4/000018.png
2025-02-06 12:07:02,882 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:02,882 - DEBUG - Found scene graph for frame WTU0I.mp4/000027.png
2025-02-06 12:07:02,882 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:02,882 - DEBUG - Found scene graph for frame WTU0I.mp4/000045.png
2025-02-06 12:07:02,882 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:02,882 - DEBUG - Found scene graph for frame WTU0I.mp4/000053.png
2025-02-06 12:07:02,882 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:02,883 - DEBUG - Found scene graph for frame WTU0I.mp4/000062.png
2025-02-06 12:07:02,883 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:02,883 - DEBUG - Found scene graph for frame WTU0I.mp4/000079.png
2025-02-06 12:07:02,883 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:02,883 - DEBUG - Found scene graph for frame WTU0I.mp4/000088.png
2025-02-06 12:07:02,883 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:02,883 - DEBUG - Found scene graph for frame WTU0I.mp4/000108.png
2025-02-06 12:07:02,883 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:02,884 - DEBUG - Found scene graph for frame WTU0I.mp4/000115.png
2025-02-06 12:07:02,884 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:02,884 - DEBUG - Found scene graph for frame WTU0I.mp4/000123.png
2025-02-06 12:07:02,884 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:02,884 - DEBUG - Found scene graph for frame WTU0I.mp4/000158.png
2025-02-06 12:07:02,884 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:02,884 - DEBUG - Found scene graph for frame WTU0I.mp4/000209.png
2025-02-06 12:07:02,885 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:02,885 - DEBUG - Found scene graph for frame WTU0I.mp4/000323.png
2025-02-06 12:07:02,885 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:02,885 - DEBUG - Found scene graph for frame WTU0I.mp4/000343.png
2025-02-06 12:07:02,885 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:02,885 - DEBUG - Found scene graph for frame WTU0I.mp4/000421.png
2025-02-06 12:07:02,886 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:02,886 - DEBUG - Found scene graph for frame WTU0I.mp4/000514.png
2025-02-06 12:07:02,886 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:02,886 - DEBUG - Found scene graph for frame WTU0I.mp4/000538.png
2025-02-06 12:07:02,886 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:02,887 - DEBUG - Found scene graph for frame WTU0I.mp4/000571.png
2025-02-06 12:07:02,887 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:02,887 - DEBUG - Found scene graph for frame WTU0I.mp4/000601.png
2025-02-06 12:07:02,887 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:02,887 - DEBUG - Found scene graph for frame WTU0I.mp4/000633.png
2025-02-06 12:07:02,887 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:02,887 - DEBUG - Found scene graph for frame WTU0I.mp4/000688.png
2025-02-06 12:07:02,888 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:02,888 - DEBUG - Found scene graph for frame WTU0I.mp4/000753.png
2025-02-06 12:07:02,888 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:02,889 - DEBUG - Found scene graph for frame WTU0I.mp4/000775.png
2025-02-06 12:07:02,889 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:02,889 - DEBUG - Found scene graph for frame WTU0I.mp4/000798.png
2025-02-06 12:07:02,889 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:02,889 - DEBUG - Found scene graph for frame WTU0I.mp4/000844.png
2025-02-06 12:07:02,890 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:02,890 - DEBUG - Found scene graph for frame WTU0I.mp4/000862.png
2025-02-06 12:07:02,890 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:02,890 - DEBUG - Found scene graph for frame WTU0I.mp4/000956.png
2025-02-06 12:07:02,890 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:07:02,890 - DEBUG - Found scene graph for frame WTU0I.mp4/000968.png
2025-02-06 12:07:02,890 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:07:02,890 - DEBUG - Found scene graph for frame WTU0I.mp4/001007.png
2025-02-06 12:07:02,891 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:07:02,891 - DEBUG - Found scene graph for frame WTU0I.mp4/001013.png
2025-02-06 12:07:02,891 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:07:02,891 - DEBUG - Found scene graph for frame WTU0I.mp4/001026.png
2025-02-06 12:07:02,891 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:07:02,891 - DEBUG - Found scene graph for frame WTU0I.mp4/001030.png
2025-02-06 12:07:02,891 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:07:02,892 - DEBUG - Found scene graph for frame WTU0I.mp4/001039.png
2025-02-06 12:07:02,892 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:02,892 - DEBUG - Found scene graph for frame WTU0I.mp4/001056.png
2025-02-06 12:07:02,892 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:07:02,892 - DEBUG - Found scene graph for frame WTU0I.mp4/001058.png
2025-02-06 12:07:02,892 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:02,892 - DEBUG - Found scene graph for frame WTU0I.mp4/001065.png
2025-02-06 12:07:02,892 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:02,893 - DEBUG - Found scene graph for frame WTU0I.mp4/001068.png
2025-02-06 12:07:02,893 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:02,893 - DEBUG - Found scene graph for frame WTU0I.mp4/001091.png
2025-02-06 12:07:02,893 - DEBUG - No valid objects found in annotations for frame WTU0I.mp4/001103.png
2025-02-06 12:07:02,893 - WARNING - No scene graph found for frame WTU0I.mp4/001103.png
2025-02-06 12:07:02,893 - DEBUG - No valid objects found in annotations for frame WTU0I.mp4/001106.png
2025-02-06 12:07:02,893 - WARNING - No scene graph found for frame WTU0I.mp4/001106.png
2025-02-06 12:07:02,894 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:07:02,894 - DEBUG - Found scene graph for frame WTU0I.mp4/001109.png
2025-02-06 12:07:02,894 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:07:02,894 - DEBUG - Found scene graph for frame WTU0I.mp4/001116.png
2025-02-06 12:07:02,894 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:02,894 - DEBUG - Found scene graph for frame WTU0I.mp4/001142.png
2025-02-06 12:07:02,894 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:02,894 - DEBUG - Found scene graph for frame WTU0I.mp4/001143.png
2025-02-06 12:07:02,895 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:07:02,895 - DEBUG - Found scene graph for frame WTU0I.mp4/001148.png
2025-02-06 12:07:02,895 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:02,895 - DEBUG - Found scene graph for frame WTU0I.mp4/001160.png
2025-02-06 12:07:02,895 - DEBUG - No valid objects found in annotations for frame WTU0I.mp4/001181.png
2025-02-06 12:07:02,895 - WARNING - No scene graph found for frame WTU0I.mp4/001181.png
2025-02-06 12:07:02,896 - INFO - Extracted 45 scene graphs
2025-02-06 12:07:02,896 - INFO - Split 45 graphs chronologically into 36 train and 9 test
2025-02-06 12:07:02,896 - DEBUG - Training frames: WTU0I.mp4/000010.png to WTU0I.mp4/001058.png
2025-02-06 12:07:02,896 - DEBUG - Testing frames: WTU0I.mp4/001065.png to WTU0I.mp4/001160.png
2025-02-06 12:07:02,896 - INFO - 
=== Starting Llama Scene Graph Prediction (Closed Vocabulary) ===
2025-02-06 12:07:02,896 - INFO - Will generate 9 sequential predictions
2025-02-06 12:07:02,896 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:07:02,897 - DEBUG - Starting with 36 training frames
2025-02-06 12:07:02,897 - DEBUG - Frame numbers: [10, 18, 27, 45, 53, 62, 79, 88, 108, 115, 123, 158, 209, 323, 343, 421, 514, 538, 571, 601, 633, 688, 753, 775, 798, 844, 862, 956, 968, 1007, 1013, 1026, 1030, 1039, 1056, 1058]
2025-02-06 12:07:02,897 - DEBUG - ============================

2025-02-06 12:07:02,897 - INFO - Found 12 test frames to predict after frame 1058
2025-02-06 12:07:02,898 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:07:02,898 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:07:02,898 - DEBUG - Predicting 5 frames: [1065, 1068, 1091, 1103, 1106]
2025-02-06 12:07:02,898 - DEBUG - Context has 36 frames
2025-02-06 12:07:02,898 - DEBUG - Last 3 context frames: [1039, 1056, 1058]
2025-02-06 12:07:02,917 - DEBUG - 
=======CONTEXT DETAILS========

Frame 001039:
Objects:
  - book
  - chair
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person not_looking_at table
  - person in_front_of table
  - person touching table

Frame 001056:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table

Frame 001058:
Objects:
  - book
  - chair
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person not_looking_at table
  - person in_front_of table
  - person touching table

========================

2025-02-06 12:07:02,918 - DEBUG - 
=======PROMPT========

2025-02-06 12:07:02,918 - DEBUG - Given the sequence of scene graphs below, predict the next 5 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (36 frames, 10 to 1058):
            
Frame 000010:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table


Frame 000018:
Objects:
  - book
  - table
Relationships:
  - person not_looking_at book
  - person in_front_of book
  - person on_the_side_of book
  - person holding book
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table


Frame 000027:
Objects:
  - book
  - table
Relationships:
  - person not_looking_at book
  - person in_front_of book
  - person holding book
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table


Frame 000045:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000053:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000062:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000079:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000088:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000108:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person touching book
  - person holding book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000115:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000123:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000158:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000209:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000323:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table


Frame 000343:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000421:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000514:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000538:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000571:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000601:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000633:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000688:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person touching book
  - person holding book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000753:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person touching book
  - person holding book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000775:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000798:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000844:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table


Frame 000862:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000956:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000968:
Objects:
  - book
  - chair
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person touching book
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 001007:
Objects:
  - book
  - chair
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 001013:
Objects:
  - book
  - chair
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 001026:
Objects:
  - book
  - chair
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person touching book
  - person holding book
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 001030:
Objects:
  - book
  - chair
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person touching book
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 001039:
Objects:
  - book
  - chair
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 001056:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 001058:
Objects:
  - book
  - chair
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person not_looking_at table
  - person in_front_of table
  - person touching table

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 5 frames ([1065, 1068, 1091, 1103, 1106]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:07:02,918 - DEBUG - 
===================

2025-02-06 12:07:03,557 - ERROR - Prediction failed: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:03,561 - DEBUG - Traceback: Traceback (most recent call last):
  File "/Users/sriujjwalreddyb/SceneGraphVLM/llamaAPI.py", line 423, in predict_scene_graphs
    response = model.run(api_request_json)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 67, in run
    return self.run_sync(api_request_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 53, in run_sync
    raise Exception(f"POST {response.status_code} {response.json()['detail']}")
Exception: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.

2025-02-06 12:07:03,561 - ERROR - Failed to process video WTU0I.mp4: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:03,563 - INFO - 
==================================================
Processing video: 16OAM.mp4
==================================================
2025-02-06 12:07:03,564 - INFO - Processing video: 16OAM.mp4
2025-02-06 12:07:03,565 - INFO - Found 10 frames for video 16OAM.mp4
2025-02-06 12:07:03,566 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:03,566 - DEBUG - Found scene graph for frame 16OAM.mp4/000141.png
2025-02-06 12:07:03,566 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:03,566 - DEBUG - Found scene graph for frame 16OAM.mp4/000270.png
2025-02-06 12:07:03,567 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:03,567 - DEBUG - Found scene graph for frame 16OAM.mp4/000399.png
2025-02-06 12:07:03,567 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:03,568 - DEBUG - Found scene graph for frame 16OAM.mp4/000528.png
2025-02-06 12:07:03,568 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:07:03,568 - DEBUG - Found scene graph for frame 16OAM.mp4/000599.png
2025-02-06 12:07:03,569 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:03,569 - DEBUG - Found scene graph for frame 16OAM.mp4/000626.png
2025-02-06 12:07:03,569 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:03,569 - DEBUG - Found scene graph for frame 16OAM.mp4/000653.png
2025-02-06 12:07:03,569 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:03,569 - DEBUG - Found scene graph for frame 16OAM.mp4/000657.png
2025-02-06 12:07:03,569 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:03,570 - DEBUG - Found scene graph for frame 16OAM.mp4/000680.png
2025-02-06 12:07:03,570 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:03,570 - DEBUG - Found scene graph for frame 16OAM.mp4/000707.png
2025-02-06 12:07:03,570 - INFO - Extracted 10 scene graphs
2025-02-06 12:07:03,570 - INFO - Split 10 graphs chronologically into 8 train and 2 test
2025-02-06 12:07:03,571 - DEBUG - Training frames: 16OAM.mp4/000141.png to 16OAM.mp4/000657.png
2025-02-06 12:07:03,571 - DEBUG - Testing frames: 16OAM.mp4/000680.png to 16OAM.mp4/000707.png
2025-02-06 12:07:03,571 - INFO - 
=== Starting Llama Scene Graph Prediction (Closed Vocabulary) ===
2025-02-06 12:07:03,571 - INFO - Will generate 2 sequential predictions
2025-02-06 12:07:03,572 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:07:03,572 - DEBUG - Starting with 8 training frames
2025-02-06 12:07:03,572 - DEBUG - Frame numbers: [141, 270, 399, 528, 599, 626, 653, 657]
2025-02-06 12:07:03,572 - DEBUG - ============================

2025-02-06 12:07:03,572 - INFO - Found 2 test frames to predict after frame 657
2025-02-06 12:07:03,572 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:07:03,573 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:07:03,573 - DEBUG - Predicting 2 frames: [680, 707]
2025-02-06 12:07:03,573 - DEBUG - Context has 8 frames
2025-02-06 12:07:03,573 - DEBUG - Last 3 context frames: [626, 653, 657]
2025-02-06 12:07:03,579 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000626:
Objects:
  - laptop
Relationships:
  - person not_looking_at laptop
  - person in_front_of laptop
  - person touching laptop

Frame 000653:
Objects:
  - laptop
Relationships:
  - person looking_at laptop
  - person in_front_of laptop
  - person touching laptop

Frame 000657:
Objects:
  - laptop
Relationships:
  - person looking_at laptop
  - person in_front_of laptop
  - person touching laptop

========================

2025-02-06 12:07:03,579 - DEBUG - 
=======PROMPT========

2025-02-06 12:07:03,579 - DEBUG - Given the sequence of scene graphs below, predict the next 2 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (8 frames, 141 to 657):
            
Frame 000141:
Objects:
  - laptop
Relationships:
  - person looking_at laptop
  - person in_front_of laptop
  - person holding laptop


Frame 000270:
Objects:
  - laptop
Relationships:
  - person looking_at laptop
  - person in_front_of laptop
  - person touching laptop


Frame 000399:
Objects:
  - laptop
Relationships:
  - person looking_at laptop
  - person in_front_of laptop
  - person touching laptop


Frame 000528:
Objects:
  - laptop
Relationships:
  - person looking_at laptop
  - person in_front_of laptop
  - person touching laptop


Frame 000599:
Objects:
  - laptop
Relationships:
  - person looking_at laptop
  - person in_front_of laptop
  - person touching laptop
  - person holding laptop


Frame 000626:
Objects:
  - laptop
Relationships:
  - person not_looking_at laptop
  - person in_front_of laptop
  - person touching laptop


Frame 000653:
Objects:
  - laptop
Relationships:
  - person looking_at laptop
  - person in_front_of laptop
  - person touching laptop


Frame 000657:
Objects:
  - laptop
Relationships:
  - person looking_at laptop
  - person in_front_of laptop
  - person touching laptop

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 2 frames ([680, 707]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:07:03,580 - DEBUG - 
===================

2025-02-06 12:07:03,933 - ERROR - Prediction failed: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:03,935 - DEBUG - Traceback: Traceback (most recent call last):
  File "/Users/sriujjwalreddyb/SceneGraphVLM/llamaAPI.py", line 423, in predict_scene_graphs
    response = model.run(api_request_json)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 67, in run
    return self.run_sync(api_request_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 53, in run_sync
    raise Exception(f"POST {response.status_code} {response.json()['detail']}")
Exception: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.

2025-02-06 12:07:03,936 - ERROR - Failed to process video 16OAM.mp4: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:03,937 - INFO - 
==================================================
Processing video: F99PM.mp4
==================================================
2025-02-06 12:07:03,938 - INFO - Processing video: F99PM.mp4
2025-02-06 12:07:03,940 - INFO - Found 28 frames for video F99PM.mp4
2025-02-06 12:07:03,940 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:03,941 - DEBUG - Found scene graph for frame F99PM.mp4/000093.png
2025-02-06 12:07:03,941 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:03,941 - DEBUG - Found scene graph for frame F99PM.mp4/000107.png
2025-02-06 12:07:03,941 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:03,941 - DEBUG - Found scene graph for frame F99PM.mp4/000160.png
2025-02-06 12:07:03,941 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:03,941 - DEBUG - Found scene graph for frame F99PM.mp4/000231.png
2025-02-06 12:07:03,942 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:03,942 - DEBUG - Found scene graph for frame F99PM.mp4/000234.png
2025-02-06 12:07:03,942 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:03,942 - DEBUG - Found scene graph for frame F99PM.mp4/000277.png
2025-02-06 12:07:03,942 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:03,943 - DEBUG - Found scene graph for frame F99PM.mp4/000302.png
2025-02-06 12:07:03,943 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:03,943 - DEBUG - Found scene graph for frame F99PM.mp4/000361.png
2025-02-06 12:07:03,943 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:03,943 - DEBUG - Found scene graph for frame F99PM.mp4/000373.png
2025-02-06 12:07:03,944 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:03,944 - DEBUG - Found scene graph for frame F99PM.mp4/000444.png
2025-02-06 12:07:03,944 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:03,944 - DEBUG - Found scene graph for frame F99PM.mp4/000461.png
2025-02-06 12:07:03,944 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:03,944 - DEBUG - Found scene graph for frame F99PM.mp4/000488.png
2025-02-06 12:07:03,945 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:03,945 - DEBUG - Found scene graph for frame F99PM.mp4/000601.png
2025-02-06 12:07:03,945 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:03,946 - DEBUG - Found scene graph for frame F99PM.mp4/000615.png
2025-02-06 12:07:03,946 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:03,946 - DEBUG - Found scene graph for frame F99PM.mp4/000638.png
2025-02-06 12:07:03,946 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:03,946 - DEBUG - Found scene graph for frame F99PM.mp4/000645.png
2025-02-06 12:07:03,946 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:07:03,947 - DEBUG - Found scene graph for frame F99PM.mp4/000674.png
2025-02-06 12:07:03,947 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:03,947 - DEBUG - Found scene graph for frame F99PM.mp4/000698.png
2025-02-06 12:07:03,947 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:03,947 - DEBUG - Found scene graph for frame F99PM.mp4/000710.png
2025-02-06 12:07:03,947 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:03,947 - DEBUG - Found scene graph for frame F99PM.mp4/000747.png
2025-02-06 12:07:03,948 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:03,948 - DEBUG - Found scene graph for frame F99PM.mp4/000770.png
2025-02-06 12:07:03,948 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:03,948 - DEBUG - Found scene graph for frame F99PM.mp4/000797.png
2025-02-06 12:07:03,948 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:03,949 - DEBUG - Found scene graph for frame F99PM.mp4/000801.png
2025-02-06 12:07:03,949 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:03,949 - DEBUG - Found scene graph for frame F99PM.mp4/000829.png
2025-02-06 12:07:03,949 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:03,949 - DEBUG - Found scene graph for frame F99PM.mp4/000833.png
2025-02-06 12:07:03,949 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:03,949 - DEBUG - Found scene graph for frame F99PM.mp4/000847.png
2025-02-06 12:07:03,950 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:03,950 - DEBUG - Found scene graph for frame F99PM.mp4/000865.png
2025-02-06 12:07:03,950 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:03,950 - DEBUG - Found scene graph for frame F99PM.mp4/000896.png
2025-02-06 12:07:03,950 - INFO - Extracted 28 scene graphs
2025-02-06 12:07:03,950 - INFO - Split 28 graphs chronologically into 22 train and 6 test
2025-02-06 12:07:03,951 - DEBUG - Training frames: F99PM.mp4/000093.png to F99PM.mp4/000797.png
2025-02-06 12:07:03,951 - DEBUG - Testing frames: F99PM.mp4/000801.png to F99PM.mp4/000896.png
2025-02-06 12:07:03,951 - INFO - 
=== Starting Llama Scene Graph Prediction (Closed Vocabulary) ===
2025-02-06 12:07:03,951 - INFO - Will generate 6 sequential predictions
2025-02-06 12:07:03,951 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:07:03,951 - DEBUG - Starting with 22 training frames
2025-02-06 12:07:03,951 - DEBUG - Frame numbers: [93, 107, 160, 231, 234, 277, 302, 361, 373, 444, 461, 488, 601, 615, 638, 645, 674, 698, 710, 747, 770, 797]
2025-02-06 12:07:03,952 - DEBUG - ============================

2025-02-06 12:07:03,952 - INFO - Found 6 test frames to predict after frame 797
2025-02-06 12:07:03,952 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:07:03,952 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:07:03,952 - DEBUG - Predicting 5 frames: [801, 829, 833, 847, 865]
2025-02-06 12:07:03,953 - DEBUG - Context has 22 frames
2025-02-06 12:07:03,953 - DEBUG - Last 3 context frames: [747, 770, 797]
2025-02-06 12:07:03,972 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000747:
Objects:
  - closet/cabinet
  - chair
Relationships:
  - person unsure closet/cabinet
  - person in_front_of closet/cabinet
  - person holding closet/cabinet
  - person unsure chair
  - person beneath chair
  - person sitting_on chair

Frame 000770:
Objects:
  - closet/cabinet
  - chair
Relationships:
  - person looking_at closet/cabinet
  - person in_front_of closet/cabinet
  - person touching closet/cabinet
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair

Frame 000797:
Objects:
  - closet/cabinet
  - chair
Relationships:
  - person unsure closet/cabinet
  - person in_front_of closet/cabinet
  - person holding closet/cabinet
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair

========================

2025-02-06 12:07:03,973 - DEBUG - 
=======PROMPT========

2025-02-06 12:07:03,973 - DEBUG - Given the sequence of scene graphs below, predict the next 5 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (22 frames, 93 to 797):
            
Frame 000093:
Objects:
  - floor
  - chair
Relationships:
  - person unsure floor
  - person beneath floor
  - person not_contacting floor
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000107:
Objects:
  - floor
  - chair
Relationships:
  - person unsure floor
  - person beneath floor
  - person not_contacting floor
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000160:
Objects:
  - floor
  - chair
Relationships:
  - person not_looking_at floor
  - person beneath floor
  - person sitting_on floor
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000231:
Objects:
  - floor
  - chair
Relationships:
  - person not_looking_at floor
  - person beneath floor
  - person sitting_on floor
  - person not_looking_at chair
  - person in_front_of chair
  - person touching chair


Frame 000234:
Objects:
  - floor
  - chair
Relationships:
  - person not_looking_at floor
  - person beneath floor
  - person sitting_on floor
  - person not_looking_at chair
  - person in_front_of chair
  - person holding chair


Frame 000277:
Objects:
  - floor
  - chair
Relationships:
  - person not_looking_at floor
  - person beneath floor
  - person sitting_on floor
  - person looking_at chair
  - person in_front_of chair
  - person touching chair


Frame 000302:
Objects:
  - floor
  - chair
Relationships:
  - person not_looking_at floor
  - person beneath floor
  - person sitting_on floor
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000361:
Objects:
  - floor
  - chair
Relationships:
  - person looking_at floor
  - person beneath floor
  - person sitting_on floor
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000373:
Objects:
  - floor
  - chair
Relationships:
  - person not_looking_at floor
  - person beneath floor
  - person sitting_on floor
  - person looking_at chair
  - person in_front_of chair
  - person touching chair


Frame 000444:
Objects:
  - floor
  - chair
Relationships:
  - person not_looking_at floor
  - person beneath floor
  - person sitting_on floor
  - person unsure chair
  - person beneath chair
  - person sitting_on chair


Frame 000461:
Objects:
  - floor
  - chair
Relationships:
  - person not_looking_at floor
  - person beneath floor
  - person sitting_on floor
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000488:
Objects:
  - floor
  - chair
Relationships:
  - person not_looking_at floor
  - person beneath floor
  - person sitting_on floor
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000601:
Objects:
  - floor
  - chair
Relationships:
  - person not_looking_at floor
  - person beneath floor
  - person sitting_on floor
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000615:
Objects:
  - floor
  - chair
Relationships:
  - person not_looking_at floor
  - person beneath floor
  - person sitting_on floor
  - person looking_at chair
  - person in_front_of chair
  - person holding chair


Frame 000638:
Objects:
  - floor
  - chair
Relationships:
  - person unsure floor
  - person beneath floor
  - person sitting_on floor
  - person touching floor
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000645:
Objects:
  - floor
  - chair
Relationships:
  - person looking_at floor
  - person beneath floor
  - person touching floor
  - person sitting_on floor
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000674:
Objects:
  - closet/cabinet
  - floor
  - chair
Relationships:
  - person not_looking_at closet/cabinet
  - person in_front_of closet/cabinet
  - person not_contacting closet/cabinet
  - person looking_at floor
  - person beneath floor
  - person in_front_of floor
  - person standing_on floor
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000698:
Objects:
  - closet/cabinet
  - chair
Relationships:
  - person not_looking_at closet/cabinet
  - person in_front_of closet/cabinet
  - person not_contacting closet/cabinet
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000710:
Objects:
  - closet/cabinet
  - chair
Relationships:
  - person looking_at closet/cabinet
  - person in_front_of closet/cabinet
  - person not_contacting closet/cabinet
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000747:
Objects:
  - closet/cabinet
  - chair
Relationships:
  - person unsure closet/cabinet
  - person in_front_of closet/cabinet
  - person holding closet/cabinet
  - person unsure chair
  - person beneath chair
  - person sitting_on chair


Frame 000770:
Objects:
  - closet/cabinet
  - chair
Relationships:
  - person looking_at closet/cabinet
  - person in_front_of closet/cabinet
  - person touching closet/cabinet
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair


Frame 000797:
Objects:
  - closet/cabinet
  - chair
Relationships:
  - person unsure closet/cabinet
  - person in_front_of closet/cabinet
  - person holding closet/cabinet
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 5 frames ([801, 829, 833, 847, 865]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:07:03,973 - DEBUG - 
===================

2025-02-06 12:07:04,356 - ERROR - Prediction failed: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:04,359 - DEBUG - Traceback: Traceback (most recent call last):
  File "/Users/sriujjwalreddyb/SceneGraphVLM/llamaAPI.py", line 423, in predict_scene_graphs
    response = model.run(api_request_json)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 67, in run
    return self.run_sync(api_request_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 53, in run_sync
    raise Exception(f"POST {response.status_code} {response.json()['detail']}")
Exception: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.

2025-02-06 12:07:04,360 - ERROR - Failed to process video F99PM.mp4: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:04,362 - INFO - 
==================================================
Processing video: ANZ0S.mp4
==================================================
2025-02-06 12:07:04,363 - INFO - Processing video: ANZ0S.mp4
2025-02-06 12:07:04,365 - INFO - Found 20 frames for video ANZ0S.mp4
2025-02-06 12:07:04,367 - DEBUG - No valid objects found in annotations for frame ANZ0S.mp4/000021.png
2025-02-06 12:07:04,367 - WARNING - No scene graph found for frame ANZ0S.mp4/000021.png
2025-02-06 12:07:04,367 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:04,367 - DEBUG - Found scene graph for frame ANZ0S.mp4/000061.png
2025-02-06 12:07:04,367 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:04,367 - DEBUG - Found scene graph for frame ANZ0S.mp4/000101.png
2025-02-06 12:07:04,368 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:04,368 - DEBUG - Found scene graph for frame ANZ0S.mp4/000140.png
2025-02-06 12:07:04,368 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:04,368 - DEBUG - Found scene graph for frame ANZ0S.mp4/000180.png
2025-02-06 12:07:04,369 - DEBUG - No valid objects found in annotations for frame ANZ0S.mp4/000335.png
2025-02-06 12:07:04,369 - WARNING - No scene graph found for frame ANZ0S.mp4/000335.png
2025-02-06 12:07:04,369 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:07:04,370 - DEBUG - Found scene graph for frame ANZ0S.mp4/000376.png
2025-02-06 12:07:04,370 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:04,370 - DEBUG - Found scene graph for frame ANZ0S.mp4/000417.png
2025-02-06 12:07:04,370 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:04,370 - DEBUG - Found scene graph for frame ANZ0S.mp4/000431.png
2025-02-06 12:07:04,370 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:04,371 - DEBUG - Found scene graph for frame ANZ0S.mp4/000458.png
2025-02-06 12:07:04,371 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:04,371 - DEBUG - Found scene graph for frame ANZ0S.mp4/000467.png
2025-02-06 12:07:04,371 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:04,373 - DEBUG - Found scene graph for frame ANZ0S.mp4/000499.png
2025-02-06 12:07:04,373 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:04,373 - DEBUG - Found scene graph for frame ANZ0S.mp4/000503.png
2025-02-06 12:07:04,373 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:04,374 - DEBUG - Found scene graph for frame ANZ0S.mp4/000538.png
2025-02-06 12:07:04,374 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:04,374 - DEBUG - Found scene graph for frame ANZ0S.mp4/000574.png
2025-02-06 12:07:04,374 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:04,374 - DEBUG - Found scene graph for frame ANZ0S.mp4/000577.png
2025-02-06 12:07:04,374 - DEBUG - Extracted scene graph with 1 objects and 5 relationships
2025-02-06 12:07:04,375 - DEBUG - Found scene graph for frame ANZ0S.mp4/000633.png
2025-02-06 12:07:04,375 - DEBUG - No valid objects found in annotations for frame ANZ0S.mp4/000689.png
2025-02-06 12:07:04,375 - WARNING - No scene graph found for frame ANZ0S.mp4/000689.png
2025-02-06 12:07:04,375 - DEBUG - Extracted scene graph with 1 objects and 5 relationships
2025-02-06 12:07:04,375 - DEBUG - Found scene graph for frame ANZ0S.mp4/000745.png
2025-02-06 12:07:04,375 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:07:04,375 - DEBUG - Found scene graph for frame ANZ0S.mp4/000801.png
2025-02-06 12:07:04,376 - INFO - Extracted 17 scene graphs
2025-02-06 12:07:04,376 - INFO - Split 17 graphs chronologically into 13 train and 4 test
2025-02-06 12:07:04,376 - DEBUG - Training frames: ANZ0S.mp4/000061.png to ANZ0S.mp4/000574.png
2025-02-06 12:07:04,376 - DEBUG - Testing frames: ANZ0S.mp4/000577.png to ANZ0S.mp4/000801.png
2025-02-06 12:07:04,377 - INFO - 
=== Starting Llama Scene Graph Prediction (Closed Vocabulary) ===
2025-02-06 12:07:04,377 - INFO - Will generate 4 sequential predictions
2025-02-06 12:07:04,377 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:07:04,377 - DEBUG - Starting with 13 training frames
2025-02-06 12:07:04,377 - DEBUG - Frame numbers: [61, 101, 140, 180, 376, 417, 431, 458, 467, 499, 503, 538, 574]
2025-02-06 12:07:04,378 - DEBUG - ============================

2025-02-06 12:07:04,378 - INFO - Found 5 test frames to predict after frame 574
2025-02-06 12:07:04,378 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:07:04,378 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:07:04,378 - DEBUG - Predicting 4 frames: [577, 633, 689, 745]
2025-02-06 12:07:04,379 - DEBUG - Context has 13 frames
2025-02-06 12:07:04,379 - DEBUG - Last 3 context frames: [503, 538, 574]
2025-02-06 12:07:04,387 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000503:
Objects:
  - refrigerator
  - cup/glass/bottle
Relationships:
  - person looking_at refrigerator
  - person in_front_of refrigerator
  - person touching refrigerator
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle

Frame 000538:
Objects:
  - refrigerator
Relationships:
  - person not_looking_at refrigerator
  - person behind refrigerator
  - person not_contacting refrigerator

Frame 000574:
Objects:
  - refrigerator
Relationships:
  - person not_looking_at refrigerator
  - person behind refrigerator
  - person not_contacting refrigerator

========================

2025-02-06 12:07:04,388 - DEBUG - 
=======PROMPT========

2025-02-06 12:07:04,388 - DEBUG - Given the sequence of scene graphs below, predict the next 4 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (13 frames, 61 to 574):
            
Frame 000061:
Objects:
  - refrigerator
Relationships:
  - person looking_at refrigerator
  - person in_front_of refrigerator
  - person not_contacting refrigerator


Frame 000101:
Objects:
  - refrigerator
Relationships:
  - person looking_at refrigerator
  - person in_front_of refrigerator
  - person holding refrigerator


Frame 000140:
Objects:
  - refrigerator
Relationships:
  - person looking_at refrigerator
  - person in_front_of refrigerator
  - person touching refrigerator


Frame 000180:
Objects:
  - refrigerator
Relationships:
  - person looking_at refrigerator
  - person in_front_of refrigerator
  - person touching refrigerator


Frame 000376:
Objects:
  - cup/glass/bottle
Relationships:
  - person looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle
  - person touching cup/glass/bottle


Frame 000417:
Objects:
  - refrigerator
  - cup/glass/bottle
Relationships:
  - person looking_at refrigerator
  - person in_front_of refrigerator
  - person not_contacting refrigerator
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle
  - person drinking_from cup/glass/bottle


Frame 000431:
Objects:
  - refrigerator
  - cup/glass/bottle
Relationships:
  - person not_looking_at refrigerator
  - person in_front_of refrigerator
  - person not_contacting refrigerator
  - person looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle
  - person drinking_from cup/glass/bottle


Frame 000458:
Objects:
  - refrigerator
  - cup/glass/bottle
Relationships:
  - person looking_at refrigerator
  - person in_front_of refrigerator
  - person not_contacting refrigerator
  - person looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle


Frame 000467:
Objects:
  - refrigerator
  - cup/glass/bottle
Relationships:
  - person looking_at refrigerator
  - person in_front_of refrigerator
  - person not_contacting refrigerator
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle


Frame 000499:
Objects:
  - refrigerator
  - cup/glass/bottle
Relationships:
  - person looking_at refrigerator
  - person in_front_of refrigerator
  - person touching refrigerator
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle


Frame 000503:
Objects:
  - refrigerator
  - cup/glass/bottle
Relationships:
  - person looking_at refrigerator
  - person in_front_of refrigerator
  - person touching refrigerator
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle


Frame 000538:
Objects:
  - refrigerator
Relationships:
  - person not_looking_at refrigerator
  - person behind refrigerator
  - person not_contacting refrigerator


Frame 000574:
Objects:
  - refrigerator
Relationships:
  - person not_looking_at refrigerator
  - person behind refrigerator
  - person not_contacting refrigerator

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 4 frames ([577, 633, 689, 745]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:07:04,388 - DEBUG - 
===================

2025-02-06 12:07:04,779 - ERROR - Prediction failed: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:04,781 - DEBUG - Traceback: Traceback (most recent call last):
  File "/Users/sriujjwalreddyb/SceneGraphVLM/llamaAPI.py", line 423, in predict_scene_graphs
    response = model.run(api_request_json)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 67, in run
    return self.run_sync(api_request_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 53, in run_sync
    raise Exception(f"POST {response.status_code} {response.json()['detail']}")
Exception: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.

2025-02-06 12:07:04,782 - ERROR - Failed to process video ANZ0S.mp4: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:04,784 - INFO - 
==================================================
Processing video: G4E4S.mp4
==================================================
2025-02-06 12:07:04,785 - INFO - Processing video: G4E4S.mp4
2025-02-06 12:07:04,786 - INFO - Found 42 frames for video G4E4S.mp4
2025-02-06 12:07:04,787 - DEBUG - No valid objects found in annotations for frame G4E4S.mp4/000153.png
2025-02-06 12:07:04,787 - WARNING - No scene graph found for frame G4E4S.mp4/000153.png
2025-02-06 12:07:04,787 - DEBUG - No valid objects found in annotations for frame G4E4S.mp4/000157.png
2025-02-06 12:07:04,788 - WARNING - No scene graph found for frame G4E4S.mp4/000157.png
2025-02-06 12:07:04,788 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:04,788 - DEBUG - Found scene graph for frame G4E4S.mp4/000186.png
2025-02-06 12:07:04,788 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:04,788 - DEBUG - Found scene graph for frame G4E4S.mp4/000193.png
2025-02-06 12:07:04,788 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:04,789 - DEBUG - Found scene graph for frame G4E4S.mp4/000215.png
2025-02-06 12:07:04,789 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:04,789 - DEBUG - Found scene graph for frame G4E4S.mp4/000233.png
2025-02-06 12:07:04,789 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:04,789 - DEBUG - Found scene graph for frame G4E4S.mp4/000244.png
2025-02-06 12:07:04,789 - DEBUG - No valid objects found in annotations for frame G4E4S.mp4/000273.png
2025-02-06 12:07:04,790 - WARNING - No scene graph found for frame G4E4S.mp4/000273.png
2025-02-06 12:07:04,790 - DEBUG - No valid objects found in annotations for frame G4E4S.mp4/000313.png
2025-02-06 12:07:04,790 - WARNING - No scene graph found for frame G4E4S.mp4/000313.png
2025-02-06 12:07:04,790 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:07:04,790 - DEBUG - Found scene graph for frame G4E4S.mp4/000527.png
2025-02-06 12:07:04,790 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:07:04,791 - DEBUG - Found scene graph for frame G4E4S.mp4/000529.png
2025-02-06 12:07:04,791 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:07:04,791 - DEBUG - Found scene graph for frame G4E4S.mp4/000553.png
2025-02-06 12:07:04,791 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:07:04,791 - DEBUG - Found scene graph for frame G4E4S.mp4/000556.png
2025-02-06 12:07:04,791 - DEBUG - Extracted scene graph with 3 objects and 14 relationships
2025-02-06 12:07:04,791 - DEBUG - Found scene graph for frame G4E4S.mp4/000589.png
2025-02-06 12:07:04,792 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:07:04,792 - DEBUG - Found scene graph for frame G4E4S.mp4/000594.png
2025-02-06 12:07:04,792 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:07:04,792 - DEBUG - Found scene graph for frame G4E4S.mp4/000615.png
2025-02-06 12:07:04,792 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:07:04,792 - DEBUG - Found scene graph for frame G4E4S.mp4/000638.png
2025-02-06 12:07:04,793 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:07:04,793 - DEBUG - Found scene graph for frame G4E4S.mp4/000651.png
2025-02-06 12:07:04,793 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:07:04,793 - DEBUG - Found scene graph for frame G4E4S.mp4/000660.png
2025-02-06 12:07:04,793 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:07:04,793 - DEBUG - Found scene graph for frame G4E4S.mp4/000678.png
2025-02-06 12:07:04,793 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:07:04,794 - DEBUG - Found scene graph for frame G4E4S.mp4/000713.png
2025-02-06 12:07:04,794 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:07:04,794 - DEBUG - Found scene graph for frame G4E4S.mp4/000719.png
2025-02-06 12:07:04,794 - DEBUG - Extracted scene graph with 3 objects and 13 relationships
2025-02-06 12:07:04,794 - DEBUG - Found scene graph for frame G4E4S.mp4/000726.png
2025-02-06 12:07:04,794 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:07:04,795 - DEBUG - Found scene graph for frame G4E4S.mp4/000736.png
2025-02-06 12:07:04,795 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:07:04,795 - DEBUG - Found scene graph for frame G4E4S.mp4/000740.png
2025-02-06 12:07:04,795 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:07:04,795 - DEBUG - Found scene graph for frame G4E4S.mp4/000761.png
2025-02-06 12:07:04,795 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:07:04,795 - DEBUG - Found scene graph for frame G4E4S.mp4/000775.png
2025-02-06 12:07:04,796 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:07:04,796 - DEBUG - Found scene graph for frame G4E4S.mp4/000787.png
2025-02-06 12:07:04,796 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:07:04,796 - DEBUG - Found scene graph for frame G4E4S.mp4/000791.png
2025-02-06 12:07:04,796 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:07:04,796 - DEBUG - Found scene graph for frame G4E4S.mp4/000801.png
2025-02-06 12:07:04,797 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:07:04,797 - DEBUG - Found scene graph for frame G4E4S.mp4/000802.png
2025-02-06 12:07:04,797 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:04,797 - DEBUG - Found scene graph for frame G4E4S.mp4/000813.png
2025-02-06 12:07:04,797 - DEBUG - No valid objects found in annotations for frame G4E4S.mp4/001085.png
2025-02-06 12:07:04,797 - WARNING - No scene graph found for frame G4E4S.mp4/001085.png
2025-02-06 12:07:04,797 - DEBUG - No valid objects found in annotations for frame G4E4S.mp4/001227.png
2025-02-06 12:07:04,798 - WARNING - No scene graph found for frame G4E4S.mp4/001227.png
2025-02-06 12:07:04,798 - DEBUG - No valid objects found in annotations for frame G4E4S.mp4/001369.png
2025-02-06 12:07:04,798 - WARNING - No scene graph found for frame G4E4S.mp4/001369.png
2025-02-06 12:07:04,798 - DEBUG - No valid objects found in annotations for frame G4E4S.mp4/001510.png
2025-02-06 12:07:04,798 - WARNING - No scene graph found for frame G4E4S.mp4/001510.png
2025-02-06 12:07:04,798 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:07:04,799 - DEBUG - Found scene graph for frame G4E4S.mp4/001615.png
2025-02-06 12:07:04,799 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:04,799 - DEBUG - Found scene graph for frame G4E4S.mp4/001652.png
2025-02-06 12:07:04,799 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:04,799 - DEBUG - Found scene graph for frame G4E4S.mp4/001656.png
2025-02-06 12:07:04,799 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:04,800 - DEBUG - Found scene graph for frame G4E4S.mp4/001697.png
2025-02-06 12:07:04,800 - DEBUG - No valid objects found in annotations for frame G4E4S.mp4/001737.png
2025-02-06 12:07:04,800 - WARNING - No scene graph found for frame G4E4S.mp4/001737.png
2025-02-06 12:07:04,800 - DEBUG - No valid objects found in annotations for frame G4E4S.mp4/001778.png
2025-02-06 12:07:04,800 - WARNING - No scene graph found for frame G4E4S.mp4/001778.png
2025-02-06 12:07:04,801 - INFO - Extracted 32 scene graphs
2025-02-06 12:07:04,801 - INFO - Split 32 graphs chronologically into 25 train and 7 test
2025-02-06 12:07:04,801 - DEBUG - Training frames: G4E4S.mp4/000186.png to G4E4S.mp4/000791.png
2025-02-06 12:07:04,801 - DEBUG - Testing frames: G4E4S.mp4/000801.png to G4E4S.mp4/001697.png
2025-02-06 12:07:04,801 - INFO - 
=== Starting Llama Scene Graph Prediction (Closed Vocabulary) ===
2025-02-06 12:07:04,801 - INFO - Will generate 7 sequential predictions
2025-02-06 12:07:04,801 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:07:04,802 - DEBUG - Starting with 25 training frames
2025-02-06 12:07:04,802 - DEBUG - Frame numbers: [186, 193, 215, 233, 244, 527, 529, 553, 556, 589, 594, 615, 638, 651, 660, 678, 713, 719, 726, 736, 740, 761, 775, 787, 791]
2025-02-06 12:07:04,802 - DEBUG - ============================

2025-02-06 12:07:04,802 - INFO - Found 13 test frames to predict after frame 791
2025-02-06 12:07:04,802 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:07:04,803 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:07:04,803 - DEBUG - Predicting 5 frames: [801, 802, 813, 1085, 1227]
2025-02-06 12:07:04,803 - DEBUG - Context has 25 frames
2025-02-06 12:07:04,803 - DEBUG - Last 3 context frames: [775, 787, 791]
2025-02-06 12:07:04,826 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000775:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person not_contacting shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person other_relationship chair

Frame 000787:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person on_the_side_of shoe
  - person not_contacting shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person behind chair
  - person not_contacting chair

Frame 000791:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person in_front_of shoe
  - person not_contacting shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person behind chair
  - person not_contacting chair

========================

2025-02-06 12:07:04,826 - DEBUG - 
=======PROMPT========

2025-02-06 12:07:04,826 - DEBUG - Given the sequence of scene graphs below, predict the next 5 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (25 frames, 186 to 791):
            
Frame 000186:
Objects:
  - clothes
Relationships:
  - person unsure clothes
  - person in_front_of clothes
  - person holding clothes


Frame 000193:
Objects:
  - clothes
Relationships:
  - person looking_at clothes
  - person in_front_of clothes
  - person holding clothes


Frame 000215:
Objects:
  - clothes
Relationships:
  - person unsure clothes
  - person in_front_of clothes
  - person holding clothes


Frame 000233:
Objects:
  - clothes
Relationships:
  - person not_looking_at clothes
  - person in_front_of clothes
  - person holding clothes


Frame 000244:
Objects:
  - clothes
Relationships:
  - person unsure clothes
  - person in_front_of clothes
  - person holding clothes


Frame 000527:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person wearing shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person other_relationship chair


Frame 000529:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person wearing shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person other_relationship chair


Frame 000553:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person in_front_of shoe
  - person wearing shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person behind chair
  - person beneath chair
  - person sitting_on chair
  - person leaning_on chair


Frame 000556:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person in_front_of shoe
  - person wearing shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person on_the_side_of chair
  - person sitting_on chair


Frame 000589:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person in_front_of shoe
  - person beneath shoe
  - person holding shoe
  - person touching shoe
  - person wearing shoe
  - person not_contacting shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair


Frame 000594:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person in_front_of shoe
  - person beneath shoe
  - person holding shoe
  - person wearing shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person unsure chair
  - person beneath chair
  - person sitting_on chair


Frame 000615:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person looking_at shoe
  - person beneath shoe
  - person in_front_of shoe
  - person holding shoe
  - person wearing shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person on_the_side_of chair
  - person sitting_on chair


Frame 000638:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person looking_at shoe
  - person beneath shoe
  - person in_front_of shoe
  - person wearing shoe
  - person holding shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person on_the_side_of chair
  - person sitting_on chair


Frame 000651:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person looking_at shoe
  - person beneath shoe
  - person in_front_of shoe
  - person holding shoe
  - person wearing shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair


Frame 000660:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person in_front_of shoe
  - person wearing shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person touching table
  - person not_looking_at chair
  - person beneath chair
  - person on_the_side_of chair
  - person sitting_on chair


Frame 000678:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person in_front_of shoe
  - person holding shoe
  - person wearing shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person on_the_side_of chair
  - person sitting_on chair


Frame 000713:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person in_front_of shoe
  - person holding shoe
  - person wearing shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person on_the_side_of chair
  - person sitting_on chair


Frame 000719:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person in_front_of shoe
  - person holding shoe
  - person wearing shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair


Frame 000726:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person above shoe
  - person beneath shoe
  - person on_the_side_of shoe
  - person touching shoe
  - person not_contacting shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person on_the_side_of chair
  - person sitting_on chair


Frame 000736:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person on_the_side_of shoe
  - person not_contacting shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000740:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person in_front_of shoe
  - person not_contacting shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person on_the_side_of chair
  - person sitting_on chair


Frame 000761:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person looking_at shoe
  - person beneath shoe
  - person on_the_side_of shoe
  - person touching shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000775:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person not_contacting shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person other_relationship chair


Frame 000787:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person on_the_side_of shoe
  - person not_contacting shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person behind chair
  - person not_contacting chair


Frame 000791:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person in_front_of shoe
  - person not_contacting shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person behind chair
  - person not_contacting chair

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 5 frames ([801, 802, 813, 1085, 1227]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:07:04,827 - DEBUG - 
===================

2025-02-06 12:07:05,174 - ERROR - Prediction failed: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:05,176 - DEBUG - Traceback: Traceback (most recent call last):
  File "/Users/sriujjwalreddyb/SceneGraphVLM/llamaAPI.py", line 423, in predict_scene_graphs
    response = model.run(api_request_json)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 67, in run
    return self.run_sync(api_request_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 53, in run_sync
    raise Exception(f"POST {response.status_code} {response.json()['detail']}")
Exception: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.

2025-02-06 12:07:05,177 - ERROR - Failed to process video G4E4S.mp4: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:05,179 - INFO - 
==================================================
Processing video: NYHD7.mp4
==================================================
2025-02-06 12:07:05,180 - INFO - Processing video: NYHD7.mp4
2025-02-06 12:07:05,182 - INFO - Found 39 frames for video NYHD7.mp4
2025-02-06 12:07:05,183 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,183 - DEBUG - Found scene graph for frame NYHD7.mp4/000015.png
2025-02-06 12:07:05,184 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,184 - DEBUG - Found scene graph for frame NYHD7.mp4/000043.png
2025-02-06 12:07:05,184 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,184 - DEBUG - Found scene graph for frame NYHD7.mp4/000071.png
2025-02-06 12:07:05,184 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,184 - DEBUG - Found scene graph for frame NYHD7.mp4/000082.png
2025-02-06 12:07:05,185 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,185 - DEBUG - Found scene graph for frame NYHD7.mp4/000099.png
2025-02-06 12:07:05,185 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,185 - DEBUG - Found scene graph for frame NYHD7.mp4/000127.png
2025-02-06 12:07:05,186 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,186 - DEBUG - Found scene graph for frame NYHD7.mp4/000161.png
2025-02-06 12:07:05,186 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,186 - DEBUG - Found scene graph for frame NYHD7.mp4/000169.png
2025-02-06 12:07:05,186 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,186 - DEBUG - Found scene graph for frame NYHD7.mp4/000192.png
2025-02-06 12:07:05,187 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,187 - DEBUG - Found scene graph for frame NYHD7.mp4/000233.png
2025-02-06 12:07:05,187 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,187 - DEBUG - Found scene graph for frame NYHD7.mp4/000243.png
2025-02-06 12:07:05,188 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,188 - DEBUG - Found scene graph for frame NYHD7.mp4/000274.png
2025-02-06 12:07:05,188 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,188 - DEBUG - Found scene graph for frame NYHD7.mp4/000288.png
2025-02-06 12:07:05,189 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,189 - DEBUG - Found scene graph for frame NYHD7.mp4/000294.png
2025-02-06 12:07:05,189 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,189 - DEBUG - Found scene graph for frame NYHD7.mp4/000314.png
2025-02-06 12:07:05,189 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,189 - DEBUG - Found scene graph for frame NYHD7.mp4/000355.png
2025-02-06 12:07:05,190 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,190 - DEBUG - Found scene graph for frame NYHD7.mp4/000404.png
2025-02-06 12:07:05,190 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,190 - DEBUG - Found scene graph for frame NYHD7.mp4/000416.png
2025-02-06 12:07:05,190 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,190 - DEBUG - Found scene graph for frame NYHD7.mp4/000420.png
2025-02-06 12:07:05,191 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,191 - DEBUG - Found scene graph for frame NYHD7.mp4/000543.png
2025-02-06 12:07:05,191 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,191 - DEBUG - Found scene graph for frame NYHD7.mp4/000546.png
2025-02-06 12:07:05,191 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,191 - DEBUG - Found scene graph for frame NYHD7.mp4/000565.png
2025-02-06 12:07:05,192 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,192 - DEBUG - Found scene graph for frame NYHD7.mp4/000567.png
2025-02-06 12:07:05,192 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:07:05,192 - DEBUG - Found scene graph for frame NYHD7.mp4/000620.png
2025-02-06 12:07:05,192 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,192 - DEBUG - Found scene graph for frame NYHD7.mp4/000670.png
2025-02-06 12:07:05,193 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,193 - DEBUG - Found scene graph for frame NYHD7.mp4/000671.png
2025-02-06 12:07:05,193 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,193 - DEBUG - Found scene graph for frame NYHD7.mp4/000673.png
2025-02-06 12:07:05,193 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,193 - DEBUG - Found scene graph for frame NYHD7.mp4/000686.png
2025-02-06 12:07:05,194 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,194 - DEBUG - Found scene graph for frame NYHD7.mp4/000715.png
2025-02-06 12:07:05,194 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,194 - DEBUG - Found scene graph for frame NYHD7.mp4/000726.png
2025-02-06 12:07:05,194 - DEBUG - No valid objects found in annotations for frame NYHD7.mp4/000744.png
2025-02-06 12:07:05,194 - WARNING - No scene graph found for frame NYHD7.mp4/000744.png
2025-02-06 12:07:05,195 - DEBUG - No valid objects found in annotations for frame NYHD7.mp4/000772.png
2025-02-06 12:07:05,195 - WARNING - No scene graph found for frame NYHD7.mp4/000772.png
2025-02-06 12:07:05,195 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,195 - DEBUG - Found scene graph for frame NYHD7.mp4/000779.png
2025-02-06 12:07:05,195 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,195 - DEBUG - Found scene graph for frame NYHD7.mp4/000790.png
2025-02-06 12:07:05,196 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,196 - DEBUG - Found scene graph for frame NYHD7.mp4/000801.png
2025-02-06 12:07:05,196 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,196 - DEBUG - Found scene graph for frame NYHD7.mp4/000816.png
2025-02-06 12:07:05,196 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,196 - DEBUG - Found scene graph for frame NYHD7.mp4/000843.png
2025-02-06 12:07:05,197 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,197 - DEBUG - Found scene graph for frame NYHD7.mp4/000869.png
2025-02-06 12:07:05,197 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,197 - DEBUG - Found scene graph for frame NYHD7.mp4/000895.png
2025-02-06 12:07:05,197 - INFO - Extracted 37 scene graphs
2025-02-06 12:07:05,198 - INFO - Split 37 graphs chronologically into 29 train and 8 test
2025-02-06 12:07:05,198 - DEBUG - Training frames: NYHD7.mp4/000015.png to NYHD7.mp4/000715.png
2025-02-06 12:07:05,198 - DEBUG - Testing frames: NYHD7.mp4/000726.png to NYHD7.mp4/000895.png
2025-02-06 12:07:05,198 - INFO - 
=== Starting Llama Scene Graph Prediction (Closed Vocabulary) ===
2025-02-06 12:07:05,198 - INFO - Will generate 8 sequential predictions
2025-02-06 12:07:05,198 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:07:05,199 - DEBUG - Starting with 29 training frames
2025-02-06 12:07:05,199 - DEBUG - Frame numbers: [15, 43, 71, 82, 99, 127, 161, 169, 192, 233, 243, 274, 288, 294, 314, 355, 404, 416, 420, 543, 546, 565, 567, 620, 670, 671, 673, 686, 715]
2025-02-06 12:07:05,199 - DEBUG - ============================

2025-02-06 12:07:05,199 - INFO - Found 10 test frames to predict after frame 715
2025-02-06 12:07:05,199 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:07:05,200 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:07:05,200 - DEBUG - Predicting 5 frames: [726, 744, 772, 779, 790]
2025-02-06 12:07:05,200 - DEBUG - Context has 29 frames
2025-02-06 12:07:05,200 - DEBUG - Last 3 context frames: [673, 686, 715]
2025-02-06 12:07:05,219 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000673:
Objects:
  - phone/camera
Relationships:
  - person unsure phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera

Frame 000686:
Objects:
  - phone/camera
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera

Frame 000715:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera

========================

2025-02-06 12:07:05,220 - DEBUG - 
=======PROMPT========

2025-02-06 12:07:05,220 - DEBUG - Given the sequence of scene graphs below, predict the next 5 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (29 frames, 15 to 715):
            
Frame 000015:
Objects:
  - table
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table


Frame 000043:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000071:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000082:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000099:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000127:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000161:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000169:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000192:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000233:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000243:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000274:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000288:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000294:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000314:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000355:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000404:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000416:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000420:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000543:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000546:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000565:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000567:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000620:
Objects:
  - phone/camera
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person touching phone/camera


Frame 000670:
Objects:
  - phone/camera
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera


Frame 000671:
Objects:
  - phone/camera
Relationships:
  - person unsure phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera


Frame 000673:
Objects:
  - phone/camera
Relationships:
  - person unsure phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera


Frame 000686:
Objects:
  - phone/camera
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera


Frame 000715:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 5 frames ([726, 744, 772, 779, 790]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:07:05,220 - DEBUG - 
===================

2025-02-06 12:07:05,557 - ERROR - Prediction failed: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:05,560 - DEBUG - Traceback: Traceback (most recent call last):
  File "/Users/sriujjwalreddyb/SceneGraphVLM/llamaAPI.py", line 423, in predict_scene_graphs
    response = model.run(api_request_json)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 67, in run
    return self.run_sync(api_request_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 53, in run_sync
    raise Exception(f"POST {response.status_code} {response.json()['detail']}")
Exception: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.

2025-02-06 12:07:05,561 - ERROR - Failed to process video NYHD7.mp4: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:05,563 - INFO - 
==================================================
Processing video: BPT87.mp4
==================================================
2025-02-06 12:07:05,564 - INFO - Processing video: BPT87.mp4
2025-02-06 12:07:05,565 - INFO - Found 40 frames for video BPT87.mp4
2025-02-06 12:07:05,566 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,566 - DEBUG - Found scene graph for frame BPT87.mp4/000205.png
2025-02-06 12:07:05,566 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,567 - DEBUG - Found scene graph for frame BPT87.mp4/000216.png
2025-02-06 12:07:05,567 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,567 - DEBUG - Found scene graph for frame BPT87.mp4/000221.png
2025-02-06 12:07:05,567 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:07:05,567 - DEBUG - Found scene graph for frame BPT87.mp4/000223.png
2025-02-06 12:07:05,568 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,568 - DEBUG - Found scene graph for frame BPT87.mp4/000226.png
2025-02-06 12:07:05,568 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,569 - DEBUG - Found scene graph for frame BPT87.mp4/000227.png
2025-02-06 12:07:05,569 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,569 - DEBUG - Found scene graph for frame BPT87.mp4/000230.png
2025-02-06 12:07:05,569 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,569 - DEBUG - Found scene graph for frame BPT87.mp4/000231.png
2025-02-06 12:07:05,570 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:05,570 - DEBUG - Found scene graph for frame BPT87.mp4/000242.png
2025-02-06 12:07:05,570 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:05,570 - DEBUG - Found scene graph for frame BPT87.mp4/000244.png
2025-02-06 12:07:05,570 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:07:05,571 - DEBUG - Found scene graph for frame BPT87.mp4/000245.png
2025-02-06 12:07:05,571 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:07:05,571 - DEBUG - Found scene graph for frame BPT87.mp4/000255.png
2025-02-06 12:07:05,571 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:05,572 - DEBUG - Found scene graph for frame BPT87.mp4/000261.png
2025-02-06 12:07:05,572 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:07:05,572 - DEBUG - Found scene graph for frame BPT87.mp4/000262.png
2025-02-06 12:07:05,572 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:05,572 - DEBUG - Found scene graph for frame BPT87.mp4/000263.png
2025-02-06 12:07:05,572 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:05,573 - DEBUG - Found scene graph for frame BPT87.mp4/000272.png
2025-02-06 12:07:05,573 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:07:05,573 - DEBUG - Found scene graph for frame BPT87.mp4/000279.png
2025-02-06 12:07:05,573 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:07:05,573 - DEBUG - Found scene graph for frame BPT87.mp4/000280.png
2025-02-06 12:07:05,573 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:07:05,574 - DEBUG - Found scene graph for frame BPT87.mp4/000281.png
2025-02-06 12:07:05,574 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:05,574 - DEBUG - Found scene graph for frame BPT87.mp4/000282.png
2025-02-06 12:07:05,574 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:05,574 - DEBUG - Found scene graph for frame BPT87.mp4/000299.png
2025-02-06 12:07:05,575 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:05,575 - DEBUG - Found scene graph for frame BPT87.mp4/000300.png
2025-02-06 12:07:05,575 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:05,575 - DEBUG - Found scene graph for frame BPT87.mp4/000302.png
2025-02-06 12:07:05,575 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:05,575 - DEBUG - Found scene graph for frame BPT87.mp4/000303.png
2025-02-06 12:07:05,576 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:05,576 - DEBUG - Found scene graph for frame BPT87.mp4/000326.png
2025-02-06 12:07:05,576 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:07:05,576 - DEBUG - Found scene graph for frame BPT87.mp4/000329.png
2025-02-06 12:07:05,576 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:07:05,576 - DEBUG - Found scene graph for frame BPT87.mp4/000333.png
2025-02-06 12:07:05,577 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:05,577 - DEBUG - Found scene graph for frame BPT87.mp4/000356.png
2025-02-06 12:07:05,577 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:05,577 - DEBUG - Found scene graph for frame BPT87.mp4/000385.png
2025-02-06 12:07:05,577 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:05,577 - DEBUG - Found scene graph for frame BPT87.mp4/000400.png
2025-02-06 12:07:05,577 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:05,578 - DEBUG - Found scene graph for frame BPT87.mp4/000411.png
2025-02-06 12:07:05,578 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:05,578 - DEBUG - Found scene graph for frame BPT87.mp4/000412.png
2025-02-06 12:07:05,578 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:07:05,578 - DEBUG - Found scene graph for frame BPT87.mp4/000421.png
2025-02-06 12:07:05,578 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:05,579 - DEBUG - Found scene graph for frame BPT87.mp4/000438.png
2025-02-06 12:07:05,579 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:05,579 - DEBUG - Found scene graph for frame BPT87.mp4/000441.png
2025-02-06 12:07:05,579 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:05,579 - DEBUG - Found scene graph for frame BPT87.mp4/000443.png
2025-02-06 12:07:05,580 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:05,580 - DEBUG - Found scene graph for frame BPT87.mp4/000465.png
2025-02-06 12:07:05,580 - DEBUG - No valid objects found in annotations for frame BPT87.mp4/000466.png
2025-02-06 12:07:05,580 - WARNING - No scene graph found for frame BPT87.mp4/000466.png
2025-02-06 12:07:05,580 - DEBUG - No valid objects found in annotations for frame BPT87.mp4/000469.png
2025-02-06 12:07:05,580 - WARNING - No scene graph found for frame BPT87.mp4/000469.png
2025-02-06 12:07:05,581 - DEBUG - No valid objects found in annotations for frame BPT87.mp4/000486.png
2025-02-06 12:07:05,581 - WARNING - No scene graph found for frame BPT87.mp4/000486.png
2025-02-06 12:07:05,581 - INFO - Extracted 37 scene graphs
2025-02-06 12:07:05,581 - INFO - Split 37 graphs chronologically into 29 train and 8 test
2025-02-06 12:07:05,581 - DEBUG - Training frames: BPT87.mp4/000205.png to BPT87.mp4/000385.png
2025-02-06 12:07:05,582 - DEBUG - Testing frames: BPT87.mp4/000400.png to BPT87.mp4/000465.png
2025-02-06 12:07:05,582 - INFO - 
=== Starting Llama Scene Graph Prediction (Closed Vocabulary) ===
2025-02-06 12:07:05,582 - INFO - Will generate 8 sequential predictions
2025-02-06 12:07:05,582 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:07:05,582 - DEBUG - Starting with 29 training frames
2025-02-06 12:07:05,582 - DEBUG - Frame numbers: [205, 216, 221, 223, 226, 227, 230, 231, 242, 244, 245, 255, 261, 262, 263, 272, 279, 280, 281, 282, 299, 300, 302, 303, 326, 329, 333, 356, 385]
2025-02-06 12:07:05,583 - DEBUG - ============================

2025-02-06 12:07:05,583 - INFO - Found 11 test frames to predict after frame 385
2025-02-06 12:07:05,583 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:07:05,583 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:07:05,583 - DEBUG - Predicting 5 frames: [400, 411, 412, 421, 438]
2025-02-06 12:07:05,584 - DEBUG - Context has 29 frames
2025-02-06 12:07:05,584 - DEBUG - Last 3 context frames: [333, 356, 385]
2025-02-06 12:07:05,604 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000333:
Objects:
  - towel
  - clothes
  - broom
Relationships:
  - person not_looking_at towel
  - person in_front_of towel
  - person on_the_side_of towel
  - person holding towel
  - person not_looking_at clothes
  - person in_front_of clothes
  - person holding clothes
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom

Frame 000356:
Objects:
  - towel
  - broom
Relationships:
  - person not_looking_at towel
  - person in_front_of towel
  - person on_the_side_of towel
  - person other_relationship towel
  - person looking_at broom
  - person in_front_of broom
  - person holding broom

Frame 000385:
Objects:
  - broom
Relationships:
  - person looking_at broom
  - person in_front_of broom
  - person holding broom

========================

2025-02-06 12:07:05,604 - DEBUG - 
=======PROMPT========

2025-02-06 12:07:05,604 - DEBUG - Given the sequence of scene graphs below, predict the next 5 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (29 frames, 205 to 385):
            
Frame 000205:
Objects:
  - broom
Relationships:
  - person looking_at broom
  - person in_front_of broom
  - person not_contacting broom


Frame 000216:
Objects:
  - broom
Relationships:
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000221:
Objects:
  - broom
Relationships:
  - person not_looking_at broom
  - person in_front_of broom
  - person not_contacting broom


Frame 000223:
Objects:
  - broom
Relationships:
  - person not_looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person not_contacting broom


Frame 000226:
Objects:
  - broom
Relationships:
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000227:
Objects:
  - broom
Relationships:
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000230:
Objects:
  - broom
Relationships:
  - person not_looking_at broom
  - person in_front_of broom
  - person not_contacting broom


Frame 000231:
Objects:
  - broom
Relationships:
  - person not_looking_at broom
  - person in_front_of broom
  - person not_contacting broom


Frame 000242:
Objects:
  - towel
  - broom
Relationships:
  - person unsure towel
  - person in_front_of towel
  - person on_the_side_of towel
  - person holding towel
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000244:
Objects:
  - towel
  - broom
Relationships:
  - person not_looking_at towel
  - person in_front_of towel
  - person touching towel
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000245:
Objects:
  - towel
  - clothes
  - broom
Relationships:
  - person looking_at towel
  - person in_front_of towel
  - person holding towel
  - person unsure clothes
  - person in_front_of clothes
  - person holding clothes
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000255:
Objects:
  - towel
Relationships:
  - person looking_at towel
  - person in_front_of towel
  - person holding towel
  - person touching towel


Frame 000261:
Objects:
  - towel
  - broom
Relationships:
  - person looking_at towel
  - person in_front_of towel
  - person holding towel
  - person looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000262:
Objects:
  - towel
  - clothes
  - broom
Relationships:
  - person looking_at towel
  - person in_front_of towel
  - person holding towel
  - person unsure clothes
  - person in_front_of clothes
  - person holding clothes
  - person not_looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000263:
Objects:
  - towel
  - broom
Relationships:
  - person looking_at towel
  - person in_front_of towel
  - person on_the_side_of towel
  - person holding towel
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000272:
Objects:
  - towel
  - broom
Relationships:
  - person looking_at towel
  - person in_front_of towel
  - person holding towel
  - person looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000279:
Objects:
  - towel
  - broom
Relationships:
  - person looking_at towel
  - person beneath towel
  - person in_front_of towel
  - person holding towel
  - person looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000280:
Objects:
  - towel
  - clothes
  - broom
Relationships:
  - person looking_at towel
  - person in_front_of towel
  - person holding towel
  - person looking_at clothes
  - person in_front_of clothes
  - person holding clothes
  - person looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000281:
Objects:
  - towel
  - broom
Relationships:
  - person not_looking_at towel
  - person in_front_of towel
  - person beneath towel
  - person on_the_side_of towel
  - person holding towel
  - person looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000282:
Objects:
  - towel
  - broom
Relationships:
  - person looking_at towel
  - person in_front_of towel
  - person holding towel
  - person looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000299:
Objects:
  - towel
  - broom
Relationships:
  - person looking_at towel
  - person in_front_of towel
  - person holding towel
  - person touching towel
  - person looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000300:
Objects:
  - towel
  - broom
Relationships:
  - person looking_at towel
  - person in_front_of towel
  - person on_the_side_of towel
  - person holding towel
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000302:
Objects:
  - towel
  - broom
Relationships:
  - person looking_at towel
  - person on_the_side_of towel
  - person holding towel
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000303:
Objects:
  - towel
  - broom
Relationships:
  - person looking_at towel
  - person in_front_of towel
  - person on_the_side_of towel
  - person holding towel
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000326:
Objects:
  - towel
  - broom
Relationships:
  - person not_looking_at towel
  - person in_front_of towel
  - person on_the_side_of towel
  - person holding towel
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000329:
Objects:
  - towel
  - broom
Relationships:
  - person not_looking_at towel
  - person in_front_of towel
  - person on_the_side_of towel
  - person holding towel
  - person looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000333:
Objects:
  - towel
  - clothes
  - broom
Relationships:
  - person not_looking_at towel
  - person in_front_of towel
  - person on_the_side_of towel
  - person holding towel
  - person not_looking_at clothes
  - person in_front_of clothes
  - person holding clothes
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000356:
Objects:
  - towel
  - broom
Relationships:
  - person not_looking_at towel
  - person in_front_of towel
  - person on_the_side_of towel
  - person other_relationship towel
  - person looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000385:
Objects:
  - broom
Relationships:
  - person looking_at broom
  - person in_front_of broom
  - person holding broom

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 5 frames ([400, 411, 412, 421, 438]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:07:05,605 - DEBUG - 
===================

2025-02-06 12:07:06,006 - ERROR - Prediction failed: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:06,007 - DEBUG - Traceback: Traceback (most recent call last):
  File "/Users/sriujjwalreddyb/SceneGraphVLM/llamaAPI.py", line 423, in predict_scene_graphs
    response = model.run(api_request_json)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 67, in run
    return self.run_sync(api_request_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 53, in run_sync
    raise Exception(f"POST {response.status_code} {response.json()['detail']}")
Exception: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.

2025-02-06 12:07:06,007 - ERROR - Failed to process video BPT87.mp4: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:06,007 - INFO - 
==================================================
Processing video: 3G4PN.mp4
==================================================
2025-02-06 12:07:06,008 - INFO - Processing video: 3G4PN.mp4
2025-02-06 12:07:06,009 - INFO - Found 39 frames for video 3G4PN.mp4
2025-02-06 12:07:06,009 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,010 - DEBUG - Found scene graph for frame 3G4PN.mp4/000079.png
2025-02-06 12:07:06,010 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,010 - DEBUG - Found scene graph for frame 3G4PN.mp4/000082.png
2025-02-06 12:07:06,010 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,010 - DEBUG - Found scene graph for frame 3G4PN.mp4/000083.png
2025-02-06 12:07:06,010 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,011 - DEBUG - Found scene graph for frame 3G4PN.mp4/000234.png
2025-02-06 12:07:06,011 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,011 - DEBUG - Found scene graph for frame 3G4PN.mp4/000244.png
2025-02-06 12:07:06,011 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,012 - DEBUG - Found scene graph for frame 3G4PN.mp4/000246.png
2025-02-06 12:07:06,012 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,012 - DEBUG - Found scene graph for frame 3G4PN.mp4/000390.png
2025-02-06 12:07:06,013 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,013 - DEBUG - Found scene graph for frame 3G4PN.mp4/000406.png
2025-02-06 12:07:06,013 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,013 - DEBUG - Found scene graph for frame 3G4PN.mp4/000409.png
2025-02-06 12:07:06,013 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,013 - DEBUG - Found scene graph for frame 3G4PN.mp4/000545.png
2025-02-06 12:07:06,014 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,014 - DEBUG - Found scene graph for frame 3G4PN.mp4/000568.png
2025-02-06 12:07:06,014 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,014 - DEBUG - Found scene graph for frame 3G4PN.mp4/000570.png
2025-02-06 12:07:06,014 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,014 - DEBUG - Found scene graph for frame 3G4PN.mp4/000572.png
2025-02-06 12:07:06,015 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,015 - DEBUG - Found scene graph for frame 3G4PN.mp4/000599.png
2025-02-06 12:07:06,015 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,015 - DEBUG - Found scene graph for frame 3G4PN.mp4/000628.png
2025-02-06 12:07:06,015 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:07:06,015 - DEBUG - Found scene graph for frame 3G4PN.mp4/000654.png
2025-02-06 12:07:06,016 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:07:06,016 - DEBUG - Found scene graph for frame 3G4PN.mp4/000655.png
2025-02-06 12:07:06,016 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:07:06,016 - DEBUG - Found scene graph for frame 3G4PN.mp4/000657.png
2025-02-06 12:07:06,016 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:07:06,017 - DEBUG - Found scene graph for frame 3G4PN.mp4/000673.png
2025-02-06 12:07:06,017 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:07:06,017 - DEBUG - Found scene graph for frame 3G4PN.mp4/000678.png
2025-02-06 12:07:06,017 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:07:06,017 - DEBUG - Found scene graph for frame 3G4PN.mp4/000686.png
2025-02-06 12:07:06,017 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:07:06,018 - DEBUG - Found scene graph for frame 3G4PN.mp4/000689.png
2025-02-06 12:07:06,018 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:07:06,018 - DEBUG - Found scene graph for frame 3G4PN.mp4/000691.png
2025-02-06 12:07:06,018 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:07:06,018 - DEBUG - Found scene graph for frame 3G4PN.mp4/000700.png
2025-02-06 12:07:06,018 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,019 - DEBUG - Found scene graph for frame 3G4PN.mp4/000710.png
2025-02-06 12:07:06,019 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,019 - DEBUG - Found scene graph for frame 3G4PN.mp4/000712.png
2025-02-06 12:07:06,019 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,020 - DEBUG - Found scene graph for frame 3G4PN.mp4/000722.png
2025-02-06 12:07:06,020 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:06,021 - DEBUG - Found scene graph for frame 3G4PN.mp4/000728.png
2025-02-06 12:07:06,021 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,021 - DEBUG - Found scene graph for frame 3G4PN.mp4/000730.png
2025-02-06 12:07:06,021 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,022 - DEBUG - Found scene graph for frame 3G4PN.mp4/000732.png
2025-02-06 12:07:06,022 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:06,022 - DEBUG - Found scene graph for frame 3G4PN.mp4/000735.png
2025-02-06 12:07:06,022 - DEBUG - No valid objects found in annotations for frame 3G4PN.mp4/000745.png
2025-02-06 12:07:06,022 - WARNING - No scene graph found for frame 3G4PN.mp4/000745.png
2025-02-06 12:07:06,023 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:07:06,023 - DEBUG - Found scene graph for frame 3G4PN.mp4/000750.png
2025-02-06 12:07:06,023 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:06,024 - DEBUG - Found scene graph for frame 3G4PN.mp4/000753.png
2025-02-06 12:07:06,024 - DEBUG - No valid objects found in annotations for frame 3G4PN.mp4/000765.png
2025-02-06 12:07:06,024 - WARNING - No scene graph found for frame 3G4PN.mp4/000765.png
2025-02-06 12:07:06,024 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:06,024 - DEBUG - Found scene graph for frame 3G4PN.mp4/000774.png
2025-02-06 12:07:06,024 - DEBUG - No valid objects found in annotations for frame 3G4PN.mp4/000788.png
2025-02-06 12:07:06,025 - WARNING - No scene graph found for frame 3G4PN.mp4/000788.png
2025-02-06 12:07:06,025 - DEBUG - No valid objects found in annotations for frame 3G4PN.mp4/000802.png
2025-02-06 12:07:06,025 - WARNING - No scene graph found for frame 3G4PN.mp4/000802.png
2025-02-06 12:07:06,025 - DEBUG - No valid objects found in annotations for frame 3G4PN.mp4/000827.png
2025-02-06 12:07:06,025 - WARNING - No scene graph found for frame 3G4PN.mp4/000827.png
2025-02-06 12:07:06,026 - INFO - Extracted 34 scene graphs
2025-02-06 12:07:06,026 - INFO - Split 34 graphs chronologically into 27 train and 7 test
2025-02-06 12:07:06,026 - DEBUG - Training frames: 3G4PN.mp4/000079.png to 3G4PN.mp4/000722.png
2025-02-06 12:07:06,026 - DEBUG - Testing frames: 3G4PN.mp4/000728.png to 3G4PN.mp4/000774.png
2025-02-06 12:07:06,026 - INFO - 
=== Starting Llama Scene Graph Prediction (Closed Vocabulary) ===
2025-02-06 12:07:06,027 - INFO - Will generate 7 sequential predictions
2025-02-06 12:07:06,027 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:07:06,027 - DEBUG - Starting with 27 training frames
2025-02-06 12:07:06,027 - DEBUG - Frame numbers: [79, 82, 83, 234, 244, 246, 390, 406, 409, 545, 568, 570, 572, 599, 628, 654, 655, 657, 673, 678, 686, 689, 691, 700, 710, 712, 722]
2025-02-06 12:07:06,027 - DEBUG - ============================

2025-02-06 12:07:06,028 - INFO - Found 12 test frames to predict after frame 722
2025-02-06 12:07:06,028 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:07:06,028 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:07:06,028 - DEBUG - Predicting 5 frames: [728, 730, 732, 735, 745]
2025-02-06 12:07:06,028 - DEBUG - Context has 27 frames
2025-02-06 12:07:06,028 - DEBUG - Last 3 context frames: [710, 712, 722]
2025-02-06 12:07:06,044 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000710:
Objects:
  - bag
  - bed
Relationships:
  - person looking_at bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed

Frame 000712:
Objects:
  - bag
  - bed
Relationships:
  - person not_looking_at bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed

Frame 000722:
Objects:
  - bag
  - bed
Relationships:
  - person looking_at bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person other_relationship bed

========================

2025-02-06 12:07:06,045 - DEBUG - 
=======PROMPT========

2025-02-06 12:07:06,045 - DEBUG - Given the sequence of scene graphs below, predict the next 5 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (27 frames, 79 to 722):
            
Frame 000079:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000082:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000083:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000234:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000244:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000246:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000390:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000406:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000409:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000545:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000568:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000570:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000572:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000599:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000628:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000654:
Objects:
  - phone/camera
  - bag
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person unsure bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000655:
Objects:
  - phone/camera
  - bag
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person unsure bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000657:
Objects:
  - phone/camera
  - bag
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bag
  - person in_front_of bag
  - person on_the_side_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000673:
Objects:
  - phone/camera
  - bag
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000678:
Objects:
  - phone/camera
  - bag
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bag
  - person in_front_of bag
  - person not_contacting bag
  - person unsure bed
  - person beneath bed
  - person lying_on bed


Frame 000686:
Objects:
  - phone/camera
  - bag
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person unsure bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000689:
Objects:
  - phone/camera
  - bag
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person unsure bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000691:
Objects:
  - phone/camera
  - bag
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000700:
Objects:
  - phone/camera
  - bag
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person unsure bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000710:
Objects:
  - bag
  - bed
Relationships:
  - person looking_at bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000712:
Objects:
  - bag
  - bed
Relationships:
  - person not_looking_at bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000722:
Objects:
  - bag
  - bed
Relationships:
  - person looking_at bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person other_relationship bed

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 5 frames ([728, 730, 732, 735, 745]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:07:06,045 - DEBUG - 
===================

2025-02-06 12:07:06,353 - ERROR - Prediction failed: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:06,355 - DEBUG - Traceback: Traceback (most recent call last):
  File "/Users/sriujjwalreddyb/SceneGraphVLM/llamaAPI.py", line 423, in predict_scene_graphs
    response = model.run(api_request_json)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 67, in run
    return self.run_sync(api_request_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 53, in run_sync
    raise Exception(f"POST {response.status_code} {response.json()['detail']}")
Exception: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.

2025-02-06 12:07:06,356 - ERROR - Failed to process video 3G4PN.mp4: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:06,358 - INFO - 
==================================================
Processing video: RXED2.mp4
==================================================
2025-02-06 12:07:06,358 - INFO - Processing video: RXED2.mp4
2025-02-06 12:07:06,360 - INFO - Found 10 frames for video RXED2.mp4
2025-02-06 12:07:06,360 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:07:06,360 - DEBUG - Found scene graph for frame RXED2.mp4/000094.png
2025-02-06 12:07:06,361 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:07:06,361 - DEBUG - Found scene graph for frame RXED2.mp4/000281.png
2025-02-06 12:07:06,361 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:07:06,361 - DEBUG - Found scene graph for frame RXED2.mp4/000347.png
2025-02-06 12:07:06,361 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:07:06,362 - DEBUG - Found scene graph for frame RXED2.mp4/000380.png
2025-02-06 12:07:06,362 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:07:06,362 - DEBUG - Found scene graph for frame RXED2.mp4/000414.png
2025-02-06 12:07:06,362 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:07:06,362 - DEBUG - Found scene graph for frame RXED2.mp4/000447.png
2025-02-06 12:07:06,363 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:07:06,363 - DEBUG - Found scene graph for frame RXED2.mp4/000468.png
2025-02-06 12:07:06,363 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:07:06,363 - DEBUG - Found scene graph for frame RXED2.mp4/000480.png
2025-02-06 12:07:06,363 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,364 - DEBUG - Found scene graph for frame RXED2.mp4/000655.png
2025-02-06 12:07:06,364 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:07:06,364 - DEBUG - Found scene graph for frame RXED2.mp4/000842.png
2025-02-06 12:07:06,364 - INFO - Extracted 10 scene graphs
2025-02-06 12:07:06,365 - INFO - Split 10 graphs chronologically into 8 train and 2 test
2025-02-06 12:07:06,365 - DEBUG - Training frames: RXED2.mp4/000094.png to RXED2.mp4/000480.png
2025-02-06 12:07:06,365 - DEBUG - Testing frames: RXED2.mp4/000655.png to RXED2.mp4/000842.png
2025-02-06 12:07:06,365 - INFO - 
=== Starting Llama Scene Graph Prediction (Closed Vocabulary) ===
2025-02-06 12:07:06,365 - INFO - Will generate 2 sequential predictions
2025-02-06 12:07:06,365 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:07:06,366 - DEBUG - Starting with 8 training frames
2025-02-06 12:07:06,366 - DEBUG - Frame numbers: [94, 281, 347, 380, 414, 447, 468, 480]
2025-02-06 12:07:06,366 - DEBUG - ============================

2025-02-06 12:07:06,366 - INFO - Found 2 test frames to predict after frame 480
2025-02-06 12:07:06,366 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:07:06,367 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:07:06,367 - DEBUG - Predicting 2 frames: [655, 842]
2025-02-06 12:07:06,367 - DEBUG - Context has 8 frames
2025-02-06 12:07:06,367 - DEBUG - Last 3 context frames: [447, 468, 480]
2025-02-06 12:07:06,372 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000447:
Objects:
  - sofa/couch
  - book
  - paper/notebook
Relationships:
  - person not_looking_at sofa/couch
  - person behind sofa/couch
  - person beneath sofa/couch
  - person sitting_on sofa/couch
  - person leaning_on sofa/couch
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook

Frame 000468:
Objects:
  - sofa/couch
  - book
  - paper/notebook
Relationships:
  - person not_looking_at sofa/couch
  - person beneath sofa/couch
  - person behind sofa/couch
  - person leaning_on sofa/couch
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook

Frame 000480:
Objects:
  - sofa/couch
  - book
  - paper/notebook
Relationships:
  - person not_looking_at sofa/couch
  - person beneath sofa/couch
  - person behind sofa/couch
  - person sitting_on sofa/couch
  - person leaning_on sofa/couch
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person writing_on paper/notebook

========================

2025-02-06 12:07:06,372 - DEBUG - 
=======PROMPT========

2025-02-06 12:07:06,372 - DEBUG - Given the sequence of scene graphs below, predict the next 2 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (8 frames, 94 to 480):
            
Frame 000094:
Objects:
  - sofa/couch
  - book
  - paper/notebook
Relationships:
  - person not_looking_at sofa/couch
  - person beneath sofa/couch
  - person behind sofa/couch
  - person sitting_on sofa/couch
  - person leaning_on sofa/couch
  - person looking_at book
  - person in_front_of book
  - person touching book
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person writing_on paper/notebook


Frame 000281:
Objects:
  - sofa/couch
  - book
  - paper/notebook
Relationships:
  - person not_looking_at sofa/couch
  - person behind sofa/couch
  - person beneath sofa/couch
  - person sitting_on sofa/couch
  - person leaning_on sofa/couch
  - person looking_at book
  - person in_front_of book
  - person touching book
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000347:
Objects:
  - sofa/couch
  - book
  - paper/notebook
Relationships:
  - person not_looking_at sofa/couch
  - person beneath sofa/couch
  - person behind sofa/couch
  - person sitting_on sofa/couch
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000380:
Objects:
  - sofa/couch
  - book
  - paper/notebook
Relationships:
  - person not_looking_at sofa/couch
  - person beneath sofa/couch
  - person behind sofa/couch
  - person sitting_on sofa/couch
  - person leaning_on sofa/couch
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000414:
Objects:
  - sofa/couch
  - book
  - paper/notebook
Relationships:
  - person not_looking_at sofa/couch
  - person beneath sofa/couch
  - person behind sofa/couch
  - person sitting_on sofa/couch
  - person leaning_on sofa/couch
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000447:
Objects:
  - sofa/couch
  - book
  - paper/notebook
Relationships:
  - person not_looking_at sofa/couch
  - person behind sofa/couch
  - person beneath sofa/couch
  - person sitting_on sofa/couch
  - person leaning_on sofa/couch
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000468:
Objects:
  - sofa/couch
  - book
  - paper/notebook
Relationships:
  - person not_looking_at sofa/couch
  - person beneath sofa/couch
  - person behind sofa/couch
  - person leaning_on sofa/couch
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000480:
Objects:
  - sofa/couch
  - book
  - paper/notebook
Relationships:
  - person not_looking_at sofa/couch
  - person beneath sofa/couch
  - person behind sofa/couch
  - person sitting_on sofa/couch
  - person leaning_on sofa/couch
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person writing_on paper/notebook

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 2 frames ([655, 842]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:07:06,373 - DEBUG - 
===================

2025-02-06 12:07:06,718 - ERROR - Prediction failed: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:06,720 - DEBUG - Traceback: Traceback (most recent call last):
  File "/Users/sriujjwalreddyb/SceneGraphVLM/llamaAPI.py", line 423, in predict_scene_graphs
    response = model.run(api_request_json)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 67, in run
    return self.run_sync(api_request_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 53, in run_sync
    raise Exception(f"POST {response.status_code} {response.json()['detail']}")
Exception: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.

2025-02-06 12:07:06,720 - ERROR - Failed to process video RXED2.mp4: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:06,721 - INFO - 
==================================================
Processing video: A42EF.mp4
==================================================
2025-02-06 12:07:06,721 - INFO - Processing video: A42EF.mp4
2025-02-06 12:07:06,722 - INFO - Found 45 frames for video A42EF.mp4
2025-02-06 12:07:06,723 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000052.png
2025-02-06 12:07:06,723 - WARNING - No scene graph found for frame A42EF.mp4/000052.png
2025-02-06 12:07:06,723 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000063.png
2025-02-06 12:07:06,724 - WARNING - No scene graph found for frame A42EF.mp4/000063.png
2025-02-06 12:07:06,724 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000083.png
2025-02-06 12:07:06,724 - WARNING - No scene graph found for frame A42EF.mp4/000083.png
2025-02-06 12:07:06,724 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000090.png
2025-02-06 12:07:06,724 - WARNING - No scene graph found for frame A42EF.mp4/000090.png
2025-02-06 12:07:06,725 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000093.png
2025-02-06 12:07:06,725 - WARNING - No scene graph found for frame A42EF.mp4/000093.png
2025-02-06 12:07:06,725 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,725 - DEBUG - Found scene graph for frame A42EF.mp4/000113.png
2025-02-06 12:07:06,725 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:06,726 - DEBUG - Found scene graph for frame A42EF.mp4/000118.png
2025-02-06 12:07:06,726 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,726 - DEBUG - Found scene graph for frame A42EF.mp4/000140.png
2025-02-06 12:07:06,727 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,727 - DEBUG - Found scene graph for frame A42EF.mp4/000143.png
2025-02-06 12:07:06,727 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,727 - DEBUG - Found scene graph for frame A42EF.mp4/000145.png
2025-02-06 12:07:06,727 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:07:06,727 - DEBUG - Found scene graph for frame A42EF.mp4/000172.png
2025-02-06 12:07:06,728 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:07:06,728 - DEBUG - Found scene graph for frame A42EF.mp4/000174.png
2025-02-06 12:07:06,728 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:06,728 - DEBUG - Found scene graph for frame A42EF.mp4/000187.png
2025-02-06 12:07:06,729 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000218.png
2025-02-06 12:07:06,729 - WARNING - No scene graph found for frame A42EF.mp4/000218.png
2025-02-06 12:07:06,729 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000233.png
2025-02-06 12:07:06,729 - WARNING - No scene graph found for frame A42EF.mp4/000233.png
2025-02-06 12:07:06,729 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000235.png
2025-02-06 12:07:06,730 - WARNING - No scene graph found for frame A42EF.mp4/000235.png
2025-02-06 12:07:06,730 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000255.png
2025-02-06 12:07:06,730 - WARNING - No scene graph found for frame A42EF.mp4/000255.png
2025-02-06 12:07:06,730 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:06,730 - DEBUG - Found scene graph for frame A42EF.mp4/000273.png
2025-02-06 12:07:06,730 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000276.png
2025-02-06 12:07:06,731 - WARNING - No scene graph found for frame A42EF.mp4/000276.png
2025-02-06 12:07:06,731 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000280.png
2025-02-06 12:07:06,731 - WARNING - No scene graph found for frame A42EF.mp4/000280.png
2025-02-06 12:07:06,731 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:06,731 - DEBUG - Found scene graph for frame A42EF.mp4/000293.png
2025-02-06 12:07:06,732 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:06,732 - DEBUG - Found scene graph for frame A42EF.mp4/000317.png
2025-02-06 12:07:06,732 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000331.png
2025-02-06 12:07:06,732 - WARNING - No scene graph found for frame A42EF.mp4/000331.png
2025-02-06 12:07:06,732 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000336.png
2025-02-06 12:07:06,733 - WARNING - No scene graph found for frame A42EF.mp4/000336.png
2025-02-06 12:07:06,733 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000358.png
2025-02-06 12:07:06,733 - WARNING - No scene graph found for frame A42EF.mp4/000358.png
2025-02-06 12:07:06,733 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000368.png
2025-02-06 12:07:06,733 - WARNING - No scene graph found for frame A42EF.mp4/000368.png
2025-02-06 12:07:06,734 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000399.png
2025-02-06 12:07:06,734 - WARNING - No scene graph found for frame A42EF.mp4/000399.png
2025-02-06 12:07:06,734 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000400.png
2025-02-06 12:07:06,735 - WARNING - No scene graph found for frame A42EF.mp4/000400.png
2025-02-06 12:07:06,735 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000402.png
2025-02-06 12:07:06,735 - WARNING - No scene graph found for frame A42EF.mp4/000402.png
2025-02-06 12:07:06,735 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000463.png
2025-02-06 12:07:06,736 - WARNING - No scene graph found for frame A42EF.mp4/000463.png
2025-02-06 12:07:06,736 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:06,736 - DEBUG - Found scene graph for frame A42EF.mp4/000477.png
2025-02-06 12:07:06,736 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000526.png
2025-02-06 12:07:06,736 - WARNING - No scene graph found for frame A42EF.mp4/000526.png
2025-02-06 12:07:06,737 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000546.png
2025-02-06 12:07:06,737 - WARNING - No scene graph found for frame A42EF.mp4/000546.png
2025-02-06 12:07:06,737 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000553.png
2025-02-06 12:07:06,737 - WARNING - No scene graph found for frame A42EF.mp4/000553.png
2025-02-06 12:07:06,737 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000592.png
2025-02-06 12:07:06,738 - WARNING - No scene graph found for frame A42EF.mp4/000592.png
2025-02-06 12:07:06,738 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000604.png
2025-02-06 12:07:06,738 - WARNING - No scene graph found for frame A42EF.mp4/000604.png
2025-02-06 12:07:06,739 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000628.png
2025-02-06 12:07:06,739 - WARNING - No scene graph found for frame A42EF.mp4/000628.png
2025-02-06 12:07:06,739 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000640.png
2025-02-06 12:07:06,739 - WARNING - No scene graph found for frame A42EF.mp4/000640.png
2025-02-06 12:07:06,739 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000662.png
2025-02-06 12:07:06,740 - WARNING - No scene graph found for frame A42EF.mp4/000662.png
2025-02-06 12:07:06,740 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000688.png
2025-02-06 12:07:06,740 - WARNING - No scene graph found for frame A42EF.mp4/000688.png
2025-02-06 12:07:06,740 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:07:06,740 - DEBUG - Found scene graph for frame A42EF.mp4/000703.png
2025-02-06 12:07:06,741 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:06,741 - DEBUG - Found scene graph for frame A42EF.mp4/000720.png
2025-02-06 12:07:06,741 - DEBUG - Extracted scene graph with 1 objects and 5 relationships
2025-02-06 12:07:06,741 - DEBUG - Found scene graph for frame A42EF.mp4/000735.png
2025-02-06 12:07:06,741 - DEBUG - Extracted scene graph with 1 objects and 5 relationships
2025-02-06 12:07:06,742 - DEBUG - Found scene graph for frame A42EF.mp4/000778.png
2025-02-06 12:07:06,742 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:07:06,742 - DEBUG - Found scene graph for frame A42EF.mp4/000783.png
2025-02-06 12:07:06,742 - INFO - Extracted 17 scene graphs
2025-02-06 12:07:06,743 - INFO - Split 17 graphs chronologically into 13 train and 4 test
2025-02-06 12:07:06,743 - DEBUG - Training frames: A42EF.mp4/000113.png to A42EF.mp4/000703.png
2025-02-06 12:07:06,743 - DEBUG - Testing frames: A42EF.mp4/000720.png to A42EF.mp4/000783.png
2025-02-06 12:07:06,743 - INFO - 
=== Starting Llama Scene Graph Prediction (Closed Vocabulary) ===
2025-02-06 12:07:06,743 - INFO - Will generate 4 sequential predictions
2025-02-06 12:07:06,744 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:07:06,744 - DEBUG - Starting with 13 training frames
2025-02-06 12:07:06,744 - DEBUG - Frame numbers: [113, 118, 140, 143, 145, 172, 174, 187, 273, 293, 317, 477, 703]
2025-02-06 12:07:06,744 - DEBUG - ============================

2025-02-06 12:07:06,745 - INFO - Found 4 test frames to predict after frame 703
2025-02-06 12:07:06,745 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:07:06,745 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:07:06,745 - DEBUG - Predicting 4 frames: [720, 735, 778, 783]
2025-02-06 12:07:06,745 - DEBUG - Context has 13 frames
2025-02-06 12:07:06,745 - DEBUG - Last 3 context frames: [317, 477, 703]
2025-02-06 12:07:06,753 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000317:
Objects:
  - cup/glass/bottle
Relationships:
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle

Frame 000477:
Objects:
  - cup/glass/bottle
Relationships:
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle

Frame 000703:
Objects:
  - cup/glass/bottle
Relationships:
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle
  - person touching cup/glass/bottle

========================

2025-02-06 12:07:06,754 - DEBUG - 
=======PROMPT========

2025-02-06 12:07:06,754 - DEBUG - Given the sequence of scene graphs below, predict the next 4 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (13 frames, 113 to 703):
            
Frame 000113:
Objects:
  - door
  - doorway
Relationships:
  - person not_looking_at door
  - person on_the_side_of door
  - person not_contacting door
  - person not_looking_at doorway
  - person in doorway
  - person not_contacting doorway


Frame 000118:
Objects:
  - door
  - doorway
Relationships:
  - person not_looking_at door
  - person on_the_side_of door
  - person in_front_of door
  - person not_contacting door
  - person not_looking_at doorway
  - person in doorway
  - person not_contacting doorway


Frame 000140:
Objects:
  - door
  - doorway
Relationships:
  - person unsure door
  - person on_the_side_of door
  - person not_contacting door
  - person not_looking_at doorway
  - person in doorway
  - person touching doorway


Frame 000143:
Objects:
  - door
  - doorway
Relationships:
  - person unsure door
  - person on_the_side_of door
  - person not_contacting door
  - person not_looking_at doorway
  - person in doorway
  - person touching doorway


Frame 000145:
Objects:
  - door
  - doorway
Relationships:
  - person unsure door
  - person on_the_side_of door
  - person not_contacting door
  - person not_looking_at doorway
  - person in doorway
  - person touching doorway


Frame 000172:
Objects:
  - door
  - doorway
Relationships:
  - person looking_at door
  - person in_front_of door
  - person not_contacting door
  - person not_looking_at doorway
  - person on_the_side_of doorway
  - person behind doorway
  - person touching doorway


Frame 000174:
Objects:
  - door
  - doorway
Relationships:
  - person not_looking_at door
  - person on_the_side_of door
  - person touching door
  - person not_looking_at doorway
  - person in doorway
  - person touching doorway


Frame 000187:
Objects:
  - door
Relationships:
  - person not_looking_at door
  - person on_the_side_of door
  - person touching door


Frame 000273:
Objects:
  - doorknob
Relationships:
  - person looking_at doorknob
  - person in_front_of doorknob
  - person touching doorknob


Frame 000293:
Objects:
  - doorknob
Relationships:
  - person unsure doorknob
  - person in_front_of doorknob
  - person touching doorknob


Frame 000317:
Objects:
  - cup/glass/bottle
Relationships:
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle


Frame 000477:
Objects:
  - cup/glass/bottle
Relationships:
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle


Frame 000703:
Objects:
  - cup/glass/bottle
Relationships:
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle
  - person touching cup/glass/bottle

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 4 frames ([720, 735, 778, 783]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:07:06,755 - DEBUG - 
===================

2025-02-06 12:07:07,083 - ERROR - Prediction failed: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:07,086 - DEBUG - Traceback: Traceback (most recent call last):
  File "/Users/sriujjwalreddyb/SceneGraphVLM/llamaAPI.py", line 423, in predict_scene_graphs
    response = model.run(api_request_json)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 67, in run
    return self.run_sync(api_request_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sriujjwalreddyb/SceneGraphVLM/venv/lib/python3.11/site-packages/llamaapi/llamaapi.py", line 53, in run_sync
    raise Exception(f"POST {response.status_code} {response.json()['detail']}")
Exception: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.

2025-02-06 12:07:07,087 - ERROR - Failed to process video A42EF.mp4: POST 401 Invalid API token. Confirm or refresh your API Token on https://console.llamaapi.com/. Update to the newest Python Client Library (e.g. pip install llamaapi>=0.1.36), as authorization header will change to: 'Authorization: Bearer your_token'. The old format will be deprecated on 09/1/2021.
2025-02-06 12:07:07,089 - INFO - Pipeline completed successfully
2025-02-06 12:26:32,553 - INFO - Processing video: TXQWJ.mp4
2025-02-06 12:26:32,558 - INFO - Found 20 frames for video TXQWJ.mp4
2025-02-06 12:26:32,569 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:26:32,569 - DEBUG - Found scene graph for frame TXQWJ.mp4/000052.png
2025-02-06 12:26:32,571 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:26:32,571 - DEBUG - Found scene graph for frame TXQWJ.mp4/000153.png
2025-02-06 12:26:32,572 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:26:32,573 - DEBUG - Found scene graph for frame TXQWJ.mp4/000255.png
2025-02-06 12:26:32,574 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:26:32,574 - DEBUG - Found scene graph for frame TXQWJ.mp4/000353.png
2025-02-06 12:26:32,574 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:26:32,575 - DEBUG - Found scene graph for frame TXQWJ.mp4/000357.png
2025-02-06 12:26:32,576 - DEBUG - No valid objects found in annotations for frame TXQWJ.mp4/000421.png
2025-02-06 12:26:32,576 - WARNING - No scene graph found for frame TXQWJ.mp4/000421.png
2025-02-06 12:26:32,578 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:26:32,578 - DEBUG - Found scene graph for frame TXQWJ.mp4/000458.png
2025-02-06 12:26:32,579 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:26:32,580 - DEBUG - Found scene graph for frame TXQWJ.mp4/000486.png
2025-02-06 12:26:32,580 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:26:32,580 - DEBUG - Found scene graph for frame TXQWJ.mp4/000489.png
2025-02-06 12:26:32,581 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:26:32,581 - DEBUG - Found scene graph for frame TXQWJ.mp4/000533.png
2025-02-06 12:26:32,583 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:26:32,583 - DEBUG - Found scene graph for frame TXQWJ.mp4/000545.png
2025-02-06 12:26:32,584 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:26:32,584 - DEBUG - Found scene graph for frame TXQWJ.mp4/000557.png
2025-02-06 12:26:32,584 - DEBUG - Extracted scene graph with 4 objects and 12 relationships
2025-02-06 12:26:32,584 - DEBUG - Found scene graph for frame TXQWJ.mp4/000603.png
2025-02-06 12:26:32,585 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:26:32,585 - DEBUG - Found scene graph for frame TXQWJ.mp4/000625.png
2025-02-06 12:26:32,585 - DEBUG - Extracted scene graph with 4 objects and 12 relationships
2025-02-06 12:26:32,585 - DEBUG - Found scene graph for frame TXQWJ.mp4/000649.png
2025-02-06 12:26:32,585 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:26:32,585 - DEBUG - Found scene graph for frame TXQWJ.mp4/000661.png
2025-02-06 12:26:32,585 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:26:32,585 - DEBUG - Found scene graph for frame TXQWJ.mp4/000720.png
2025-02-06 12:26:32,586 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:26:32,586 - DEBUG - Found scene graph for frame TXQWJ.mp4/000765.png
2025-02-06 12:26:32,586 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:26:32,586 - DEBUG - Found scene graph for frame TXQWJ.mp4/000881.png
2025-02-06 12:26:32,587 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:26:32,587 - DEBUG - Found scene graph for frame TXQWJ.mp4/000997.png
2025-02-06 12:26:32,587 - INFO - Extracted 19 scene graphs
2025-02-06 12:26:32,587 - INFO - Split 19 graphs chronologically into 15 train and 4 test
2025-02-06 12:26:32,587 - DEBUG - Training frames: TXQWJ.mp4/000052.png to TXQWJ.mp4/000661.png
2025-02-06 12:26:32,588 - DEBUG - Testing frames: TXQWJ.mp4/000720.png to TXQWJ.mp4/000997.png
2025-02-06 12:26:32,591 - INFO - Generating 4 sequential predictions using closed vocabulary
2025-02-06 12:26:32,592 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:26:32,592 - DEBUG - Starting with 15 training frames
2025-02-06 12:26:32,593 - DEBUG - Frame numbers: [52, 153, 255, 353, 357, 458, 486, 489, 533, 545, 557, 603, 625, 649, 661]
2025-02-06 12:26:32,593 - DEBUG - ============================

2025-02-06 12:26:32,594 - INFO - Found 4 test frames to predict after frame 661
2025-02-06 12:26:32,594 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:26:32,595 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:26:32,595 - DEBUG - Predicting 4 frames: [720, 765, 881, 997]
2025-02-06 12:26:32,596 - DEBUG - Context has 15 frames
2025-02-06 12:26:32,597 - DEBUG - Last 3 context frames: [625, 649, 661]
2025-02-06 12:26:32,627 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000625:
Objects:
  - food
  - groceries
  - bag
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at groceries
  - person in_front_of groceries
  - person holding groceries
  - person looking_at bag
  - person in_front_of bag
  - person touching bag

Frame 000649:
Objects:
  - food
  - groceries
  - bag
  - cup/glass/bottle
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at groceries
  - person in_front_of groceries
  - person touching groceries
  - person looking_at bag
  - person in_front_of bag
  - person touching bag
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person not_contacting cup/glass/bottle

Frame 000661:
Objects:
  - food
  - groceries
  - bag
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at groceries
  - person in_front_of groceries
  - person touching groceries
  - person looking_at bag
  - person in_front_of bag
  - person touching bag

========================

2025-02-06 12:26:32,628 - DEBUG - 
=======PROMPT========

2025-02-06 12:26:32,628 - DEBUG - Given the sequence of scene graphs below, predict the next 4 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (15 frames, 52 to 661):
            
Frame 000052:
Objects:
  - cup/glass/bottle
Relationships:
  - person looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle


Frame 000153:
Objects:
  - cup/glass/bottle
Relationships:
  - person looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person drinking_from cup/glass/bottle


Frame 000255:
Objects:
  - cup/glass/bottle
Relationships:
  - person looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle
  - person drinking_from cup/glass/bottle


Frame 000353:
Objects:
  - cup/glass/bottle
Relationships:
  - person not_looking_at cup/glass/bottle
  - person beneath cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle


Frame 000357:
Objects:
  - cup/glass/bottle
Relationships:
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle


Frame 000458:
Objects:
  - bag
Relationships:
  - person unsure bag
  - person on_the_side_of bag
  - person in_front_of bag
  - person not_contacting bag


Frame 000486:
Objects:
  - food
  - bag
  - cup/glass/bottle
Relationships:
  - person looking_at food
  - person in_front_of food
  - person not_contacting food
  - person looking_at bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle


Frame 000489:
Objects:
  - food
  - groceries
  - bag
Relationships:
  - person not_looking_at food
  - person in_front_of food
  - person not_contacting food
  - person looking_at groceries
  - person in_front_of groceries
  - person not_contacting groceries
  - person looking_at bag
  - person in_front_of bag
  - person on_the_side_of bag
  - person not_contacting bag


Frame 000533:
Objects:
  - food
  - groceries
  - bag
Relationships:
  - person not_looking_at food
  - person in_front_of food
  - person not_contacting food
  - person unsure groceries
  - person in_front_of groceries
  - person not_contacting groceries
  - person unsure bag
  - person in_front_of bag
  - person not_contacting bag


Frame 000545:
Objects:
  - food
  - groceries
  - bag
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at groceries
  - person in_front_of groceries
  - person touching groceries
  - person looking_at bag
  - person in_front_of bag
  - person not_contacting bag


Frame 000557:
Objects:
  - food
  - groceries
  - bag
Relationships:
  - person looking_at food
  - person in_front_of food
  - person touching food
  - person looking_at groceries
  - person in_front_of groceries
  - person touching groceries
  - person looking_at bag
  - person in_front_of bag
  - person touching bag


Frame 000603:
Objects:
  - food
  - groceries
  - bag
  - cup/glass/bottle
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person looking_at groceries
  - person in_front_of groceries
  - person touching groceries
  - person looking_at bag
  - person in_front_of bag
  - person touching bag
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person not_contacting cup/glass/bottle


Frame 000625:
Objects:
  - food
  - groceries
  - bag
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at groceries
  - person in_front_of groceries
  - person holding groceries
  - person looking_at bag
  - person in_front_of bag
  - person touching bag


Frame 000649:
Objects:
  - food
  - groceries
  - bag
  - cup/glass/bottle
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at groceries
  - person in_front_of groceries
  - person touching groceries
  - person looking_at bag
  - person in_front_of bag
  - person touching bag
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person not_contacting cup/glass/bottle


Frame 000661:
Objects:
  - food
  - groceries
  - bag
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at groceries
  - person in_front_of groceries
  - person touching groceries
  - person looking_at bag
  - person in_front_of bag
  - person touching bag

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 4 frames ([720, 765, 881, 997]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:26:32,628 - DEBUG - 
===================

2025-02-06 12:26:40,181 - DEBUG - 
=======BATCH PREDICTIONS========
2025-02-06 12:26:40,185 - DEBUG - 
Prediction for frame 720:
2025-02-06 12:26:40,185 - DEBUG - Objects:
2025-02-06 12:26:40,185 - DEBUG -   - food
2025-02-06 12:26:40,185 - DEBUG -   - groceries
2025-02-06 12:26:40,185 - DEBUG -   - bag
2025-02-06 12:26:40,185 - DEBUG - Relationships:
2025-02-06 12:26:40,185 - DEBUG -   - person looking_at food
2025-02-06 12:26:40,185 - DEBUG -   - person in_front_of food
2025-02-06 12:26:40,185 - DEBUG -   - person holding food
2025-02-06 12:26:40,185 - DEBUG -   - person looking_at groceries
2025-02-06 12:26:40,186 - DEBUG -   - person in_front_of groceries
2025-02-06 12:26:40,186 - DEBUG -   - person holding groceries
2025-02-06 12:26:40,186 - DEBUG -   - person looking_at bag
2025-02-06 12:26:40,186 - DEBUG -   - person in_front_of bag
2025-02-06 12:26:40,186 - DEBUG -   - person carrying bag
2025-02-06 12:26:40,186 - DEBUG - 
Prediction for frame 765:
2025-02-06 12:26:40,186 - DEBUG - Objects:
2025-02-06 12:26:40,186 - DEBUG -   - food
2025-02-06 12:26:40,186 - DEBUG -   - groceries
2025-02-06 12:26:40,186 - DEBUG -   - bag
2025-02-06 12:26:40,186 - DEBUG -   - table
2025-02-06 12:26:40,187 - DEBUG - Relationships:
2025-02-06 12:26:40,187 - DEBUG -   - person looking_at food
2025-02-06 12:26:40,187 - DEBUG -   - person in_front_of food
2025-02-06 12:26:40,187 - DEBUG -   - person placing table
2025-02-06 12:26:40,187 - DEBUG -   - person looking_at groceries
2025-02-06 12:26:40,187 - DEBUG -   - person in_front_of groceries
2025-02-06 12:26:40,187 - DEBUG -   - person placing table
2025-02-06 12:26:40,187 - DEBUG -   - person looking_at bag
2025-02-06 12:26:40,187 - DEBUG -   - person in_front_of bag
2025-02-06 12:26:40,187 - DEBUG -   - person placing table
2025-02-06 12:26:40,188 - DEBUG - 
Prediction for frame 881:
2025-02-06 12:26:40,188 - DEBUG - Objects:
2025-02-06 12:26:40,188 - DEBUG -   - food
2025-02-06 12:26:40,188 - DEBUG -   - groceries
2025-02-06 12:26:40,188 - DEBUG -   - bag
2025-02-06 12:26:40,188 - DEBUG -   - table
2025-02-06 12:26:40,188 - DEBUG - Relationships:
2025-02-06 12:26:40,188 - DEBUG -   - food on table
2025-02-06 12:26:40,188 - DEBUG -   - groceries on table
2025-02-06 12:26:40,189 - DEBUG -   - bag on table
2025-02-06 12:26:40,189 - DEBUG -   - person looking_at table
2025-02-06 12:26:40,189 - DEBUG -   - person in_front_of table
2025-02-06 12:26:40,189 - DEBUG - 
Prediction for frame 997:
2025-02-06 12:26:40,189 - DEBUG - Objects:
2025-02-06 12:26:40,189 - DEBUG -   - table
2025-02-06 12:26:40,189 - DEBUG -   - person
2025-02-06 12:26:40,190 - DEBUG - Relationships:
2025-02-06 12:26:40,190 - DEBUG -   - person not_looking_at table
2025-02-06 12:26:40,190 - DEBUG -   - person in_front_of table
2025-02-06 12:26:40,190 - DEBUG - Added 4 predictions to context
2025-02-06 12:26:40,190 - DEBUG - Context size now: 19 frames
2025-02-06 12:26:40,190 - DEBUG - ============================

2025-02-06 12:26:40,192 - INFO - Visualizing results...
2025-02-06 12:26:40,192 - DEBUG - Visualizing comparison for frame TXQWJ.mp4/000720.png
2025-02-06 12:26:40,392 - DEBUG - Visualizing comparison for frame TXQWJ.mp4/000765.png
2025-02-06 12:26:40,480 - DEBUG - Visualizing comparison for frame TXQWJ.mp4/000881.png
2025-02-06 12:26:40,576 - DEBUG - Visualizing comparison for frame TXQWJ.mp4/000997.png
2025-02-06 12:26:40,663 - INFO - Completed processing video: TXQWJ.mp4
2025-02-06 12:26:40,663 - INFO - Waiting 60 seconds before next video...
2025-02-06 12:27:40,664 - INFO - 
==================================================
Processing video: H51V5.mp4
==================================================
2025-02-06 12:27:40,672 - INFO - Processing video: H51V5.mp4
2025-02-06 12:27:40,674 - INFO - Found 33 frames for video H51V5.mp4
2025-02-06 12:27:40,675 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:27:40,676 - DEBUG - Found scene graph for frame H51V5.mp4/000052.png
2025-02-06 12:27:40,676 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:27:40,676 - DEBUG - Found scene graph for frame H51V5.mp4/000054.png
2025-02-06 12:27:40,676 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:27:40,677 - DEBUG - Found scene graph for frame H51V5.mp4/000087.png
2025-02-06 12:27:40,677 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:27:40,677 - DEBUG - Found scene graph for frame H51V5.mp4/000121.png
2025-02-06 12:27:40,677 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:27:40,677 - DEBUG - Found scene graph for frame H51V5.mp4/000154.png
2025-02-06 12:27:40,677 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:27:40,678 - DEBUG - Found scene graph for frame H51V5.mp4/000155.png
2025-02-06 12:27:40,678 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:27:40,679 - DEBUG - Found scene graph for frame H51V5.mp4/000175.png
2025-02-06 12:27:40,681 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:27:40,681 - DEBUG - Found scene graph for frame H51V5.mp4/000187.png
2025-02-06 12:27:40,684 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:27:40,684 - DEBUG - Found scene graph for frame H51V5.mp4/000216.png
2025-02-06 12:27:40,684 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:27:40,684 - DEBUG - Found scene graph for frame H51V5.mp4/000257.png
2025-02-06 12:27:40,687 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:27:40,687 - DEBUG - Found scene graph for frame H51V5.mp4/000258.png
2025-02-06 12:27:40,687 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:27:40,688 - DEBUG - Found scene graph for frame H51V5.mp4/000284.png
2025-02-06 12:27:40,688 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:27:40,688 - DEBUG - Found scene graph for frame H51V5.mp4/000286.png
2025-02-06 12:27:40,688 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:27:40,688 - DEBUG - Found scene graph for frame H51V5.mp4/000298.png
2025-02-06 12:27:40,689 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:27:40,689 - DEBUG - Found scene graph for frame H51V5.mp4/000317.png
2025-02-06 12:27:40,689 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:27:40,689 - DEBUG - Found scene graph for frame H51V5.mp4/000339.png
2025-02-06 12:27:40,689 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:27:40,689 - DEBUG - Found scene graph for frame H51V5.mp4/000350.png
2025-02-06 12:27:40,689 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:27:40,689 - DEBUG - Found scene graph for frame H51V5.mp4/000361.png
2025-02-06 12:27:40,690 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:27:40,690 - DEBUG - Found scene graph for frame H51V5.mp4/000383.png
2025-02-06 12:27:40,691 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:27:40,691 - DEBUG - Found scene graph for frame H51V5.mp4/000392.png
2025-02-06 12:27:40,691 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:27:40,692 - DEBUG - Found scene graph for frame H51V5.mp4/000413.png
2025-02-06 12:27:40,692 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:27:40,692 - DEBUG - Found scene graph for frame H51V5.mp4/000415.png
2025-02-06 12:27:40,693 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:27:40,693 - DEBUG - Found scene graph for frame H51V5.mp4/000416.png
2025-02-06 12:27:40,693 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:27:40,693 - DEBUG - Found scene graph for frame H51V5.mp4/000444.png
2025-02-06 12:27:40,693 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:27:40,693 - DEBUG - Found scene graph for frame H51V5.mp4/000448.png
2025-02-06 12:27:40,693 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:27:40,693 - DEBUG - Found scene graph for frame H51V5.mp4/000464.png
2025-02-06 12:27:40,694 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:27:40,694 - DEBUG - Found scene graph for frame H51V5.mp4/000476.png
2025-02-06 12:27:40,694 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:27:40,694 - DEBUG - Found scene graph for frame H51V5.mp4/000481.png
2025-02-06 12:27:40,694 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:27:40,694 - DEBUG - Found scene graph for frame H51V5.mp4/000497.png
2025-02-06 12:27:40,695 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:27:40,695 - DEBUG - Found scene graph for frame H51V5.mp4/000507.png
2025-02-06 12:27:40,695 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:27:40,695 - DEBUG - Found scene graph for frame H51V5.mp4/000514.png
2025-02-06 12:27:40,696 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:27:40,696 - DEBUG - Found scene graph for frame H51V5.mp4/000538.png
2025-02-06 12:27:40,696 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:27:40,696 - DEBUG - Found scene graph for frame H51V5.mp4/000547.png
2025-02-06 12:27:40,696 - INFO - Extracted 33 scene graphs
2025-02-06 12:27:40,696 - INFO - Split 33 graphs chronologically into 26 train and 7 test
2025-02-06 12:27:40,697 - DEBUG - Training frames: H51V5.mp4/000052.png to H51V5.mp4/000464.png
2025-02-06 12:27:40,697 - DEBUG - Testing frames: H51V5.mp4/000476.png to H51V5.mp4/000547.png
2025-02-06 12:27:40,697 - INFO - Generating 7 sequential predictions using closed vocabulary
2025-02-06 12:27:40,697 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:27:40,697 - DEBUG - Starting with 26 training frames
2025-02-06 12:27:40,698 - DEBUG - Frame numbers: [52, 54, 87, 121, 154, 155, 175, 187, 216, 257, 258, 284, 286, 298, 317, 339, 350, 361, 383, 392, 413, 415, 416, 444, 448, 464]
2025-02-06 12:27:40,698 - DEBUG - ============================

2025-02-06 12:27:40,698 - INFO - Found 7 test frames to predict after frame 464
2025-02-06 12:27:40,698 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:27:40,698 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:27:40,698 - DEBUG - Predicting 5 frames: [476, 481, 497, 507, 514]
2025-02-06 12:27:40,698 - DEBUG - Context has 26 frames
2025-02-06 12:27:40,699 - DEBUG - Last 3 context frames: [444, 448, 464]
2025-02-06 12:27:40,737 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000444:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish

Frame 000448:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person beneath table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish

Frame 000464:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person beneath food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish

========================

2025-02-06 12:27:40,740 - DEBUG - 
=======PROMPT========

2025-02-06 12:27:40,741 - DEBUG - Given the sequence of scene graphs below, predict the next 5 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (26 frames, 52 to 464):
            
Frame 000052:
Objects:
  - food
  - dish
Relationships:
  - person not_looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000054:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000087:
Objects:
  - food
  - dish
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000121:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000154:
Objects:
  - food
  - dish
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000155:
Objects:
  - food
  - dish
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000175:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000187:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person not_contacting food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000216:
Objects:
  - dish
Relationships:
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000257:
Objects:
  - dish
Relationships:
  - person looking_at dish
  - person in_front_of dish
  - person touching dish


Frame 000258:
Objects:
  - dish
Relationships:
  - person looking_at dish
  - person in_front_of dish
  - person not_contacting dish


Frame 000284:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person touching dish


Frame 000286:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person touching dish


Frame 000298:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000317:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000339:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000350:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000361:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000383:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000392:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000413:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000415:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000416:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000444:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000448:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person beneath table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000464:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person beneath food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 5 frames ([476, 481, 497, 507, 514]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:27:40,742 - DEBUG - 
===================

2025-02-06 12:27:52,455 - DEBUG - 
=======BATCH PREDICTIONS========
2025-02-06 12:27:52,458 - DEBUG - 
Prediction for frame 476:
2025-02-06 12:27:52,458 - DEBUG - Objects:
2025-02-06 12:27:52,459 - DEBUG -   - table
2025-02-06 12:27:52,459 - DEBUG -   - food
2025-02-06 12:27:52,459 - DEBUG -   - dish
2025-02-06 12:27:52,459 - DEBUG -   - person
2025-02-06 12:27:52,459 - DEBUG - Relationships:
2025-02-06 12:27:52,459 - DEBUG -   - person not_looking_at table
2025-02-06 12:27:52,459 - DEBUG -   - person in_front_of table
2025-02-06 12:27:52,459 - DEBUG -   - person not_contacting table
2025-02-06 12:27:52,459 - DEBUG -   - person looking_at food
2025-02-06 12:27:52,459 - DEBUG -   - person in_front_of food
2025-02-06 12:27:52,459 - DEBUG -   - person holding food
2025-02-06 12:27:52,460 - DEBUG -   - person looking_at dish
2025-02-06 12:27:52,460 - DEBUG -   - person in_front_of dish
2025-02-06 12:27:52,460 - DEBUG -   - person holding dish
2025-02-06 12:27:52,460 - DEBUG - 
Prediction for frame 481:
2025-02-06 12:27:52,460 - DEBUG - Objects:
2025-02-06 12:27:52,460 - DEBUG -   - table
2025-02-06 12:27:52,474 - DEBUG -   - food
2025-02-06 12:27:52,474 - DEBUG -   - dish
2025-02-06 12:27:52,474 - DEBUG -   - person
2025-02-06 12:27:52,474 - DEBUG - Relationships:
2025-02-06 12:27:52,474 - DEBUG -   - person not_looking_at table
2025-02-06 12:27:52,474 - DEBUG -   - person in_front_of table
2025-02-06 12:27:52,474 - DEBUG -   - person not_contacting table
2025-02-06 12:27:52,474 - DEBUG -   - person looking_at food
2025-02-06 12:27:52,474 - DEBUG -   - person in_front_of food
2025-02-06 12:27:52,474 - DEBUG -   - person holding food
2025-02-06 12:27:52,475 - DEBUG -   - person looking_at dish
2025-02-06 12:27:52,475 - DEBUG -   - person in_front_of dish
2025-02-06 12:27:52,475 - DEBUG -   - person holding dish
2025-02-06 12:27:52,475 - DEBUG - 
Prediction for frame 497:
2025-02-06 12:27:52,475 - DEBUG - Objects:
2025-02-06 12:27:52,475 - DEBUG -   - table
2025-02-06 12:27:52,475 - DEBUG -   - food
2025-02-06 12:27:52,475 - DEBUG -   - dish
2025-02-06 12:27:52,475 - DEBUG -   - person
2025-02-06 12:27:52,475 - DEBUG - Relationships:
2025-02-06 12:27:52,475 - DEBUG -   - person not_looking_at table
2025-02-06 12:27:52,476 - DEBUG -   - person in_front_of table
2025-02-06 12:27:52,476 - DEBUG -   - person not_contacting table
2025-02-06 12:27:52,476 - DEBUG -   - person looking_at food
2025-02-06 12:27:52,476 - DEBUG -   - person in_front_of food
2025-02-06 12:27:52,476 - DEBUG -   - person holding food
2025-02-06 12:27:52,476 - DEBUG -   - person looking_at dish
2025-02-06 12:27:52,476 - DEBUG -   - person in_front_of dish
2025-02-06 12:27:52,476 - DEBUG -   - person holding dish
2025-02-06 12:27:52,476 - DEBUG - 
Prediction for frame 507:
2025-02-06 12:27:52,476 - DEBUG - Objects:
2025-02-06 12:27:52,476 - DEBUG -   - table
2025-02-06 12:27:52,476 - DEBUG -   - food
2025-02-06 12:27:52,477 - DEBUG -   - dish
2025-02-06 12:27:52,477 - DEBUG -   - person
2025-02-06 12:27:52,477 - DEBUG - Relationships:
2025-02-06 12:27:52,477 - DEBUG -   - person not_looking_at table
2025-02-06 12:27:52,477 - DEBUG -   - person in_front_of table
2025-02-06 12:27:52,477 - DEBUG -   - person not_contacting table
2025-02-06 12:27:52,477 - DEBUG -   - person looking_at food
2025-02-06 12:27:52,477 - DEBUG -   - person in_front_of food
2025-02-06 12:27:52,477 - DEBUG -   - person holding food
2025-02-06 12:27:52,477 - DEBUG -   - person looking_at dish
2025-02-06 12:27:52,477 - DEBUG -   - person in_front_of dish
2025-02-06 12:27:52,477 - DEBUG -   - person holding dish
2025-02-06 12:27:52,478 - DEBUG - 
Prediction for frame 514:
2025-02-06 12:27:52,478 - DEBUG - Objects:
2025-02-06 12:27:52,478 - DEBUG -   - table
2025-02-06 12:27:52,478 - DEBUG -   - food
2025-02-06 12:27:52,478 - DEBUG -   - dish
2025-02-06 12:27:52,478 - DEBUG -   - person
2025-02-06 12:27:52,478 - DEBUG - Relationships:
2025-02-06 12:27:52,478 - DEBUG -   - person not_looking_at table
2025-02-06 12:27:52,478 - DEBUG -   - person in_front_of table
2025-02-06 12:27:52,479 - DEBUG -   - person not_contacting table
2025-02-06 12:27:52,479 - DEBUG -   - person looking_at food
2025-02-06 12:27:52,479 - DEBUG -   - person in_front_of food
2025-02-06 12:27:52,479 - DEBUG -   - person holding food
2025-02-06 12:27:52,479 - DEBUG -   - person looking_at dish
2025-02-06 12:27:52,479 - DEBUG -   - person in_front_of dish
2025-02-06 12:27:52,479 - DEBUG -   - person holding dish
2025-02-06 12:27:52,480 - DEBUG - Added 5 predictions to context
2025-02-06 12:27:52,481 - DEBUG - Context size now: 31 frames
2025-02-06 12:27:52,481 - DEBUG - ============================

2025-02-06 12:27:52,481 - DEBUG - 
=======BATCH PREDICTION 2========
2025-02-06 12:27:52,482 - DEBUG - Predicting 2 frames: [538, 547]
2025-02-06 12:27:52,483 - DEBUG - Context has 31 frames
2025-02-06 12:27:52,483 - DEBUG - Last 3 context frames: [497, 507, 514]
2025-02-06 12:27:52,537 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000497:
Objects:
  - table
  - food
  - dish
  - person
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish

Frame 000507:
Objects:
  - table
  - food
  - dish
  - person
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish

Frame 000514:
Objects:
  - table
  - food
  - dish
  - person
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish

========================

2025-02-06 12:27:52,540 - DEBUG - 
=======PROMPT========

2025-02-06 12:27:52,541 - DEBUG - Given the sequence of scene graphs below, predict the next 2 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (31 frames, 52 to 514):
            
Frame 000052:
Objects:
  - food
  - dish
Relationships:
  - person not_looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000054:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000087:
Objects:
  - food
  - dish
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000121:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000154:
Objects:
  - food
  - dish
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000155:
Objects:
  - food
  - dish
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000175:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000187:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person not_contacting food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000216:
Objects:
  - dish
Relationships:
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000257:
Objects:
  - dish
Relationships:
  - person looking_at dish
  - person in_front_of dish
  - person touching dish


Frame 000258:
Objects:
  - dish
Relationships:
  - person looking_at dish
  - person in_front_of dish
  - person not_contacting dish


Frame 000284:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person touching dish


Frame 000286:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person touching dish


Frame 000298:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000317:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000339:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000350:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000361:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000383:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000392:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000413:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000415:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000416:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000444:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000448:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person beneath table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000464:
Objects:
  - table
  - food
  - dish
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person beneath food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000476:
Objects:
  - table
  - food
  - dish
  - person
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000481:
Objects:
  - table
  - food
  - dish
  - person
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000497:
Objects:
  - table
  - food
  - dish
  - person
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000507:
Objects:
  - table
  - food
  - dish
  - person
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish


Frame 000514:
Objects:
  - table
  - food
  - dish
  - person
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 2 frames ([538, 547]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:27:52,541 - DEBUG - 
===================

2025-02-06 12:27:57,904 - DEBUG - 
=======BATCH PREDICTIONS========
2025-02-06 12:27:57,905 - DEBUG - 
Prediction for frame 538:
2025-02-06 12:27:57,906 - DEBUG - Objects:
2025-02-06 12:27:57,906 - DEBUG -   - table
2025-02-06 12:27:57,906 - DEBUG -   - food
2025-02-06 12:27:57,907 - DEBUG -   - dish
2025-02-06 12:27:57,907 - DEBUG -   - person
2025-02-06 12:27:57,907 - DEBUG - Relationships:
2025-02-06 12:27:57,908 - DEBUG -   - person not_looking_at table
2025-02-06 12:27:57,908 - DEBUG -   - person in_front_of table
2025-02-06 12:27:57,908 - DEBUG -   - person not_contacting table
2025-02-06 12:27:57,908 - DEBUG -   - person looking_at food
2025-02-06 12:27:57,909 - DEBUG -   - person in_front_of food
2025-02-06 12:27:57,909 - DEBUG -   - person holding food
2025-02-06 12:27:57,910 - DEBUG -   - person looking_at dish
2025-02-06 12:27:57,910 - DEBUG -   - person in_front_of dish
2025-02-06 12:27:57,910 - DEBUG -   - person holding dish
2025-02-06 12:27:57,910 - DEBUG - 
Prediction for frame 547:
2025-02-06 12:27:57,910 - DEBUG - Objects:
2025-02-06 12:27:57,910 - DEBUG -   - table
2025-02-06 12:27:57,910 - DEBUG -   - food
2025-02-06 12:27:57,911 - DEBUG -   - dish
2025-02-06 12:27:57,911 - DEBUG -   - person
2025-02-06 12:27:57,911 - DEBUG - Relationships:
2025-02-06 12:27:57,911 - DEBUG -   - person not_looking_at table
2025-02-06 12:27:57,911 - DEBUG -   - person in_front_of table
2025-02-06 12:27:57,911 - DEBUG -   - person not_contacting table
2025-02-06 12:27:57,911 - DEBUG -   - person looking_at food
2025-02-06 12:27:57,911 - DEBUG -   - person in_front_of food
2025-02-06 12:27:57,911 - DEBUG -   - person holding food
2025-02-06 12:27:57,911 - DEBUG -   - person looking_at dish
2025-02-06 12:27:57,912 - DEBUG -   - person in_front_of dish
2025-02-06 12:27:57,912 - DEBUG -   - person holding dish
2025-02-06 12:27:57,912 - DEBUG - Added 2 predictions to context
2025-02-06 12:27:57,912 - DEBUG - Context size now: 33 frames
2025-02-06 12:27:57,912 - DEBUG - ============================

2025-02-06 12:27:57,915 - INFO - Visualizing results...
2025-02-06 12:27:57,915 - DEBUG - Visualizing comparison for frame H51V5.mp4/000476.png
2025-02-06 12:27:58,045 - DEBUG - Visualizing comparison for frame H51V5.mp4/000481.png
2025-02-06 12:27:58,137 - DEBUG - Visualizing comparison for frame H51V5.mp4/000497.png
2025-02-06 12:27:59,793 - DEBUG - Visualizing comparison for frame H51V5.mp4/000507.png
2025-02-06 12:27:59,887 - DEBUG - Visualizing comparison for frame H51V5.mp4/000514.png
2025-02-06 12:27:59,981 - DEBUG - Visualizing comparison for frame H51V5.mp4/000538.png
2025-02-06 12:28:00,072 - DEBUG - Visualizing comparison for frame H51V5.mp4/000547.png
2025-02-06 12:28:00,163 - INFO - Completed processing video: H51V5.mp4
2025-02-06 12:28:00,163 - INFO - Waiting 60 seconds before next video...
2025-02-06 12:29:00,164 - INFO - 
==================================================
Processing video: CXZW3.mp4
==================================================
2025-02-06 12:29:00,171 - INFO - Processing video: CXZW3.mp4
2025-02-06 12:29:00,173 - INFO - Found 10 frames for video CXZW3.mp4
2025-02-06 12:29:00,174 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:29:00,174 - DEBUG - Found scene graph for frame CXZW3.mp4/000093.png
2025-02-06 12:29:00,174 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:29:00,174 - DEBUG - Found scene graph for frame CXZW3.mp4/000177.png
2025-02-06 12:29:00,174 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:29:00,175 - DEBUG - Found scene graph for frame CXZW3.mp4/000224.png
2025-02-06 12:29:00,175 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:29:00,175 - DEBUG - Found scene graph for frame CXZW3.mp4/000271.png
2025-02-06 12:29:00,175 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:29:00,175 - DEBUG - Found scene graph for frame CXZW3.mp4/000277.png
2025-02-06 12:29:00,175 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:29:00,175 - DEBUG - Found scene graph for frame CXZW3.mp4/000317.png
2025-02-06 12:29:00,176 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:29:00,176 - DEBUG - Found scene graph for frame CXZW3.mp4/000364.png
2025-02-06 12:29:00,176 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:29:00,176 - DEBUG - Found scene graph for frame CXZW3.mp4/000461.png
2025-02-06 12:29:00,176 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:29:00,176 - DEBUG - Found scene graph for frame CXZW3.mp4/000644.png
2025-02-06 12:29:00,177 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:29:00,177 - DEBUG - Found scene graph for frame CXZW3.mp4/000828.png
2025-02-06 12:29:00,177 - INFO - Extracted 10 scene graphs
2025-02-06 12:29:00,177 - INFO - Split 10 graphs chronologically into 8 train and 2 test
2025-02-06 12:29:00,177 - DEBUG - Training frames: CXZW3.mp4/000093.png to CXZW3.mp4/000461.png
2025-02-06 12:29:00,177 - DEBUG - Testing frames: CXZW3.mp4/000644.png to CXZW3.mp4/000828.png
2025-02-06 12:29:00,178 - INFO - Generating 2 sequential predictions using closed vocabulary
2025-02-06 12:29:00,178 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:29:00,178 - DEBUG - Starting with 8 training frames
2025-02-06 12:29:00,178 - DEBUG - Frame numbers: [93, 177, 224, 271, 277, 317, 364, 461]
2025-02-06 12:29:00,178 - DEBUG - ============================

2025-02-06 12:29:00,178 - INFO - Found 2 test frames to predict after frame 461
2025-02-06 12:29:00,179 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:29:00,179 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:29:00,179 - DEBUG - Predicting 2 frames: [644, 828]
2025-02-06 12:29:00,179 - DEBUG - Context has 8 frames
2025-02-06 12:29:00,179 - DEBUG - Last 3 context frames: [317, 364, 461]
2025-02-06 12:29:00,185 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000317:
Objects:
  - paper/notebook
Relationships:
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook

Frame 000364:
Objects:
  - paper/notebook
Relationships:
  - person not_looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook

Frame 000461:
Objects:
  - paper/notebook
Relationships:
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook

========================

2025-02-06 12:29:00,186 - DEBUG - 
=======PROMPT========

2025-02-06 12:29:00,186 - DEBUG - Given the sequence of scene graphs below, predict the next 2 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (8 frames, 93 to 461):
            
Frame 000093:
Objects:
  - paper/notebook
Relationships:
  - person not_looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000177:
Objects:
  - paper/notebook
Relationships:
  - person not_looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000224:
Objects:
  - paper/notebook
Relationships:
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000271:
Objects:
  - paper/notebook
Relationships:
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person writing_on paper/notebook


Frame 000277:
Objects:
  - paper/notebook
Relationships:
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000317:
Objects:
  - paper/notebook
Relationships:
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000364:
Objects:
  - paper/notebook
Relationships:
  - person not_looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000461:
Objects:
  - paper/notebook
Relationships:
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 2 frames ([644, 828]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:29:00,186 - DEBUG - 
===================

2025-02-06 12:29:02,830 - DEBUG - 
=======BATCH PREDICTIONS========
2025-02-06 12:29:02,831 - DEBUG - 
Prediction for frame 644:
2025-02-06 12:29:02,831 - DEBUG - Objects:
2025-02-06 12:29:02,831 - DEBUG -   - person
2025-02-06 12:29:02,832 - DEBUG -   - paper_notebook
2025-02-06 12:29:02,832 - DEBUG - Relationships:
2025-02-06 12:29:02,832 - DEBUG -   - person looking_at paper_notebook
2025-02-06 12:29:02,833 - DEBUG -   - person in_front_of paper_notebook
2025-02-06 12:29:02,833 - DEBUG -   - person holding paper_notebook
2025-02-06 12:29:02,833 - DEBUG - 
Prediction for frame 828:
2025-02-06 12:29:02,834 - DEBUG - Objects:
2025-02-06 12:29:02,834 - DEBUG -   - person
2025-02-06 12:29:02,834 - DEBUG -   - paper_notebook
2025-02-06 12:29:02,835 - DEBUG -   - table
2025-02-06 12:29:02,835 - DEBUG - Relationships:
2025-02-06 12:29:02,835 - DEBUG -   - person not_looking_at paper_notebook
2025-02-06 12:29:02,836 - DEBUG -   - person in_front_of paper_notebook
2025-02-06 12:29:02,836 - DEBUG -   - paper_notebook on_the_side_of table
2025-02-06 12:29:02,837 - DEBUG -   - person standing_on floor
2025-02-06 12:29:02,837 - DEBUG - Added 2 predictions to context
2025-02-06 12:29:02,837 - DEBUG - Context size now: 10 frames
2025-02-06 12:29:02,837 - DEBUG - ============================

2025-02-06 12:29:02,837 - INFO - Visualizing results...
2025-02-06 12:29:02,837 - DEBUG - Visualizing comparison for frame CXZW3.mp4/000644.png
2025-02-06 12:29:02,959 - DEBUG - Visualizing comparison for frame CXZW3.mp4/000828.png
2025-02-06 12:29:03,044 - INFO - Completed processing video: CXZW3.mp4
2025-02-06 12:29:03,044 - INFO - Waiting 60 seconds before next video...
2025-02-06 12:30:03,044 - INFO - 
==================================================
Processing video: 1GQAJ.mp4
==================================================
2025-02-06 12:30:03,052 - INFO - Processing video: 1GQAJ.mp4
2025-02-06 12:30:03,053 - INFO - Found 30 frames for video 1GQAJ.mp4
2025-02-06 12:30:03,053 - DEBUG - No valid objects found in annotations for frame 1GQAJ.mp4/000021.png
2025-02-06 12:30:03,054 - WARNING - No scene graph found for frame 1GQAJ.mp4/000021.png
2025-02-06 12:30:03,054 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:30:03,054 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000052.png
2025-02-06 12:30:03,054 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:30:03,054 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000082.png
2025-02-06 12:30:03,055 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:30:03,055 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000086.png
2025-02-06 12:30:03,055 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:30:03,056 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000112.png
2025-02-06 12:30:03,056 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:30:03,056 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000143.png
2025-02-06 12:30:03,056 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:30:03,057 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000165.png
2025-02-06 12:30:03,057 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:30:03,057 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000196.png
2025-02-06 12:30:03,057 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:30:03,057 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000244.png
2025-02-06 12:30:03,057 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:30:03,058 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000246.png
2025-02-06 12:30:03,058 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:30:03,058 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000256.png
2025-02-06 12:30:03,058 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:30:03,058 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000290.png
2025-02-06 12:30:03,058 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:30:03,059 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000312.png
2025-02-06 12:30:03,059 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:30:03,059 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000323.png
2025-02-06 12:30:03,059 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:30:03,060 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000324.png
2025-02-06 12:30:03,060 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:30:03,060 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000357.png
2025-02-06 12:30:03,060 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:30:03,060 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000378.png
2025-02-06 12:30:03,060 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:30:03,060 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000385.png
2025-02-06 12:30:03,061 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:30:03,061 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000402.png
2025-02-06 12:30:03,061 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:30:03,061 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000425.png
2025-02-06 12:30:03,062 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:30:03,062 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000443.png
2025-02-06 12:30:03,062 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:30:03,062 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000458.png
2025-02-06 12:30:03,062 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:30:03,062 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000479.png
2025-02-06 12:30:03,063 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:30:03,063 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000509.png
2025-02-06 12:30:03,063 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:30:03,063 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000526.png
2025-02-06 12:30:03,063 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:30:03,063 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000559.png
2025-02-06 12:30:03,063 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:30:03,063 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000573.png
2025-02-06 12:30:03,064 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:30:03,064 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000627.png
2025-02-06 12:30:03,064 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:30:03,064 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000660.png
2025-02-06 12:30:03,064 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:30:03,064 - DEBUG - Found scene graph for frame 1GQAJ.mp4/000728.png
2025-02-06 12:30:03,064 - INFO - Extracted 29 scene graphs
2025-02-06 12:30:03,065 - INFO - Split 29 graphs chronologically into 23 train and 6 test
2025-02-06 12:30:03,065 - DEBUG - Training frames: 1GQAJ.mp4/000052.png to 1GQAJ.mp4/000509.png
2025-02-06 12:30:03,065 - DEBUG - Testing frames: 1GQAJ.mp4/000526.png to 1GQAJ.mp4/000728.png
2025-02-06 12:30:03,065 - INFO - Generating 6 sequential predictions using closed vocabulary
2025-02-06 12:30:03,065 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:30:03,065 - DEBUG - Starting with 23 training frames
2025-02-06 12:30:03,065 - DEBUG - Frame numbers: [52, 82, 86, 112, 143, 165, 196, 244, 246, 256, 290, 312, 323, 324, 357, 378, 385, 402, 425, 443, 458, 479, 509]
2025-02-06 12:30:03,066 - DEBUG - ============================

2025-02-06 12:30:03,066 - INFO - Found 6 test frames to predict after frame 509
2025-02-06 12:30:03,066 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:30:03,066 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:30:03,066 - DEBUG - Predicting 5 frames: [526, 559, 573, 627, 660]
2025-02-06 12:30:03,066 - DEBUG - Context has 23 frames
2025-02-06 12:30:03,066 - DEBUG - Last 3 context frames: [458, 479, 509]
2025-02-06 12:30:03,084 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000458:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom

Frame 000479:
Objects:
  - floor
  - door
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure door
  - person behind door
  - person not_contacting door
  - person unsure broom
  - person in_front_of broom
  - person holding broom

Frame 000509:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom

========================

2025-02-06 12:30:03,085 - DEBUG - 
=======PROMPT========

2025-02-06 12:30:03,085 - DEBUG - Given the sequence of scene graphs below, predict the next 5 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (23 frames, 52 to 509):
            
Frame 000052:
Objects:
  - doorway
Relationships:
  - person not_looking_at doorway
  - person in doorway
  - person holding doorway


Frame 000082:
Objects:
  - broom
  - doorway
Relationships:
  - person looking_at broom
  - person in_front_of broom
  - person holding broom
  - person not_looking_at doorway
  - person in doorway
  - person touching doorway


Frame 000086:
Objects:
  - broom
  - doorway
Relationships:
  - person looking_at broom
  - person on_the_side_of broom
  - person holding broom
  - person not_looking_at doorway
  - person in doorway
  - person touching doorway


Frame 000112:
Objects:
  - broom
  - doorway
Relationships:
  - person looking_at broom
  - person on_the_side_of broom
  - person holding broom
  - person not_looking_at doorway
  - person in doorway
  - person touching doorway


Frame 000143:
Objects:
  - broom
  - doorway
Relationships:
  - person unsure broom
  - person in_front_of broom
  - person holding broom
  - person not_looking_at doorway
  - person on_the_side_of doorway
  - person not_contacting doorway


Frame 000165:
Objects:
  - broom
Relationships:
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000196:
Objects:
  - broom
Relationships:
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000244:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000246:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000256:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000290:
Objects:
  - floor
  - broom
Relationships:
  - person looking_at floor
  - person beneath floor
  - person in_front_of floor
  - person standing_on floor
  - person looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000312:
Objects:
  - floor
  - broom
Relationships:
  - person looking_at floor
  - person beneath floor
  - person in_front_of floor
  - person standing_on floor
  - person not_looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000323:
Objects:
  - floor
  - broom
Relationships:
  - person looking_at floor
  - person beneath floor
  - person standing_on floor
  - person looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000324:
Objects:
  - floor
  - broom
Relationships:
  - person looking_at floor
  - person beneath floor
  - person in_front_of floor
  - person standing_on floor
  - person looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000357:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000378:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000385:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000402:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000425:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000443:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000458:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000479:
Objects:
  - floor
  - door
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure door
  - person behind door
  - person not_contacting door
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000509:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 5 frames ([526, 559, 573, 627, 660]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:30:03,085 - DEBUG - 
===================

2025-02-06 12:30:10,156 - DEBUG - 
=======BATCH PREDICTIONS========
2025-02-06 12:30:10,157 - DEBUG - 
Prediction for frame 526:
2025-02-06 12:30:10,158 - DEBUG - Objects:
2025-02-06 12:30:10,158 - DEBUG -   - floor
2025-02-06 12:30:10,158 - DEBUG -   - broom
2025-02-06 12:30:10,159 - DEBUG - Relationships:
2025-02-06 12:30:10,159 - DEBUG -   - person unsure floor
2025-02-06 12:30:10,159 - DEBUG -   - person beneath floor
2025-02-06 12:30:10,159 - DEBUG -   - person standing_on floor
2025-02-06 12:30:10,159 - DEBUG -   - person looking_at broom
2025-02-06 12:30:10,159 - DEBUG -   - person in_front_of broom
2025-02-06 12:30:10,159 - DEBUG -   - person holding broom
2025-02-06 12:30:10,160 - DEBUG - 
Prediction for frame 559:
2025-02-06 12:30:10,160 - DEBUG - Objects:
2025-02-06 12:30:10,160 - DEBUG -   - floor
2025-02-06 12:30:10,160 - DEBUG -   - broom
2025-02-06 12:30:10,160 - DEBUG - Relationships:
2025-02-06 12:30:10,160 - DEBUG -   - person unsure floor
2025-02-06 12:30:10,160 - DEBUG -   - person beneath floor
2025-02-06 12:30:10,161 - DEBUG -   - person standing_on floor
2025-02-06 12:30:10,161 - DEBUG -   - person not_looking_at broom
2025-02-06 12:30:10,161 - DEBUG -   - person in_front_of broom
2025-02-06 12:30:10,162 - DEBUG -   - person holding broom
2025-02-06 12:30:10,162 - DEBUG - 
Prediction for frame 573:
2025-02-06 12:30:10,162 - DEBUG - Objects:
2025-02-06 12:30:10,162 - DEBUG -   - floor
2025-02-06 12:30:10,163 - DEBUG -   - broom
2025-02-06 12:30:10,163 - DEBUG - Relationships:
2025-02-06 12:30:10,163 - DEBUG -   - person unsure floor
2025-02-06 12:30:10,163 - DEBUG -   - person beneath floor
2025-02-06 12:30:10,163 - DEBUG -   - person standing_on floor
2025-02-06 12:30:10,163 - DEBUG -   - person not_looking_at broom
2025-02-06 12:30:10,163 - DEBUG -   - person in_front_of broom
2025-02-06 12:30:10,163 - DEBUG -   - person holding broom
2025-02-06 12:30:10,164 - DEBUG - 
Prediction for frame 627:
2025-02-06 12:30:10,164 - DEBUG - Objects:
2025-02-06 12:30:10,164 - DEBUG -   - floor
2025-02-06 12:30:10,164 - DEBUG - Relationships:
2025-02-06 12:30:10,164 - DEBUG -   - person unsure floor
2025-02-06 12:30:10,164 - DEBUG -   - person beneath floor
2025-02-06 12:30:10,165 - DEBUG -   - person standing_on floor
2025-02-06 12:30:10,165 - DEBUG - 
Prediction for frame 660:
2025-02-06 12:30:10,165 - DEBUG - Objects:
2025-02-06 12:30:10,165 - DEBUG -   - floor
2025-02-06 12:30:10,165 - DEBUG - Relationships:
2025-02-06 12:30:10,166 - DEBUG -   - person unsure floor
2025-02-06 12:30:10,166 - DEBUG -   - person beneath floor
2025-02-06 12:30:10,166 - DEBUG -   - person standing_on floor
2025-02-06 12:30:10,166 - DEBUG - Added 5 predictions to context
2025-02-06 12:30:10,166 - DEBUG - Context size now: 28 frames
2025-02-06 12:30:10,166 - DEBUG - ============================

2025-02-06 12:30:10,166 - DEBUG - 
=======BATCH PREDICTION 2========
2025-02-06 12:30:10,166 - DEBUG - Predicting 1 frames: [728]
2025-02-06 12:30:10,166 - DEBUG - Context has 28 frames
2025-02-06 12:30:10,167 - DEBUG - Last 3 context frames: [573, 627, 660]
2025-02-06 12:30:10,180 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000573:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom

Frame 000627:
Objects:
  - floor
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor

Frame 000660:
Objects:
  - floor
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor

========================

2025-02-06 12:30:10,181 - DEBUG - 
=======PROMPT========

2025-02-06 12:30:10,181 - DEBUG - Given the sequence of scene graphs below, predict the next 1 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (28 frames, 52 to 660):
            
Frame 000052:
Objects:
  - doorway
Relationships:
  - person not_looking_at doorway
  - person in doorway
  - person holding doorway


Frame 000082:
Objects:
  - broom
  - doorway
Relationships:
  - person looking_at broom
  - person in_front_of broom
  - person holding broom
  - person not_looking_at doorway
  - person in doorway
  - person touching doorway


Frame 000086:
Objects:
  - broom
  - doorway
Relationships:
  - person looking_at broom
  - person on_the_side_of broom
  - person holding broom
  - person not_looking_at doorway
  - person in doorway
  - person touching doorway


Frame 000112:
Objects:
  - broom
  - doorway
Relationships:
  - person looking_at broom
  - person on_the_side_of broom
  - person holding broom
  - person not_looking_at doorway
  - person in doorway
  - person touching doorway


Frame 000143:
Objects:
  - broom
  - doorway
Relationships:
  - person unsure broom
  - person in_front_of broom
  - person holding broom
  - person not_looking_at doorway
  - person on_the_side_of doorway
  - person not_contacting doorway


Frame 000165:
Objects:
  - broom
Relationships:
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000196:
Objects:
  - broom
Relationships:
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000244:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000246:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000256:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000290:
Objects:
  - floor
  - broom
Relationships:
  - person looking_at floor
  - person beneath floor
  - person in_front_of floor
  - person standing_on floor
  - person looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000312:
Objects:
  - floor
  - broom
Relationships:
  - person looking_at floor
  - person beneath floor
  - person in_front_of floor
  - person standing_on floor
  - person not_looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000323:
Objects:
  - floor
  - broom
Relationships:
  - person looking_at floor
  - person beneath floor
  - person standing_on floor
  - person looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000324:
Objects:
  - floor
  - broom
Relationships:
  - person looking_at floor
  - person beneath floor
  - person in_front_of floor
  - person standing_on floor
  - person looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000357:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000378:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000385:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000402:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000425:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000443:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000458:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000479:
Objects:
  - floor
  - door
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure door
  - person behind door
  - person not_contacting door
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000509:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000526:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000559:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000573:
Objects:
  - floor
  - broom
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000627:
Objects:
  - floor
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor


Frame 000660:
Objects:
  - floor
Relationships:
  - person unsure floor
  - person beneath floor
  - person standing_on floor

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 1 frames ([728]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:30:10,181 - DEBUG - 
===================

2025-02-06 12:30:11,509 - DEBUG - 
=======BATCH PREDICTIONS========
2025-02-06 12:30:11,510 - DEBUG - 
Prediction for frame 728:
2025-02-06 12:30:11,510 - DEBUG - Objects:
2025-02-06 12:30:11,510 - DEBUG -   - floor
2025-02-06 12:30:11,511 - DEBUG - Relationships:
2025-02-06 12:30:11,511 - DEBUG -   - person unsure floor
2025-02-06 12:30:11,511 - DEBUG -   - person beneath floor
2025-02-06 12:30:11,512 - DEBUG -   - person standing_on floor
2025-02-06 12:30:11,512 - DEBUG - Added 1 predictions to context
2025-02-06 12:30:11,512 - DEBUG - Context size now: 29 frames
2025-02-06 12:30:11,513 - DEBUG - ============================

2025-02-06 12:30:11,516 - INFO - Visualizing results...
2025-02-06 12:30:11,517 - DEBUG - Visualizing comparison for frame 1GQAJ.mp4/000526.png
2025-02-06 12:30:11,636 - DEBUG - Visualizing comparison for frame 1GQAJ.mp4/000559.png
2025-02-06 12:30:11,724 - DEBUG - Visualizing comparison for frame 1GQAJ.mp4/000573.png
2025-02-06 12:30:11,809 - DEBUG - Visualizing comparison for frame 1GQAJ.mp4/000627.png
2025-02-06 12:30:11,889 - DEBUG - Visualizing comparison for frame 1GQAJ.mp4/000660.png
2025-02-06 12:30:11,968 - DEBUG - Visualizing comparison for frame 1GQAJ.mp4/000728.png
2025-02-06 12:30:12,049 - INFO - Completed processing video: 1GQAJ.mp4
2025-02-06 12:30:12,050 - INFO - Waiting 60 seconds before next video...
2025-02-06 12:31:12,050 - INFO - 
==================================================
Processing video: 0R5GS.mp4
==================================================
2025-02-06 12:31:12,056 - INFO - Processing video: 0R5GS.mp4
2025-02-06 12:31:12,058 - INFO - Found 20 frames for video 0R5GS.mp4
2025-02-06 12:31:12,060 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:31:12,060 - DEBUG - Found scene graph for frame 0R5GS.mp4/000050.png
2025-02-06 12:31:12,060 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:31:12,060 - DEBUG - Found scene graph for frame 0R5GS.mp4/000087.png
2025-02-06 12:31:12,060 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:31:12,061 - DEBUG - Found scene graph for frame 0R5GS.mp4/000124.png
2025-02-06 12:31:12,061 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:31:12,061 - DEBUG - Found scene graph for frame 0R5GS.mp4/000138.png
2025-02-06 12:31:12,061 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:31:12,062 - DEBUG - Found scene graph for frame 0R5GS.mp4/000161.png
2025-02-06 12:31:12,062 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:31:12,062 - DEBUG - Found scene graph for frame 0R5GS.mp4/000198.png
2025-02-06 12:31:12,062 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:31:12,063 - DEBUG - Found scene graph for frame 0R5GS.mp4/000316.png
2025-02-06 12:31:12,063 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:31:12,063 - DEBUG - Found scene graph for frame 0R5GS.mp4/000389.png
2025-02-06 12:31:12,063 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:31:12,064 - DEBUG - Found scene graph for frame 0R5GS.mp4/000408.png
2025-02-06 12:31:12,064 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:31:12,064 - DEBUG - Found scene graph for frame 0R5GS.mp4/000494.png
2025-02-06 12:31:12,064 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:31:12,064 - DEBUG - Found scene graph for frame 0R5GS.mp4/000511.png
2025-02-06 12:31:12,065 - DEBUG - No valid objects found in annotations for frame 0R5GS.mp4/000515.png
2025-02-06 12:31:12,065 - WARNING - No scene graph found for frame 0R5GS.mp4/000515.png
2025-02-06 12:31:12,065 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:31:12,066 - DEBUG - Found scene graph for frame 0R5GS.mp4/000622.png
2025-02-06 12:31:12,066 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:31:12,066 - DEBUG - Found scene graph for frame 0R5GS.mp4/000634.png
2025-02-06 12:31:12,066 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:31:12,066 - DEBUG - Found scene graph for frame 0R5GS.mp4/000672.png
2025-02-06 12:31:12,067 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:31:12,067 - DEBUG - Found scene graph for frame 0R5GS.mp4/000728.png
2025-02-06 12:31:12,067 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:31:12,067 - DEBUG - Found scene graph for frame 0R5GS.mp4/000756.png
2025-02-06 12:31:12,067 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:31:12,067 - DEBUG - Found scene graph for frame 0R5GS.mp4/000835.png
2025-02-06 12:31:12,067 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:31:12,067 - DEBUG - Found scene graph for frame 0R5GS.mp4/000850.png
2025-02-06 12:31:12,068 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:31:12,068 - DEBUG - Found scene graph for frame 0R5GS.mp4/000878.png
2025-02-06 12:31:12,068 - INFO - Extracted 19 scene graphs
2025-02-06 12:31:12,068 - INFO - Split 19 graphs chronologically into 15 train and 4 test
2025-02-06 12:31:12,069 - DEBUG - Training frames: 0R5GS.mp4/000050.png to 0R5GS.mp4/000728.png
2025-02-06 12:31:12,069 - DEBUG - Testing frames: 0R5GS.mp4/000756.png to 0R5GS.mp4/000878.png
2025-02-06 12:31:12,072 - INFO - Generating 4 sequential predictions using closed vocabulary
2025-02-06 12:31:12,073 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:31:12,073 - DEBUG - Starting with 15 training frames
2025-02-06 12:31:12,073 - DEBUG - Frame numbers: [50, 87, 124, 138, 161, 198, 316, 389, 408, 494, 511, 622, 634, 672, 728]
2025-02-06 12:31:12,073 - DEBUG - ============================

2025-02-06 12:31:12,073 - INFO - Found 4 test frames to predict after frame 728
2025-02-06 12:31:12,074 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:31:12,074 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:31:12,074 - DEBUG - Predicting 4 frames: [756, 835, 850, 878]
2025-02-06 12:31:12,074 - DEBUG - Context has 15 frames
2025-02-06 12:31:12,074 - DEBUG - Last 3 context frames: [634, 672, 728]
2025-02-06 12:31:12,084 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000634:
Objects:
  - box
Relationships:
  - person not_looking_at box
  - person in_front_of box
  - person holding box

Frame 000672:
Objects:
  - mirror
Relationships:
  - person unsure mirror
  - person on_the_side_of mirror
  - person not_contacting mirror

Frame 000728:
Objects:
  - box
Relationships:
  - person not_looking_at box
  - person in_front_of box
  - person holding box

========================

2025-02-06 12:31:12,085 - DEBUG - 
=======PROMPT========

2025-02-06 12:31:12,085 - DEBUG - Given the sequence of scene graphs below, predict the next 4 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (15 frames, 50 to 728):
            
Frame 000050:
Objects:
  - box
Relationships:
  - person looking_at box
  - person in_front_of box
  - person on_the_side_of box
  - person not_contacting box


Frame 000087:
Objects:
  - box
Relationships:
  - person looking_at box
  - person in_front_of box
  - person touching box


Frame 000124:
Objects:
  - box
Relationships:
  - person looking_at box
  - person in_front_of box
  - person holding box


Frame 000138:
Objects:
  - box
Relationships:
  - person looking_at box
  - person in_front_of box
  - person holding box


Frame 000161:
Objects:
  - box
Relationships:
  - person looking_at box
  - person in_front_of box
  - person holding box


Frame 000198:
Objects:
  - box
Relationships:
  - person looking_at box
  - person in_front_of box
  - person holding box


Frame 000316:
Objects:
  - box
Relationships:
  - person looking_at box
  - person in_front_of box
  - person holding box


Frame 000389:
Objects:
  - box
  - mirror
Relationships:
  - person not_looking_at box
  - person in_front_of box
  - person holding box
  - person not_looking_at mirror
  - person in_front_of mirror
  - person not_contacting mirror


Frame 000408:
Objects:
  - mirror
Relationships:
  - person unsure mirror
  - person in_front_of mirror
  - person not_contacting mirror


Frame 000494:
Objects:
  - box
  - mirror
Relationships:
  - person not_looking_at box
  - person in_front_of box
  - person holding box
  - person not_looking_at mirror
  - person on_the_side_of mirror
  - person not_contacting mirror


Frame 000511:
Objects:
  - mirror
Relationships:
  - person not_looking_at mirror
  - person behind mirror
  - person not_contacting mirror


Frame 000622:
Objects:
  - box
  - mirror
Relationships:
  - person not_looking_at box
  - person in_front_of box
  - person holding box
  - person not_looking_at mirror
  - person on_the_side_of mirror
  - person behind mirror
  - person not_contacting mirror


Frame 000634:
Objects:
  - box
Relationships:
  - person not_looking_at box
  - person in_front_of box
  - person holding box


Frame 000672:
Objects:
  - mirror
Relationships:
  - person unsure mirror
  - person on_the_side_of mirror
  - person not_contacting mirror


Frame 000728:
Objects:
  - box
Relationships:
  - person not_looking_at box
  - person in_front_of box
  - person holding box

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 4 frames ([756, 835, 850, 878]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:31:12,085 - DEBUG - 
===================

2025-02-06 12:31:16,045 - DEBUG - 
=======BATCH PREDICTIONS========
2025-02-06 12:31:16,046 - DEBUG - 
Prediction for frame 756:
2025-02-06 12:31:16,046 - DEBUG - Objects:
2025-02-06 12:31:16,046 - DEBUG -   - box
2025-02-06 12:31:16,047 - DEBUG - Relationships:
2025-02-06 12:31:16,047 - DEBUG -   - person not_looking_at box
2025-02-06 12:31:16,047 - DEBUG -   - person in_front_of box
2025-02-06 12:31:16,048 - DEBUG -   - person holding box
2025-02-06 12:31:16,048 - DEBUG - 
Prediction for frame 835:
2025-02-06 12:31:16,048 - DEBUG - Objects:
2025-02-06 12:31:16,049 - DEBUG -   - box
2025-02-06 12:31:16,049 - DEBUG -   - table
2025-02-06 12:31:16,049 - DEBUG - Relationships:
2025-02-06 12:31:16,050 - DEBUG -   - person not_looking_at box
2025-02-06 12:31:16,050 - DEBUG -   - person in_front_of box
2025-02-06 12:31:16,050 - DEBUG -   - person placing box
2025-02-06 12:31:16,051 - DEBUG -   - box on table
2025-02-06 12:31:16,051 - DEBUG - 
Prediction for frame 850:
2025-02-06 12:31:16,052 - DEBUG - Objects:
2025-02-06 12:31:16,052 - DEBUG -   - table
2025-02-06 12:31:16,052 - DEBUG -   - box
2025-02-06 12:31:16,053 - DEBUG - Relationships:
2025-02-06 12:31:16,053 - DEBUG -   - box on table
2025-02-06 12:31:16,053 - DEBUG -   - person not_looking_at box
2025-02-06 12:31:16,053 - DEBUG -   - person near table
2025-02-06 12:31:16,053 - DEBUG - 
Prediction for frame 878:
2025-02-06 12:31:16,053 - DEBUG - Objects:
2025-02-06 12:31:16,053 - DEBUG -   - table
2025-02-06 12:31:16,054 - DEBUG - Relationships:
2025-02-06 12:31:16,054 - DEBUG -   - person walking_away_from table
2025-02-06 12:31:16,054 - DEBUG - Added 4 predictions to context
2025-02-06 12:31:16,054 - DEBUG - Context size now: 19 frames
2025-02-06 12:31:16,054 - DEBUG - ============================

2025-02-06 12:31:16,055 - INFO - Visualizing results...
2025-02-06 12:31:16,055 - DEBUG - Visualizing comparison for frame 0R5GS.mp4/000756.png
2025-02-06 12:31:16,177 - DEBUG - Visualizing comparison for frame 0R5GS.mp4/000835.png
2025-02-06 12:31:16,264 - DEBUG - Visualizing comparison for frame 0R5GS.mp4/000850.png
2025-02-06 12:31:16,350 - DEBUG - Visualizing comparison for frame 0R5GS.mp4/000878.png
2025-02-06 12:31:16,433 - INFO - Completed processing video: 0R5GS.mp4
2025-02-06 12:31:16,433 - INFO - Waiting 60 seconds before next video...
2025-02-06 12:32:16,434 - INFO - 
==================================================
Processing video: FNJ2G.mp4
==================================================
2025-02-06 12:32:16,440 - INFO - Processing video: FNJ2G.mp4
2025-02-06 12:32:16,442 - INFO - Found 20 frames for video FNJ2G.mp4
2025-02-06 12:32:16,444 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:32:16,444 - DEBUG - Found scene graph for frame FNJ2G.mp4/000037.png
2025-02-06 12:32:16,444 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:32:16,444 - DEBUG - Found scene graph for frame FNJ2G.mp4/000098.png
2025-02-06 12:32:16,444 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:32:16,445 - DEBUG - Found scene graph for frame FNJ2G.mp4/000109.png
2025-02-06 12:32:16,445 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:32:16,445 - DEBUG - Found scene graph for frame FNJ2G.mp4/000181.png
2025-02-06 12:32:16,445 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:32:16,445 - DEBUG - Found scene graph for frame FNJ2G.mp4/000227.png
2025-02-06 12:32:16,445 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:32:16,445 - DEBUG - Found scene graph for frame FNJ2G.mp4/000252.png
2025-02-06 12:32:16,446 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:32:16,446 - DEBUG - Found scene graph for frame FNJ2G.mp4/000291.png
2025-02-06 12:32:16,446 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:32:16,446 - DEBUG - Found scene graph for frame FNJ2G.mp4/000314.png
2025-02-06 12:32:16,446 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:32:16,446 - DEBUG - Found scene graph for frame FNJ2G.mp4/000324.png
2025-02-06 12:32:16,447 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:32:16,447 - DEBUG - Found scene graph for frame FNJ2G.mp4/000391.png
2025-02-06 12:32:16,447 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:32:16,447 - DEBUG - Found scene graph for frame FNJ2G.mp4/000459.png
2025-02-06 12:32:16,447 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:32:16,447 - DEBUG - Found scene graph for frame FNJ2G.mp4/000484.png
2025-02-06 12:32:16,447 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:32:16,448 - DEBUG - Found scene graph for frame FNJ2G.mp4/000556.png
2025-02-06 12:32:16,448 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:32:16,448 - DEBUG - Found scene graph for frame FNJ2G.mp4/000604.png
2025-02-06 12:32:16,448 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:32:16,448 - DEBUG - Found scene graph for frame FNJ2G.mp4/000677.png
2025-02-06 12:32:16,449 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:32:16,449 - DEBUG - Found scene graph for frame FNJ2G.mp4/000720.png
2025-02-06 12:32:16,449 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:32:16,449 - DEBUG - Found scene graph for frame FNJ2G.mp4/000749.png
2025-02-06 12:32:16,449 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:32:16,449 - DEBUG - Found scene graph for frame FNJ2G.mp4/000870.png
2025-02-06 12:32:16,450 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:32:16,450 - DEBUG - Found scene graph for frame FNJ2G.mp4/000884.png
2025-02-06 12:32:16,450 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:32:16,450 - DEBUG - Found scene graph for frame FNJ2G.mp4/000894.png
2025-02-06 12:32:16,450 - INFO - Extracted 20 scene graphs
2025-02-06 12:32:16,451 - INFO - Split 20 graphs chronologically into 16 train and 4 test
2025-02-06 12:32:16,451 - DEBUG - Training frames: FNJ2G.mp4/000037.png to FNJ2G.mp4/000720.png
2025-02-06 12:32:16,451 - DEBUG - Testing frames: FNJ2G.mp4/000749.png to FNJ2G.mp4/000894.png
2025-02-06 12:32:16,451 - INFO - Generating 4 sequential predictions using closed vocabulary
2025-02-06 12:32:16,451 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:32:16,451 - DEBUG - Starting with 16 training frames
2025-02-06 12:32:16,452 - DEBUG - Frame numbers: [37, 98, 109, 181, 227, 252, 291, 314, 324, 391, 459, 484, 556, 604, 677, 720]
2025-02-06 12:32:16,452 - DEBUG - ============================

2025-02-06 12:32:16,452 - INFO - Found 4 test frames to predict after frame 720
2025-02-06 12:32:16,452 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:32:16,452 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:32:16,453 - DEBUG - Predicting 4 frames: [749, 870, 884, 894]
2025-02-06 12:32:16,453 - DEBUG - Context has 16 frames
2025-02-06 12:32:16,453 - DEBUG - Last 3 context frames: [604, 677, 720]
2025-02-06 12:32:16,466 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000604:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom

Frame 000677:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person on_the_side_of broom
  - person holding broom

Frame 000720:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person on_the_side_of broom
  - person holding broom

========================

2025-02-06 12:32:16,466 - DEBUG - 
=======PROMPT========

2025-02-06 12:32:16,466 - DEBUG - Given the sequence of scene graphs below, predict the next 4 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (16 frames, 37 to 720):
            
Frame 000037:
Objects:
  - broom
Relationships:
  - person not_looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000098:
Objects:
  - broom
Relationships:
  - person not_looking_at broom
  - person on_the_side_of broom
  - person holding broom


Frame 000109:
Objects:
  - broom
Relationships:
  - person not_looking_at broom
  - person on_the_side_of broom
  - person holding broom


Frame 000181:
Objects:
  - broom
Relationships:
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000227:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person on_the_side_of broom
  - person holding broom


Frame 000252:
Objects:
  - broom
Relationships:
  - person not_looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000291:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person above phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000314:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000324:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person on_the_side_of broom
  - person holding broom


Frame 000391:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000459:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000484:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person touching phone/camera
  - person holding phone/camera
  - person looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000556:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person on_the_side_of broom
  - person holding broom


Frame 000604:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000677:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person on_the_side_of broom
  - person holding broom


Frame 000720:
Objects:
  - phone/camera
  - broom
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera
  - person not_looking_at broom
  - person on_the_side_of broom
  - person holding broom

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 4 frames ([749, 870, 884, 894]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:32:16,466 - DEBUG - 
===================

2025-02-06 12:32:23,374 - DEBUG - 
=======BATCH PREDICTIONS========
2025-02-06 12:32:23,377 - DEBUG - 
Prediction for frame 749:
2025-02-06 12:32:23,377 - DEBUG - Objects:
2025-02-06 12:32:23,378 - DEBUG -   - person
2025-02-06 12:32:23,378 - DEBUG -   - phone_camera
2025-02-06 12:32:23,378 - DEBUG -   - broom
2025-02-06 12:32:23,378 - DEBUG - Relationships:
2025-02-06 12:32:23,378 - DEBUG -   - person not_looking_at phone_camera
2025-02-06 12:32:23,378 - DEBUG -   - person on_the_side_of phone_camera
2025-02-06 12:32:23,378 - DEBUG -   - person holding phone_camera
2025-02-06 12:32:23,379 - DEBUG -   - person looking_at broom
2025-02-06 12:32:23,379 - DEBUG -   - person in_front_of broom
2025-02-06 12:32:23,379 - DEBUG -   - person on_the_side_of broom
2025-02-06 12:32:23,379 - DEBUG -   - person holding broom
2025-02-06 12:32:23,379 - DEBUG - 
Prediction for frame 870:
2025-02-06 12:32:23,379 - DEBUG - Objects:
2025-02-06 12:32:23,379 - DEBUG -   - person
2025-02-06 12:32:23,380 - DEBUG -   - phone_camera
2025-02-06 12:32:23,380 - DEBUG -   - broom
2025-02-06 12:32:23,380 - DEBUG - Relationships:
2025-02-06 12:32:23,380 - DEBUG -   - person not_looking_at phone_camera
2025-02-06 12:32:23,380 - DEBUG -   - person on_the_side_of phone_camera
2025-02-06 12:32:23,381 - DEBUG -   - person holding phone_camera
2025-02-06 12:32:23,381 - DEBUG -   - person looking_at broom
2025-02-06 12:32:23,381 - DEBUG -   - person in_front_of broom
2025-02-06 12:32:23,381 - DEBUG -   - person on_the_side_of broom
2025-02-06 12:32:23,381 - DEBUG -   - person holding broom
2025-02-06 12:32:23,381 - DEBUG - 
Prediction for frame 884:
2025-02-06 12:32:23,382 - DEBUG - Objects:
2025-02-06 12:32:23,382 - DEBUG -   - person
2025-02-06 12:32:23,382 - DEBUG -   - broom
2025-02-06 12:32:23,382 - DEBUG - Relationships:
2025-02-06 12:32:23,382 - DEBUG -   - person looking_at broom
2025-02-06 12:32:23,382 - DEBUG -   - person in_front_of broom
2025-02-06 12:32:23,382 - DEBUG -   - person holding broom
2025-02-06 12:32:23,383 - DEBUG - 
Prediction for frame 894:
2025-02-06 12:32:23,383 - DEBUG - Objects:
2025-02-06 12:32:23,383 - DEBUG -   - person
2025-02-06 12:32:23,383 - DEBUG -   - broom
2025-02-06 12:32:23,383 - DEBUG - Relationships:
2025-02-06 12:32:23,384 - DEBUG -   - person not_looking_at broom
2025-02-06 12:32:23,384 - DEBUG -   - person in_front_of broom
2025-02-06 12:32:23,384 - DEBUG -   - person holding broom
2025-02-06 12:32:23,384 - DEBUG - Added 4 predictions to context
2025-02-06 12:32:23,384 - DEBUG - Context size now: 20 frames
2025-02-06 12:32:23,384 - DEBUG - ============================

2025-02-06 12:32:23,385 - INFO - Visualizing results...
2025-02-06 12:32:23,385 - DEBUG - Visualizing comparison for frame FNJ2G.mp4/000749.png
2025-02-06 12:32:23,518 - DEBUG - Visualizing comparison for frame FNJ2G.mp4/000870.png
2025-02-06 12:32:23,628 - DEBUG - Visualizing comparison for frame FNJ2G.mp4/000884.png
2025-02-06 12:32:23,720 - DEBUG - Visualizing comparison for frame FNJ2G.mp4/000894.png
2025-02-06 12:32:23,809 - INFO - Completed processing video: FNJ2G.mp4
2025-02-06 12:32:23,810 - INFO - Waiting 60 seconds before next video...
2025-02-06 12:33:23,815 - INFO - 
==================================================
Processing video: P76D1.mp4
==================================================
2025-02-06 12:33:23,829 - INFO - Processing video: P76D1.mp4
2025-02-06 12:33:23,833 - INFO - Found 32 frames for video P76D1.mp4
2025-02-06 12:33:23,844 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:33:23,844 - DEBUG - Found scene graph for frame P76D1.mp4/000025.png
2025-02-06 12:33:23,845 - DEBUG - Extracted scene graph with 2 objects and 9 relationships
2025-02-06 12:33:23,845 - DEBUG - Found scene graph for frame P76D1.mp4/000026.png
2025-02-06 12:33:23,845 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:33:23,845 - DEBUG - Found scene graph for frame P76D1.mp4/000031.png
2025-02-06 12:33:23,846 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:33:23,848 - DEBUG - Found scene graph for frame P76D1.mp4/000074.png
2025-02-06 12:33:23,848 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:33:23,849 - DEBUG - Found scene graph for frame P76D1.mp4/000077.png
2025-02-06 12:33:23,849 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:33:23,850 - DEBUG - Found scene graph for frame P76D1.mp4/000090.png
2025-02-06 12:33:23,850 - DEBUG - Extracted scene graph with 2 objects and 9 relationships
2025-02-06 12:33:23,850 - DEBUG - Found scene graph for frame P76D1.mp4/000123.png
2025-02-06 12:33:23,852 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:33:23,852 - DEBUG - Found scene graph for frame P76D1.mp4/000127.png
2025-02-06 12:33:23,853 - DEBUG - Extracted scene graph with 2 objects and 9 relationships
2025-02-06 12:33:23,853 - DEBUG - Found scene graph for frame P76D1.mp4/000149.png
2025-02-06 12:33:23,853 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:33:23,854 - DEBUG - Found scene graph for frame P76D1.mp4/000150.png
2025-02-06 12:33:23,854 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:33:23,854 - DEBUG - Found scene graph for frame P76D1.mp4/000171.png
2025-02-06 12:33:23,854 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:33:23,854 - DEBUG - Found scene graph for frame P76D1.mp4/000177.png
2025-02-06 12:33:23,855 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:33:23,855 - DEBUG - Found scene graph for frame P76D1.mp4/000204.png
2025-02-06 12:33:23,859 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:33:23,860 - DEBUG - Found scene graph for frame P76D1.mp4/000208.png
2025-02-06 12:33:23,862 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:33:23,863 - DEBUG - Found scene graph for frame P76D1.mp4/000209.png
2025-02-06 12:33:23,865 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:33:23,865 - DEBUG - Found scene graph for frame P76D1.mp4/000210.png
2025-02-06 12:33:23,866 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:33:23,867 - DEBUG - Found scene graph for frame P76D1.mp4/000217.png
2025-02-06 12:33:23,867 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:33:23,868 - DEBUG - Found scene graph for frame P76D1.mp4/000220.png
2025-02-06 12:33:23,868 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:33:23,869 - DEBUG - Found scene graph for frame P76D1.mp4/000223.png
2025-02-06 12:33:23,870 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:33:23,870 - DEBUG - Found scene graph for frame P76D1.mp4/000228.png
2025-02-06 12:33:23,873 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:33:23,874 - DEBUG - Found scene graph for frame P76D1.mp4/000231.png
2025-02-06 12:33:23,875 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:33:23,875 - DEBUG - Found scene graph for frame P76D1.mp4/000236.png
2025-02-06 12:33:23,877 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:33:23,877 - DEBUG - Found scene graph for frame P76D1.mp4/000243.png
2025-02-06 12:33:23,877 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:33:23,877 - DEBUG - Found scene graph for frame P76D1.mp4/000254.png
2025-02-06 12:33:23,878 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:33:23,878 - DEBUG - Found scene graph for frame P76D1.mp4/000256.png
2025-02-06 12:33:23,880 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:33:23,880 - DEBUG - Found scene graph for frame P76D1.mp4/000262.png
2025-02-06 12:33:23,881 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:33:23,881 - DEBUG - Found scene graph for frame P76D1.mp4/000267.png
2025-02-06 12:33:23,882 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:33:23,882 - DEBUG - Found scene graph for frame P76D1.mp4/000269.png
2025-02-06 12:33:23,882 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:33:23,882 - DEBUG - Found scene graph for frame P76D1.mp4/000276.png
2025-02-06 12:33:23,883 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:33:23,883 - DEBUG - Found scene graph for frame P76D1.mp4/000281.png
2025-02-06 12:33:23,883 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:33:23,883 - DEBUG - Found scene graph for frame P76D1.mp4/000295.png
2025-02-06 12:33:23,884 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:33:23,884 - DEBUG - Found scene graph for frame P76D1.mp4/000298.png
2025-02-06 12:33:23,884 - INFO - Extracted 32 scene graphs
2025-02-06 12:33:23,884 - INFO - Split 32 graphs chronologically into 25 train and 7 test
2025-02-06 12:33:23,884 - DEBUG - Training frames: P76D1.mp4/000025.png to P76D1.mp4/000256.png
2025-02-06 12:33:23,885 - DEBUG - Testing frames: P76D1.mp4/000262.png to P76D1.mp4/000298.png
2025-02-06 12:33:23,885 - INFO - Generating 7 sequential predictions using closed vocabulary
2025-02-06 12:33:23,885 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:33:23,885 - DEBUG - Starting with 25 training frames
2025-02-06 12:33:23,886 - DEBUG - Frame numbers: [25, 26, 31, 74, 77, 90, 123, 127, 149, 150, 171, 177, 204, 208, 209, 210, 217, 220, 223, 228, 231, 236, 243, 254, 256]
2025-02-06 12:33:23,886 - DEBUG - ============================

2025-02-06 12:33:23,886 - INFO - Found 7 test frames to predict after frame 256
2025-02-06 12:33:23,886 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:33:23,886 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:33:23,887 - DEBUG - Predicting 5 frames: [262, 267, 269, 276, 281]
2025-02-06 12:33:23,887 - DEBUG - Context has 25 frames
2025-02-06 12:33:23,887 - DEBUG - Last 3 context frames: [243, 254, 256]
2025-02-06 12:33:23,931 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000243:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish
  - person not_looking_at chair
  - person behind chair
  - person beneath chair
  - person not_contacting chair

Frame 000254:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person on_the_side_of food
  - person holding food
  - person looking_at dish
  - person behind dish
  - person on_the_side_of dish
  - person holding dish

Frame 000256:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person on_the_side_of dish
  - person holding dish

========================

2025-02-06 12:33:23,932 - DEBUG - 
=======PROMPT========

2025-02-06 12:33:23,932 - DEBUG - Given the sequence of scene graphs below, predict the next 5 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (25 frames, 25 to 256):
            
Frame 000025:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person beneath food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair


Frame 000026:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person beneath food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person leaning_on chair
  - person other_relationship chair


Frame 000031:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair


Frame 000074:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000077:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000090:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person leaning_on chair


Frame 000123:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person leaning_on chair
  - person other_relationship chair


Frame 000127:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000149:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person leaning_on chair
  - person other_relationship chair


Frame 000150:
Objects:
  - food
  - chair
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair


Frame 000171:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person leaning_on chair


Frame 000177:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000204:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish
  - person touching dish
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000208:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000209:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person touching dish
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000210:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person touching dish
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person leaning_on chair
  - person other_relationship chair


Frame 000217:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person touching dish
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000220:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person touching dish
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000223:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person not_looking_at food
  - person beneath food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish
  - person not_looking_at chair
  - person behind chair
  - person beneath chair
  - person sitting_on chair
  - person leaning_on chair
  - person other_relationship chair


Frame 000228:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000231:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person not_looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000236:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish
  - person not_looking_at chair
  - person behind chair
  - person not_contacting chair


Frame 000243:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish
  - person not_looking_at chair
  - person behind chair
  - person beneath chair
  - person not_contacting chair


Frame 000254:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person on_the_side_of food
  - person holding food
  - person looking_at dish
  - person behind dish
  - person on_the_side_of dish
  - person holding dish


Frame 000256:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person on_the_side_of dish
  - person holding dish

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 5 frames ([262, 267, 269, 276, 281]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:33:23,933 - DEBUG - 
===================

2025-02-06 12:33:30,135 - DEBUG - 
=======BATCH PREDICTIONS========
2025-02-06 12:33:30,139 - DEBUG - 
Prediction for frame 262:
2025-02-06 12:33:30,140 - DEBUG - Objects:
2025-02-06 12:33:30,140 - DEBUG -   - food
2025-02-06 12:33:30,140 - DEBUG -   - dish
2025-02-06 12:33:30,140 - DEBUG - Relationships:
2025-02-06 12:33:30,140 - DEBUG -   - person looking_at food
2025-02-06 12:33:30,140 - DEBUG -   - person in_front_of food
2025-02-06 12:33:30,140 - DEBUG -   - person holding food
2025-02-06 12:33:30,140 - DEBUG -   - person looking_at dish
2025-02-06 12:33:30,140 - DEBUG -   - person on_the_side_of dish
2025-02-06 12:33:30,141 - DEBUG -   - person holding dish
2025-02-06 12:33:30,141 - DEBUG - 
Prediction for frame 267:
2025-02-06 12:33:30,141 - DEBUG - Objects:
2025-02-06 12:33:30,141 - DEBUG -   - food
2025-02-06 12:33:30,141 - DEBUG -   - dish
2025-02-06 12:33:30,141 - DEBUG - Relationships:
2025-02-06 12:33:30,141 - DEBUG -   - person looking_at food
2025-02-06 12:33:30,142 - DEBUG -   - person in_front_of food
2025-02-06 12:33:30,142 - DEBUG -   - person holding food
2025-02-06 12:33:30,142 - DEBUG -   - person looking_at dish
2025-02-06 12:33:30,142 - DEBUG -   - person behind dish
2025-02-06 12:33:30,142 - DEBUG -   - person holding dish
2025-02-06 12:33:30,142 - DEBUG - 
Prediction for frame 269:
2025-02-06 12:33:30,142 - DEBUG - Objects:
2025-02-06 12:33:30,142 - DEBUG -   - food
2025-02-06 12:33:30,143 - DEBUG -   - dish
2025-02-06 12:33:30,143 - DEBUG - Relationships:
2025-02-06 12:33:30,143 - DEBUG -   - person looking_at food
2025-02-06 12:33:30,143 - DEBUG -   - person in_front_of food
2025-02-06 12:33:30,143 - DEBUG -   - person holding food
2025-02-06 12:33:30,143 - DEBUG -   - person looking_at dish
2025-02-06 12:33:30,143 - DEBUG -   - person behind dish
2025-02-06 12:33:30,143 - DEBUG -   - person holding dish
2025-02-06 12:33:30,143 - DEBUG -   - person eating food
2025-02-06 12:33:30,144 - DEBUG - 
Prediction for frame 276:
2025-02-06 12:33:30,144 - DEBUG - Objects:
2025-02-06 12:33:30,144 - DEBUG -   - dish
2025-02-06 12:33:30,144 - DEBUG - Relationships:
2025-02-06 12:33:30,144 - DEBUG -   - person looking_at dish
2025-02-06 12:33:30,144 - DEBUG -   - person holding dish
2025-02-06 12:33:30,144 - DEBUG - 
Prediction for frame 281:
2025-02-06 12:33:30,145 - DEBUG - Objects:
2025-02-06 12:33:30,145 - DEBUG -   - dish
2025-02-06 12:33:30,145 - DEBUG - Relationships:
2025-02-06 12:33:30,145 - DEBUG -   - person not_looking_at dish
2025-02-06 12:33:30,145 - DEBUG -   - person holding dish
2025-02-06 12:33:30,145 - DEBUG - Added 5 predictions to context
2025-02-06 12:33:30,145 - DEBUG - Context size now: 30 frames
2025-02-06 12:33:30,145 - DEBUG - ============================

2025-02-06 12:33:30,146 - DEBUG - 
=======BATCH PREDICTION 2========
2025-02-06 12:33:30,146 - DEBUG - Predicting 2 frames: [295, 298]
2025-02-06 12:33:30,146 - DEBUG - Context has 30 frames
2025-02-06 12:33:30,146 - DEBUG - Last 3 context frames: [269, 276, 281]
2025-02-06 12:33:30,177 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000269:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person behind dish
  - person holding dish
  - person eating food

Frame 000276:
Objects:
  - dish
Relationships:
  - person looking_at dish
  - person holding dish

Frame 000281:
Objects:
  - dish
Relationships:
  - person not_looking_at dish
  - person holding dish

========================

2025-02-06 12:33:30,178 - DEBUG - 
=======PROMPT========

2025-02-06 12:33:30,178 - DEBUG - Given the sequence of scene graphs below, predict the next 2 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (30 frames, 25 to 281):
            
Frame 000025:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person beneath food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair


Frame 000026:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person beneath food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person leaning_on chair
  - person other_relationship chair


Frame 000031:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair


Frame 000074:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000077:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000090:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person leaning_on chair


Frame 000123:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person leaning_on chair
  - person other_relationship chair


Frame 000127:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000149:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person leaning_on chair
  - person other_relationship chair


Frame 000150:
Objects:
  - food
  - chair
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair


Frame 000171:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person leaning_on chair


Frame 000177:
Objects:
  - food
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000204:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish
  - person touching dish
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000208:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000209:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person touching dish
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000210:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person touching dish
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person leaning_on chair
  - person other_relationship chair


Frame 000217:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person touching dish
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000220:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person touching dish
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000223:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person not_looking_at food
  - person beneath food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish
  - person not_looking_at chair
  - person behind chair
  - person beneath chair
  - person sitting_on chair
  - person leaning_on chair
  - person other_relationship chair


Frame 000228:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person unsure food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000231:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person not_looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person other_relationship chair


Frame 000236:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish
  - person not_looking_at chair
  - person behind chair
  - person not_contacting chair


Frame 000243:
Objects:
  - food
  - dish
  - chair
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person in_front_of dish
  - person holding dish
  - person not_looking_at chair
  - person behind chair
  - person beneath chair
  - person not_contacting chair


Frame 000254:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person on_the_side_of food
  - person holding food
  - person looking_at dish
  - person behind dish
  - person on_the_side_of dish
  - person holding dish


Frame 000256:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person on_the_side_of dish
  - person holding dish


Frame 000262:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person on_the_side_of dish
  - person holding dish


Frame 000267:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person behind dish
  - person holding dish


Frame 000269:
Objects:
  - food
  - dish
Relationships:
  - person looking_at food
  - person in_front_of food
  - person holding food
  - person looking_at dish
  - person behind dish
  - person holding dish
  - person eating food


Frame 000276:
Objects:
  - dish
Relationships:
  - person looking_at dish
  - person holding dish


Frame 000281:
Objects:
  - dish
Relationships:
  - person not_looking_at dish
  - person holding dish

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 2 frames ([295, 298]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:33:30,179 - DEBUG - 
===================

2025-02-06 12:33:31,815 - DEBUG - 
=======BATCH PREDICTIONS========
2025-02-06 12:33:31,817 - DEBUG - 
Prediction for frame 295:
2025-02-06 12:33:31,817 - DEBUG - Objects:
2025-02-06 12:33:31,818 - DEBUG -   - dish
2025-02-06 12:33:31,818 - DEBUG - Relationships:
2025-02-06 12:33:31,818 - DEBUG -   - person holding dish
2025-02-06 12:33:31,818 - DEBUG -   - person looking_at dish
2025-02-06 12:33:31,818 - DEBUG - 
Prediction for frame 298:
2025-02-06 12:33:31,818 - DEBUG - Objects:
2025-02-06 12:33:31,818 - DEBUG -   - dish
2025-02-06 12:33:31,818 - DEBUG - Relationships:
2025-02-06 12:33:31,819 - DEBUG -   - person holding dish
2025-02-06 12:33:31,820 - DEBUG - Added 2 predictions to context
2025-02-06 12:33:31,820 - DEBUG - Context size now: 32 frames
2025-02-06 12:33:31,820 - DEBUG - ============================

2025-02-06 12:33:31,828 - INFO - Visualizing results...
2025-02-06 12:33:31,828 - DEBUG - Visualizing comparison for frame P76D1.mp4/000262.png
2025-02-06 12:33:32,123 - DEBUG - Visualizing comparison for frame P76D1.mp4/000267.png
2025-02-06 12:33:32,252 - DEBUG - Visualizing comparison for frame P76D1.mp4/000269.png
2025-02-06 12:33:32,349 - DEBUG - Visualizing comparison for frame P76D1.mp4/000276.png
2025-02-06 12:33:32,444 - DEBUG - Visualizing comparison for frame P76D1.mp4/000281.png
2025-02-06 12:33:32,606 - DEBUG - Visualizing comparison for frame P76D1.mp4/000295.png
2025-02-06 12:33:32,781 - DEBUG - Visualizing comparison for frame P76D1.mp4/000298.png
2025-02-06 12:33:32,886 - INFO - Completed processing video: P76D1.mp4
2025-02-06 12:33:32,886 - INFO - Waiting 60 seconds before next video...
2025-02-06 12:34:32,889 - INFO - 
==================================================
Processing video: WTU0I.mp4
==================================================
2025-02-06 12:34:32,913 - INFO - Processing video: WTU0I.mp4
2025-02-06 12:34:32,915 - INFO - Found 48 frames for video WTU0I.mp4
2025-02-06 12:34:32,930 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:32,930 - DEBUG - Found scene graph for frame WTU0I.mp4/000010.png
2025-02-06 12:34:32,932 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:32,932 - DEBUG - Found scene graph for frame WTU0I.mp4/000018.png
2025-02-06 12:34:32,932 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:32,932 - DEBUG - Found scene graph for frame WTU0I.mp4/000027.png
2025-02-06 12:34:32,933 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:32,933 - DEBUG - Found scene graph for frame WTU0I.mp4/000045.png
2025-02-06 12:34:32,933 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:32,934 - DEBUG - Found scene graph for frame WTU0I.mp4/000053.png
2025-02-06 12:34:32,935 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:32,936 - DEBUG - Found scene graph for frame WTU0I.mp4/000062.png
2025-02-06 12:34:32,940 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:32,940 - DEBUG - Found scene graph for frame WTU0I.mp4/000079.png
2025-02-06 12:34:32,942 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:32,942 - DEBUG - Found scene graph for frame WTU0I.mp4/000088.png
2025-02-06 12:34:32,942 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:32,943 - DEBUG - Found scene graph for frame WTU0I.mp4/000108.png
2025-02-06 12:34:32,944 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:32,944 - DEBUG - Found scene graph for frame WTU0I.mp4/000115.png
2025-02-06 12:34:32,946 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:32,946 - DEBUG - Found scene graph for frame WTU0I.mp4/000123.png
2025-02-06 12:34:32,947 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:32,947 - DEBUG - Found scene graph for frame WTU0I.mp4/000158.png
2025-02-06 12:34:32,948 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:32,948 - DEBUG - Found scene graph for frame WTU0I.mp4/000209.png
2025-02-06 12:34:32,949 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:32,949 - DEBUG - Found scene graph for frame WTU0I.mp4/000323.png
2025-02-06 12:34:32,949 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:32,950 - DEBUG - Found scene graph for frame WTU0I.mp4/000343.png
2025-02-06 12:34:32,951 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:32,951 - DEBUG - Found scene graph for frame WTU0I.mp4/000421.png
2025-02-06 12:34:32,952 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:32,952 - DEBUG - Found scene graph for frame WTU0I.mp4/000514.png
2025-02-06 12:34:32,953 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:32,954 - DEBUG - Found scene graph for frame WTU0I.mp4/000538.png
2025-02-06 12:34:32,955 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:32,956 - DEBUG - Found scene graph for frame WTU0I.mp4/000571.png
2025-02-06 12:34:32,956 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:32,957 - DEBUG - Found scene graph for frame WTU0I.mp4/000601.png
2025-02-06 12:34:32,958 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:32,958 - DEBUG - Found scene graph for frame WTU0I.mp4/000633.png
2025-02-06 12:34:32,959 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:32,960 - DEBUG - Found scene graph for frame WTU0I.mp4/000688.png
2025-02-06 12:34:32,961 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:32,962 - DEBUG - Found scene graph for frame WTU0I.mp4/000753.png
2025-02-06 12:34:32,963 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:32,963 - DEBUG - Found scene graph for frame WTU0I.mp4/000775.png
2025-02-06 12:34:32,964 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:32,964 - DEBUG - Found scene graph for frame WTU0I.mp4/000798.png
2025-02-06 12:34:32,966 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:32,966 - DEBUG - Found scene graph for frame WTU0I.mp4/000844.png
2025-02-06 12:34:32,967 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:32,967 - DEBUG - Found scene graph for frame WTU0I.mp4/000862.png
2025-02-06 12:34:32,968 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:32,968 - DEBUG - Found scene graph for frame WTU0I.mp4/000956.png
2025-02-06 12:34:32,969 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:34:32,969 - DEBUG - Found scene graph for frame WTU0I.mp4/000968.png
2025-02-06 12:34:32,970 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:34:32,971 - DEBUG - Found scene graph for frame WTU0I.mp4/001007.png
2025-02-06 12:34:32,972 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:34:32,972 - DEBUG - Found scene graph for frame WTU0I.mp4/001013.png
2025-02-06 12:34:32,973 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:34:32,974 - DEBUG - Found scene graph for frame WTU0I.mp4/001026.png
2025-02-06 12:34:32,975 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:34:32,975 - DEBUG - Found scene graph for frame WTU0I.mp4/001030.png
2025-02-06 12:34:32,976 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:34:32,976 - DEBUG - Found scene graph for frame WTU0I.mp4/001039.png
2025-02-06 12:34:32,977 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:32,978 - DEBUG - Found scene graph for frame WTU0I.mp4/001056.png
2025-02-06 12:34:32,979 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:34:32,979 - DEBUG - Found scene graph for frame WTU0I.mp4/001058.png
2025-02-06 12:34:32,979 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:32,979 - DEBUG - Found scene graph for frame WTU0I.mp4/001065.png
2025-02-06 12:34:32,979 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:32,979 - DEBUG - Found scene graph for frame WTU0I.mp4/001068.png
2025-02-06 12:34:32,980 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:32,980 - DEBUG - Found scene graph for frame WTU0I.mp4/001091.png
2025-02-06 12:34:32,980 - DEBUG - No valid objects found in annotations for frame WTU0I.mp4/001103.png
2025-02-06 12:34:32,981 - WARNING - No scene graph found for frame WTU0I.mp4/001103.png
2025-02-06 12:34:32,987 - DEBUG - No valid objects found in annotations for frame WTU0I.mp4/001106.png
2025-02-06 12:34:32,988 - WARNING - No scene graph found for frame WTU0I.mp4/001106.png
2025-02-06 12:34:32,988 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:34:32,989 - DEBUG - Found scene graph for frame WTU0I.mp4/001109.png
2025-02-06 12:34:32,990 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:34:32,991 - DEBUG - Found scene graph for frame WTU0I.mp4/001116.png
2025-02-06 12:34:32,991 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:32,992 - DEBUG - Found scene graph for frame WTU0I.mp4/001142.png
2025-02-06 12:34:32,993 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:32,993 - DEBUG - Found scene graph for frame WTU0I.mp4/001143.png
2025-02-06 12:34:32,994 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:34:32,994 - DEBUG - Found scene graph for frame WTU0I.mp4/001148.png
2025-02-06 12:34:32,999 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,000 - DEBUG - Found scene graph for frame WTU0I.mp4/001160.png
2025-02-06 12:34:33,001 - DEBUG - No valid objects found in annotations for frame WTU0I.mp4/001181.png
2025-02-06 12:34:33,001 - WARNING - No scene graph found for frame WTU0I.mp4/001181.png
2025-02-06 12:34:33,010 - INFO - Extracted 45 scene graphs
2025-02-06 12:34:33,010 - INFO - Split 45 graphs chronologically into 36 train and 9 test
2025-02-06 12:34:33,011 - DEBUG - Training frames: WTU0I.mp4/000010.png to WTU0I.mp4/001058.png
2025-02-06 12:34:33,011 - DEBUG - Testing frames: WTU0I.mp4/001065.png to WTU0I.mp4/001160.png
2025-02-06 12:34:33,017 - INFO - Generating 9 sequential predictions using closed vocabulary
2025-02-06 12:34:33,018 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:34:33,018 - DEBUG - Starting with 36 training frames
2025-02-06 12:34:33,020 - DEBUG - Frame numbers: [10, 18, 27, 45, 53, 62, 79, 88, 108, 115, 123, 158, 209, 323, 343, 421, 514, 538, 571, 601, 633, 688, 753, 775, 798, 844, 862, 956, 968, 1007, 1013, 1026, 1030, 1039, 1056, 1058]
2025-02-06 12:34:33,020 - DEBUG - ============================

2025-02-06 12:34:33,020 - INFO - Found 12 test frames to predict after frame 1058
2025-02-06 12:34:33,020 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:34:33,021 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:34:33,021 - DEBUG - Predicting 5 frames: [1065, 1068, 1091, 1103, 1106]
2025-02-06 12:34:33,022 - DEBUG - Context has 36 frames
2025-02-06 12:34:33,022 - DEBUG - Last 3 context frames: [1039, 1056, 1058]
2025-02-06 12:34:33,055 - DEBUG - 
=======CONTEXT DETAILS========

Frame 001039:
Objects:
  - book
  - chair
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person not_looking_at table
  - person in_front_of table
  - person touching table

Frame 001056:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table

Frame 001058:
Objects:
  - book
  - chair
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person not_looking_at table
  - person in_front_of table
  - person touching table

========================

2025-02-06 12:34:33,056 - DEBUG - 
=======PROMPT========

2025-02-06 12:34:33,056 - DEBUG - Given the sequence of scene graphs below, predict the next 5 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (36 frames, 10 to 1058):
            
Frame 000010:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table


Frame 000018:
Objects:
  - book
  - table
Relationships:
  - person not_looking_at book
  - person in_front_of book
  - person on_the_side_of book
  - person holding book
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table


Frame 000027:
Objects:
  - book
  - table
Relationships:
  - person not_looking_at book
  - person in_front_of book
  - person holding book
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table


Frame 000045:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000053:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000062:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000079:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000088:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000108:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person touching book
  - person holding book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000115:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000123:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000158:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000209:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000323:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table


Frame 000343:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000421:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000514:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000538:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000571:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000601:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000633:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000688:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person touching book
  - person holding book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000753:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person touching book
  - person holding book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000775:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000798:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000844:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table


Frame 000862:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000956:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 000968:
Objects:
  - book
  - chair
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person touching book
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 001007:
Objects:
  - book
  - chair
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 001013:
Objects:
  - book
  - chair
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 001026:
Objects:
  - book
  - chair
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person touching book
  - person holding book
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 001030:
Objects:
  - book
  - chair
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person touching book
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 001039:
Objects:
  - book
  - chair
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 001056:
Objects:
  - book
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person not_looking_at table
  - person in_front_of table
  - person touching table


Frame 001058:
Objects:
  - book
  - chair
  - table
Relationships:
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair
  - person not_looking_at table
  - person in_front_of table
  - person touching table

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 5 frames ([1065, 1068, 1091, 1103, 1106]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:34:33,117 - DEBUG - 
===================

2025-02-06 12:34:33,350 - ERROR - Prediction failed: 429 Resource has been exhausted (e.g. check quota).
2025-02-06 12:34:33,351 - ERROR - Failed to process video WTU0I.mp4: 429 Resource has been exhausted (e.g. check quota).
2025-02-06 12:34:33,351 - INFO - 
==================================================
Processing video: 16OAM.mp4
==================================================
2025-02-06 12:34:33,351 - INFO - Processing video: 16OAM.mp4
2025-02-06 12:34:33,352 - INFO - Found 10 frames for video 16OAM.mp4
2025-02-06 12:34:33,353 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,353 - DEBUG - Found scene graph for frame 16OAM.mp4/000141.png
2025-02-06 12:34:33,353 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,354 - DEBUG - Found scene graph for frame 16OAM.mp4/000270.png
2025-02-06 12:34:33,354 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,354 - DEBUG - Found scene graph for frame 16OAM.mp4/000399.png
2025-02-06 12:34:33,355 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,355 - DEBUG - Found scene graph for frame 16OAM.mp4/000528.png
2025-02-06 12:34:33,356 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:34:33,356 - DEBUG - Found scene graph for frame 16OAM.mp4/000599.png
2025-02-06 12:34:33,356 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,356 - DEBUG - Found scene graph for frame 16OAM.mp4/000626.png
2025-02-06 12:34:33,357 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,357 - DEBUG - Found scene graph for frame 16OAM.mp4/000653.png
2025-02-06 12:34:33,357 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,357 - DEBUG - Found scene graph for frame 16OAM.mp4/000657.png
2025-02-06 12:34:33,357 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,358 - DEBUG - Found scene graph for frame 16OAM.mp4/000680.png
2025-02-06 12:34:33,358 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,358 - DEBUG - Found scene graph for frame 16OAM.mp4/000707.png
2025-02-06 12:34:33,358 - INFO - Extracted 10 scene graphs
2025-02-06 12:34:33,358 - INFO - Split 10 graphs chronologically into 8 train and 2 test
2025-02-06 12:34:33,358 - DEBUG - Training frames: 16OAM.mp4/000141.png to 16OAM.mp4/000657.png
2025-02-06 12:34:33,359 - DEBUG - Testing frames: 16OAM.mp4/000680.png to 16OAM.mp4/000707.png
2025-02-06 12:34:33,359 - INFO - Generating 2 sequential predictions using closed vocabulary
2025-02-06 12:34:33,359 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:34:33,359 - DEBUG - Starting with 8 training frames
2025-02-06 12:34:33,359 - DEBUG - Frame numbers: [141, 270, 399, 528, 599, 626, 653, 657]
2025-02-06 12:34:33,359 - DEBUG - ============================

2025-02-06 12:34:33,360 - INFO - Found 2 test frames to predict after frame 657
2025-02-06 12:34:33,360 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:34:33,360 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:34:33,360 - DEBUG - Predicting 2 frames: [680, 707]
2025-02-06 12:34:33,360 - DEBUG - Context has 8 frames
2025-02-06 12:34:33,360 - DEBUG - Last 3 context frames: [626, 653, 657]
2025-02-06 12:34:33,369 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000626:
Objects:
  - laptop
Relationships:
  - person not_looking_at laptop
  - person in_front_of laptop
  - person touching laptop

Frame 000653:
Objects:
  - laptop
Relationships:
  - person looking_at laptop
  - person in_front_of laptop
  - person touching laptop

Frame 000657:
Objects:
  - laptop
Relationships:
  - person looking_at laptop
  - person in_front_of laptop
  - person touching laptop

========================

2025-02-06 12:34:33,370 - DEBUG - 
=======PROMPT========

2025-02-06 12:34:33,370 - DEBUG - Given the sequence of scene graphs below, predict the next 2 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (8 frames, 141 to 657):
            
Frame 000141:
Objects:
  - laptop
Relationships:
  - person looking_at laptop
  - person in_front_of laptop
  - person holding laptop


Frame 000270:
Objects:
  - laptop
Relationships:
  - person looking_at laptop
  - person in_front_of laptop
  - person touching laptop


Frame 000399:
Objects:
  - laptop
Relationships:
  - person looking_at laptop
  - person in_front_of laptop
  - person touching laptop


Frame 000528:
Objects:
  - laptop
Relationships:
  - person looking_at laptop
  - person in_front_of laptop
  - person touching laptop


Frame 000599:
Objects:
  - laptop
Relationships:
  - person looking_at laptop
  - person in_front_of laptop
  - person touching laptop
  - person holding laptop


Frame 000626:
Objects:
  - laptop
Relationships:
  - person not_looking_at laptop
  - person in_front_of laptop
  - person touching laptop


Frame 000653:
Objects:
  - laptop
Relationships:
  - person looking_at laptop
  - person in_front_of laptop
  - person touching laptop


Frame 000657:
Objects:
  - laptop
Relationships:
  - person looking_at laptop
  - person in_front_of laptop
  - person touching laptop

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 2 frames ([680, 707]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:34:33,370 - DEBUG - 
===================

2025-02-06 12:34:33,488 - ERROR - Prediction failed: 429 Resource has been exhausted (e.g. check quota).
2025-02-06 12:34:33,488 - ERROR - Failed to process video 16OAM.mp4: 429 Resource has been exhausted (e.g. check quota).
2025-02-06 12:34:33,488 - INFO - 
==================================================
Processing video: F99PM.mp4
==================================================
2025-02-06 12:34:33,489 - INFO - Processing video: F99PM.mp4
2025-02-06 12:34:33,490 - INFO - Found 28 frames for video F99PM.mp4
2025-02-06 12:34:33,493 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,493 - DEBUG - Found scene graph for frame F99PM.mp4/000093.png
2025-02-06 12:34:33,493 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,493 - DEBUG - Found scene graph for frame F99PM.mp4/000107.png
2025-02-06 12:34:33,494 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,494 - DEBUG - Found scene graph for frame F99PM.mp4/000160.png
2025-02-06 12:34:33,494 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,494 - DEBUG - Found scene graph for frame F99PM.mp4/000231.png
2025-02-06 12:34:33,496 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,496 - DEBUG - Found scene graph for frame F99PM.mp4/000234.png
2025-02-06 12:34:33,496 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,497 - DEBUG - Found scene graph for frame F99PM.mp4/000277.png
2025-02-06 12:34:33,498 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,498 - DEBUG - Found scene graph for frame F99PM.mp4/000302.png
2025-02-06 12:34:33,499 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,499 - DEBUG - Found scene graph for frame F99PM.mp4/000361.png
2025-02-06 12:34:33,501 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,502 - DEBUG - Found scene graph for frame F99PM.mp4/000373.png
2025-02-06 12:34:33,502 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,502 - DEBUG - Found scene graph for frame F99PM.mp4/000444.png
2025-02-06 12:34:33,503 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,503 - DEBUG - Found scene graph for frame F99PM.mp4/000461.png
2025-02-06 12:34:33,503 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,504 - DEBUG - Found scene graph for frame F99PM.mp4/000488.png
2025-02-06 12:34:33,504 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,504 - DEBUG - Found scene graph for frame F99PM.mp4/000601.png
2025-02-06 12:34:33,505 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,506 - DEBUG - Found scene graph for frame F99PM.mp4/000615.png
2025-02-06 12:34:33,506 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:33,506 - DEBUG - Found scene graph for frame F99PM.mp4/000638.png
2025-02-06 12:34:33,507 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:33,507 - DEBUG - Found scene graph for frame F99PM.mp4/000645.png
2025-02-06 12:34:33,509 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:34:33,509 - DEBUG - Found scene graph for frame F99PM.mp4/000674.png
2025-02-06 12:34:33,510 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,510 - DEBUG - Found scene graph for frame F99PM.mp4/000698.png
2025-02-06 12:34:33,510 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,510 - DEBUG - Found scene graph for frame F99PM.mp4/000710.png
2025-02-06 12:34:33,511 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,511 - DEBUG - Found scene graph for frame F99PM.mp4/000747.png
2025-02-06 12:34:33,512 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:33,513 - DEBUG - Found scene graph for frame F99PM.mp4/000770.png
2025-02-06 12:34:33,514 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,514 - DEBUG - Found scene graph for frame F99PM.mp4/000797.png
2025-02-06 12:34:33,515 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,515 - DEBUG - Found scene graph for frame F99PM.mp4/000801.png
2025-02-06 12:34:33,515 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,515 - DEBUG - Found scene graph for frame F99PM.mp4/000829.png
2025-02-06 12:34:33,517 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,517 - DEBUG - Found scene graph for frame F99PM.mp4/000833.png
2025-02-06 12:34:33,518 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,518 - DEBUG - Found scene graph for frame F99PM.mp4/000847.png
2025-02-06 12:34:33,518 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,519 - DEBUG - Found scene graph for frame F99PM.mp4/000865.png
2025-02-06 12:34:33,519 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,519 - DEBUG - Found scene graph for frame F99PM.mp4/000896.png
2025-02-06 12:34:33,519 - INFO - Extracted 28 scene graphs
2025-02-06 12:34:33,520 - INFO - Split 28 graphs chronologically into 22 train and 6 test
2025-02-06 12:34:33,520 - DEBUG - Training frames: F99PM.mp4/000093.png to F99PM.mp4/000797.png
2025-02-06 12:34:33,520 - DEBUG - Testing frames: F99PM.mp4/000801.png to F99PM.mp4/000896.png
2025-02-06 12:34:33,520 - INFO - Generating 6 sequential predictions using closed vocabulary
2025-02-06 12:34:33,520 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:34:33,521 - DEBUG - Starting with 22 training frames
2025-02-06 12:34:33,521 - DEBUG - Frame numbers: [93, 107, 160, 231, 234, 277, 302, 361, 373, 444, 461, 488, 601, 615, 638, 645, 674, 698, 710, 747, 770, 797]
2025-02-06 12:34:33,521 - DEBUG - ============================

2025-02-06 12:34:33,521 - INFO - Found 6 test frames to predict after frame 797
2025-02-06 12:34:33,521 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:34:33,521 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:34:33,522 - DEBUG - Predicting 5 frames: [801, 829, 833, 847, 865]
2025-02-06 12:34:33,522 - DEBUG - Context has 22 frames
2025-02-06 12:34:33,522 - DEBUG - Last 3 context frames: [747, 770, 797]
2025-02-06 12:34:33,549 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000747:
Objects:
  - closet/cabinet
  - chair
Relationships:
  - person unsure closet/cabinet
  - person in_front_of closet/cabinet
  - person holding closet/cabinet
  - person unsure chair
  - person beneath chair
  - person sitting_on chair

Frame 000770:
Objects:
  - closet/cabinet
  - chair
Relationships:
  - person looking_at closet/cabinet
  - person in_front_of closet/cabinet
  - person touching closet/cabinet
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair

Frame 000797:
Objects:
  - closet/cabinet
  - chair
Relationships:
  - person unsure closet/cabinet
  - person in_front_of closet/cabinet
  - person holding closet/cabinet
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair

========================

2025-02-06 12:34:33,549 - DEBUG - 
=======PROMPT========

2025-02-06 12:34:33,550 - DEBUG - Given the sequence of scene graphs below, predict the next 5 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (22 frames, 93 to 797):
            
Frame 000093:
Objects:
  - floor
  - chair
Relationships:
  - person unsure floor
  - person beneath floor
  - person not_contacting floor
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000107:
Objects:
  - floor
  - chair
Relationships:
  - person unsure floor
  - person beneath floor
  - person not_contacting floor
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000160:
Objects:
  - floor
  - chair
Relationships:
  - person not_looking_at floor
  - person beneath floor
  - person sitting_on floor
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000231:
Objects:
  - floor
  - chair
Relationships:
  - person not_looking_at floor
  - person beneath floor
  - person sitting_on floor
  - person not_looking_at chair
  - person in_front_of chair
  - person touching chair


Frame 000234:
Objects:
  - floor
  - chair
Relationships:
  - person not_looking_at floor
  - person beneath floor
  - person sitting_on floor
  - person not_looking_at chair
  - person in_front_of chair
  - person holding chair


Frame 000277:
Objects:
  - floor
  - chair
Relationships:
  - person not_looking_at floor
  - person beneath floor
  - person sitting_on floor
  - person looking_at chair
  - person in_front_of chair
  - person touching chair


Frame 000302:
Objects:
  - floor
  - chair
Relationships:
  - person not_looking_at floor
  - person beneath floor
  - person sitting_on floor
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000361:
Objects:
  - floor
  - chair
Relationships:
  - person looking_at floor
  - person beneath floor
  - person sitting_on floor
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000373:
Objects:
  - floor
  - chair
Relationships:
  - person not_looking_at floor
  - person beneath floor
  - person sitting_on floor
  - person looking_at chair
  - person in_front_of chair
  - person touching chair


Frame 000444:
Objects:
  - floor
  - chair
Relationships:
  - person not_looking_at floor
  - person beneath floor
  - person sitting_on floor
  - person unsure chair
  - person beneath chair
  - person sitting_on chair


Frame 000461:
Objects:
  - floor
  - chair
Relationships:
  - person not_looking_at floor
  - person beneath floor
  - person sitting_on floor
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000488:
Objects:
  - floor
  - chair
Relationships:
  - person not_looking_at floor
  - person beneath floor
  - person sitting_on floor
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000601:
Objects:
  - floor
  - chair
Relationships:
  - person not_looking_at floor
  - person beneath floor
  - person sitting_on floor
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000615:
Objects:
  - floor
  - chair
Relationships:
  - person not_looking_at floor
  - person beneath floor
  - person sitting_on floor
  - person looking_at chair
  - person in_front_of chair
  - person holding chair


Frame 000638:
Objects:
  - floor
  - chair
Relationships:
  - person unsure floor
  - person beneath floor
  - person sitting_on floor
  - person touching floor
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000645:
Objects:
  - floor
  - chair
Relationships:
  - person looking_at floor
  - person beneath floor
  - person touching floor
  - person sitting_on floor
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000674:
Objects:
  - closet/cabinet
  - floor
  - chair
Relationships:
  - person not_looking_at closet/cabinet
  - person in_front_of closet/cabinet
  - person not_contacting closet/cabinet
  - person looking_at floor
  - person beneath floor
  - person in_front_of floor
  - person standing_on floor
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000698:
Objects:
  - closet/cabinet
  - chair
Relationships:
  - person not_looking_at closet/cabinet
  - person in_front_of closet/cabinet
  - person not_contacting closet/cabinet
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000710:
Objects:
  - closet/cabinet
  - chair
Relationships:
  - person looking_at closet/cabinet
  - person in_front_of closet/cabinet
  - person not_contacting closet/cabinet
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000747:
Objects:
  - closet/cabinet
  - chair
Relationships:
  - person unsure closet/cabinet
  - person in_front_of closet/cabinet
  - person holding closet/cabinet
  - person unsure chair
  - person beneath chair
  - person sitting_on chair


Frame 000770:
Objects:
  - closet/cabinet
  - chair
Relationships:
  - person looking_at closet/cabinet
  - person in_front_of closet/cabinet
  - person touching closet/cabinet
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair


Frame 000797:
Objects:
  - closet/cabinet
  - chair
Relationships:
  - person unsure closet/cabinet
  - person in_front_of closet/cabinet
  - person holding closet/cabinet
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 5 frames ([801, 829, 833, 847, 865]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:34:33,551 - DEBUG - 
===================

2025-02-06 12:34:33,635 - ERROR - Prediction failed: 429 Resource has been exhausted (e.g. check quota).
2025-02-06 12:34:33,636 - ERROR - Failed to process video F99PM.mp4: 429 Resource has been exhausted (e.g. check quota).
2025-02-06 12:34:33,636 - INFO - 
==================================================
Processing video: ANZ0S.mp4
==================================================
2025-02-06 12:34:33,636 - INFO - Processing video: ANZ0S.mp4
2025-02-06 12:34:33,639 - INFO - Found 20 frames for video ANZ0S.mp4
2025-02-06 12:34:33,640 - DEBUG - No valid objects found in annotations for frame ANZ0S.mp4/000021.png
2025-02-06 12:34:33,641 - WARNING - No scene graph found for frame ANZ0S.mp4/000021.png
2025-02-06 12:34:33,642 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,643 - DEBUG - Found scene graph for frame ANZ0S.mp4/000061.png
2025-02-06 12:34:33,643 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,643 - DEBUG - Found scene graph for frame ANZ0S.mp4/000101.png
2025-02-06 12:34:33,643 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,644 - DEBUG - Found scene graph for frame ANZ0S.mp4/000140.png
2025-02-06 12:34:33,644 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,644 - DEBUG - Found scene graph for frame ANZ0S.mp4/000180.png
2025-02-06 12:34:33,646 - DEBUG - No valid objects found in annotations for frame ANZ0S.mp4/000335.png
2025-02-06 12:34:33,647 - WARNING - No scene graph found for frame ANZ0S.mp4/000335.png
2025-02-06 12:34:33,648 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:34:33,648 - DEBUG - Found scene graph for frame ANZ0S.mp4/000376.png
2025-02-06 12:34:33,648 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:33,648 - DEBUG - Found scene graph for frame ANZ0S.mp4/000417.png
2025-02-06 12:34:33,649 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:33,650 - DEBUG - Found scene graph for frame ANZ0S.mp4/000431.png
2025-02-06 12:34:33,651 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,652 - DEBUG - Found scene graph for frame ANZ0S.mp4/000458.png
2025-02-06 12:34:33,652 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,652 - DEBUG - Found scene graph for frame ANZ0S.mp4/000467.png
2025-02-06 12:34:33,653 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,653 - DEBUG - Found scene graph for frame ANZ0S.mp4/000499.png
2025-02-06 12:34:33,654 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:33,654 - DEBUG - Found scene graph for frame ANZ0S.mp4/000503.png
2025-02-06 12:34:33,656 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,657 - DEBUG - Found scene graph for frame ANZ0S.mp4/000538.png
2025-02-06 12:34:33,658 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,659 - DEBUG - Found scene graph for frame ANZ0S.mp4/000574.png
2025-02-06 12:34:33,660 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,660 - DEBUG - Found scene graph for frame ANZ0S.mp4/000577.png
2025-02-06 12:34:33,661 - DEBUG - Extracted scene graph with 1 objects and 5 relationships
2025-02-06 12:34:33,662 - DEBUG - Found scene graph for frame ANZ0S.mp4/000633.png
2025-02-06 12:34:33,670 - DEBUG - No valid objects found in annotations for frame ANZ0S.mp4/000689.png
2025-02-06 12:34:33,671 - WARNING - No scene graph found for frame ANZ0S.mp4/000689.png
2025-02-06 12:34:33,672 - DEBUG - Extracted scene graph with 1 objects and 5 relationships
2025-02-06 12:34:33,672 - DEBUG - Found scene graph for frame ANZ0S.mp4/000745.png
2025-02-06 12:34:33,672 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:34:33,672 - DEBUG - Found scene graph for frame ANZ0S.mp4/000801.png
2025-02-06 12:34:33,674 - INFO - Extracted 17 scene graphs
2025-02-06 12:34:33,675 - INFO - Split 17 graphs chronologically into 13 train and 4 test
2025-02-06 12:34:33,675 - DEBUG - Training frames: ANZ0S.mp4/000061.png to ANZ0S.mp4/000574.png
2025-02-06 12:34:33,675 - DEBUG - Testing frames: ANZ0S.mp4/000577.png to ANZ0S.mp4/000801.png
2025-02-06 12:34:33,675 - INFO - Generating 4 sequential predictions using closed vocabulary
2025-02-06 12:34:33,676 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:34:33,676 - DEBUG - Starting with 13 training frames
2025-02-06 12:34:33,676 - DEBUG - Frame numbers: [61, 101, 140, 180, 376, 417, 431, 458, 467, 499, 503, 538, 574]
2025-02-06 12:34:33,676 - DEBUG - ============================

2025-02-06 12:34:33,676 - INFO - Found 5 test frames to predict after frame 574
2025-02-06 12:34:33,676 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:34:33,686 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:34:33,686 - DEBUG - Predicting 4 frames: [577, 633, 689, 745]
2025-02-06 12:34:33,686 - DEBUG - Context has 13 frames
2025-02-06 12:34:33,687 - DEBUG - Last 3 context frames: [503, 538, 574]
2025-02-06 12:34:33,705 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000503:
Objects:
  - refrigerator
  - cup/glass/bottle
Relationships:
  - person looking_at refrigerator
  - person in_front_of refrigerator
  - person touching refrigerator
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle

Frame 000538:
Objects:
  - refrigerator
Relationships:
  - person not_looking_at refrigerator
  - person behind refrigerator
  - person not_contacting refrigerator

Frame 000574:
Objects:
  - refrigerator
Relationships:
  - person not_looking_at refrigerator
  - person behind refrigerator
  - person not_contacting refrigerator

========================

2025-02-06 12:34:33,706 - DEBUG - 
=======PROMPT========

2025-02-06 12:34:33,706 - DEBUG - Given the sequence of scene graphs below, predict the next 4 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (13 frames, 61 to 574):
            
Frame 000061:
Objects:
  - refrigerator
Relationships:
  - person looking_at refrigerator
  - person in_front_of refrigerator
  - person not_contacting refrigerator


Frame 000101:
Objects:
  - refrigerator
Relationships:
  - person looking_at refrigerator
  - person in_front_of refrigerator
  - person holding refrigerator


Frame 000140:
Objects:
  - refrigerator
Relationships:
  - person looking_at refrigerator
  - person in_front_of refrigerator
  - person touching refrigerator


Frame 000180:
Objects:
  - refrigerator
Relationships:
  - person looking_at refrigerator
  - person in_front_of refrigerator
  - person touching refrigerator


Frame 000376:
Objects:
  - cup/glass/bottle
Relationships:
  - person looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle
  - person touching cup/glass/bottle


Frame 000417:
Objects:
  - refrigerator
  - cup/glass/bottle
Relationships:
  - person looking_at refrigerator
  - person in_front_of refrigerator
  - person not_contacting refrigerator
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle
  - person drinking_from cup/glass/bottle


Frame 000431:
Objects:
  - refrigerator
  - cup/glass/bottle
Relationships:
  - person not_looking_at refrigerator
  - person in_front_of refrigerator
  - person not_contacting refrigerator
  - person looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle
  - person drinking_from cup/glass/bottle


Frame 000458:
Objects:
  - refrigerator
  - cup/glass/bottle
Relationships:
  - person looking_at refrigerator
  - person in_front_of refrigerator
  - person not_contacting refrigerator
  - person looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle


Frame 000467:
Objects:
  - refrigerator
  - cup/glass/bottle
Relationships:
  - person looking_at refrigerator
  - person in_front_of refrigerator
  - person not_contacting refrigerator
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle


Frame 000499:
Objects:
  - refrigerator
  - cup/glass/bottle
Relationships:
  - person looking_at refrigerator
  - person in_front_of refrigerator
  - person touching refrigerator
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle


Frame 000503:
Objects:
  - refrigerator
  - cup/glass/bottle
Relationships:
  - person looking_at refrigerator
  - person in_front_of refrigerator
  - person touching refrigerator
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle


Frame 000538:
Objects:
  - refrigerator
Relationships:
  - person not_looking_at refrigerator
  - person behind refrigerator
  - person not_contacting refrigerator


Frame 000574:
Objects:
  - refrigerator
Relationships:
  - person not_looking_at refrigerator
  - person behind refrigerator
  - person not_contacting refrigerator

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 4 frames ([577, 633, 689, 745]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:34:33,710 - DEBUG - 
===================

2025-02-06 12:34:33,802 - ERROR - Prediction failed: 429 Resource has been exhausted (e.g. check quota).
2025-02-06 12:34:33,802 - ERROR - Failed to process video ANZ0S.mp4: 429 Resource has been exhausted (e.g. check quota).
2025-02-06 12:34:33,802 - INFO - 
==================================================
Processing video: G4E4S.mp4
==================================================
2025-02-06 12:34:33,803 - INFO - Processing video: G4E4S.mp4
2025-02-06 12:34:33,804 - INFO - Found 42 frames for video G4E4S.mp4
2025-02-06 12:34:33,805 - DEBUG - No valid objects found in annotations for frame G4E4S.mp4/000153.png
2025-02-06 12:34:33,805 - WARNING - No scene graph found for frame G4E4S.mp4/000153.png
2025-02-06 12:34:33,805 - DEBUG - No valid objects found in annotations for frame G4E4S.mp4/000157.png
2025-02-06 12:34:33,805 - WARNING - No scene graph found for frame G4E4S.mp4/000157.png
2025-02-06 12:34:33,805 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,805 - DEBUG - Found scene graph for frame G4E4S.mp4/000186.png
2025-02-06 12:34:33,806 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,806 - DEBUG - Found scene graph for frame G4E4S.mp4/000193.png
2025-02-06 12:34:33,806 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,806 - DEBUG - Found scene graph for frame G4E4S.mp4/000215.png
2025-02-06 12:34:33,806 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,806 - DEBUG - Found scene graph for frame G4E4S.mp4/000233.png
2025-02-06 12:34:33,807 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,807 - DEBUG - Found scene graph for frame G4E4S.mp4/000244.png
2025-02-06 12:34:33,807 - DEBUG - No valid objects found in annotations for frame G4E4S.mp4/000273.png
2025-02-06 12:34:33,807 - WARNING - No scene graph found for frame G4E4S.mp4/000273.png
2025-02-06 12:34:33,808 - DEBUG - No valid objects found in annotations for frame G4E4S.mp4/000313.png
2025-02-06 12:34:33,808 - WARNING - No scene graph found for frame G4E4S.mp4/000313.png
2025-02-06 12:34:33,809 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:34:33,809 - DEBUG - Found scene graph for frame G4E4S.mp4/000527.png
2025-02-06 12:34:33,809 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:34:33,809 - DEBUG - Found scene graph for frame G4E4S.mp4/000529.png
2025-02-06 12:34:33,809 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:34:33,810 - DEBUG - Found scene graph for frame G4E4S.mp4/000553.png
2025-02-06 12:34:33,810 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:34:33,810 - DEBUG - Found scene graph for frame G4E4S.mp4/000556.png
2025-02-06 12:34:33,810 - DEBUG - Extracted scene graph with 3 objects and 14 relationships
2025-02-06 12:34:33,810 - DEBUG - Found scene graph for frame G4E4S.mp4/000589.png
2025-02-06 12:34:33,810 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:34:33,811 - DEBUG - Found scene graph for frame G4E4S.mp4/000594.png
2025-02-06 12:34:33,811 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:34:33,811 - DEBUG - Found scene graph for frame G4E4S.mp4/000615.png
2025-02-06 12:34:33,811 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:34:33,811 - DEBUG - Found scene graph for frame G4E4S.mp4/000638.png
2025-02-06 12:34:33,812 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:34:33,812 - DEBUG - Found scene graph for frame G4E4S.mp4/000651.png
2025-02-06 12:34:33,813 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:34:33,813 - DEBUG - Found scene graph for frame G4E4S.mp4/000660.png
2025-02-06 12:34:33,813 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:34:33,813 - DEBUG - Found scene graph for frame G4E4S.mp4/000678.png
2025-02-06 12:34:33,814 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:34:33,814 - DEBUG - Found scene graph for frame G4E4S.mp4/000713.png
2025-02-06 12:34:33,815 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:34:33,815 - DEBUG - Found scene graph for frame G4E4S.mp4/000719.png
2025-02-06 12:34:33,815 - DEBUG - Extracted scene graph with 3 objects and 13 relationships
2025-02-06 12:34:33,815 - DEBUG - Found scene graph for frame G4E4S.mp4/000726.png
2025-02-06 12:34:33,816 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:34:33,816 - DEBUG - Found scene graph for frame G4E4S.mp4/000736.png
2025-02-06 12:34:33,816 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:34:33,816 - DEBUG - Found scene graph for frame G4E4S.mp4/000740.png
2025-02-06 12:34:33,817 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:34:33,817 - DEBUG - Found scene graph for frame G4E4S.mp4/000761.png
2025-02-06 12:34:33,817 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:34:33,817 - DEBUG - Found scene graph for frame G4E4S.mp4/000775.png
2025-02-06 12:34:33,817 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:34:33,817 - DEBUG - Found scene graph for frame G4E4S.mp4/000787.png
2025-02-06 12:34:33,818 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:34:33,818 - DEBUG - Found scene graph for frame G4E4S.mp4/000791.png
2025-02-06 12:34:33,818 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:34:33,818 - DEBUG - Found scene graph for frame G4E4S.mp4/000801.png
2025-02-06 12:34:33,818 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:34:33,819 - DEBUG - Found scene graph for frame G4E4S.mp4/000802.png
2025-02-06 12:34:33,819 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:33,819 - DEBUG - Found scene graph for frame G4E4S.mp4/000813.png
2025-02-06 12:34:33,819 - DEBUG - No valid objects found in annotations for frame G4E4S.mp4/001085.png
2025-02-06 12:34:33,819 - WARNING - No scene graph found for frame G4E4S.mp4/001085.png
2025-02-06 12:34:33,820 - DEBUG - No valid objects found in annotations for frame G4E4S.mp4/001227.png
2025-02-06 12:34:33,820 - WARNING - No scene graph found for frame G4E4S.mp4/001227.png
2025-02-06 12:34:33,820 - DEBUG - No valid objects found in annotations for frame G4E4S.mp4/001369.png
2025-02-06 12:34:33,820 - WARNING - No scene graph found for frame G4E4S.mp4/001369.png
2025-02-06 12:34:33,821 - DEBUG - No valid objects found in annotations for frame G4E4S.mp4/001510.png
2025-02-06 12:34:33,821 - WARNING - No scene graph found for frame G4E4S.mp4/001510.png
2025-02-06 12:34:33,821 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:34:33,821 - DEBUG - Found scene graph for frame G4E4S.mp4/001615.png
2025-02-06 12:34:33,821 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,822 - DEBUG - Found scene graph for frame G4E4S.mp4/001652.png
2025-02-06 12:34:33,822 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,822 - DEBUG - Found scene graph for frame G4E4S.mp4/001656.png
2025-02-06 12:34:33,822 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,822 - DEBUG - Found scene graph for frame G4E4S.mp4/001697.png
2025-02-06 12:34:33,823 - DEBUG - No valid objects found in annotations for frame G4E4S.mp4/001737.png
2025-02-06 12:34:33,823 - WARNING - No scene graph found for frame G4E4S.mp4/001737.png
2025-02-06 12:34:33,824 - DEBUG - No valid objects found in annotations for frame G4E4S.mp4/001778.png
2025-02-06 12:34:33,824 - WARNING - No scene graph found for frame G4E4S.mp4/001778.png
2025-02-06 12:34:33,824 - INFO - Extracted 32 scene graphs
2025-02-06 12:34:33,824 - INFO - Split 32 graphs chronologically into 25 train and 7 test
2025-02-06 12:34:33,824 - DEBUG - Training frames: G4E4S.mp4/000186.png to G4E4S.mp4/000791.png
2025-02-06 12:34:33,824 - DEBUG - Testing frames: G4E4S.mp4/000801.png to G4E4S.mp4/001697.png
2025-02-06 12:34:33,825 - INFO - Generating 7 sequential predictions using closed vocabulary
2025-02-06 12:34:33,825 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:34:33,825 - DEBUG - Starting with 25 training frames
2025-02-06 12:34:33,825 - DEBUG - Frame numbers: [186, 193, 215, 233, 244, 527, 529, 553, 556, 589, 594, 615, 638, 651, 660, 678, 713, 719, 726, 736, 740, 761, 775, 787, 791]
2025-02-06 12:34:33,825 - DEBUG - ============================

2025-02-06 12:34:33,825 - INFO - Found 13 test frames to predict after frame 791
2025-02-06 12:34:33,825 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:34:33,826 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:34:33,826 - DEBUG - Predicting 5 frames: [801, 802, 813, 1085, 1227]
2025-02-06 12:34:33,826 - DEBUG - Context has 25 frames
2025-02-06 12:34:33,826 - DEBUG - Last 3 context frames: [775, 787, 791]
2025-02-06 12:34:33,848 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000775:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person not_contacting shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person other_relationship chair

Frame 000787:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person on_the_side_of shoe
  - person not_contacting shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person behind chair
  - person not_contacting chair

Frame 000791:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person in_front_of shoe
  - person not_contacting shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person behind chair
  - person not_contacting chair

========================

2025-02-06 12:34:33,849 - DEBUG - 
=======PROMPT========

2025-02-06 12:34:33,850 - DEBUG - Given the sequence of scene graphs below, predict the next 5 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (25 frames, 186 to 791):
            
Frame 000186:
Objects:
  - clothes
Relationships:
  - person unsure clothes
  - person in_front_of clothes
  - person holding clothes


Frame 000193:
Objects:
  - clothes
Relationships:
  - person looking_at clothes
  - person in_front_of clothes
  - person holding clothes


Frame 000215:
Objects:
  - clothes
Relationships:
  - person unsure clothes
  - person in_front_of clothes
  - person holding clothes


Frame 000233:
Objects:
  - clothes
Relationships:
  - person not_looking_at clothes
  - person in_front_of clothes
  - person holding clothes


Frame 000244:
Objects:
  - clothes
Relationships:
  - person unsure clothes
  - person in_front_of clothes
  - person holding clothes


Frame 000527:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person wearing shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person other_relationship chair


Frame 000529:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person wearing shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person other_relationship chair


Frame 000553:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person in_front_of shoe
  - person wearing shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person behind chair
  - person beneath chair
  - person sitting_on chair
  - person leaning_on chair


Frame 000556:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person in_front_of shoe
  - person wearing shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person on_the_side_of chair
  - person sitting_on chair


Frame 000589:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person in_front_of shoe
  - person beneath shoe
  - person holding shoe
  - person touching shoe
  - person wearing shoe
  - person not_contacting shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair


Frame 000594:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person in_front_of shoe
  - person beneath shoe
  - person holding shoe
  - person wearing shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person unsure chair
  - person beneath chair
  - person sitting_on chair


Frame 000615:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person looking_at shoe
  - person beneath shoe
  - person in_front_of shoe
  - person holding shoe
  - person wearing shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person on_the_side_of chair
  - person sitting_on chair


Frame 000638:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person looking_at shoe
  - person beneath shoe
  - person in_front_of shoe
  - person wearing shoe
  - person holding shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person on_the_side_of chair
  - person sitting_on chair


Frame 000651:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person looking_at shoe
  - person beneath shoe
  - person in_front_of shoe
  - person holding shoe
  - person wearing shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair


Frame 000660:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person in_front_of shoe
  - person wearing shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person touching table
  - person not_looking_at chair
  - person beneath chair
  - person on_the_side_of chair
  - person sitting_on chair


Frame 000678:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person in_front_of shoe
  - person holding shoe
  - person wearing shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person on_the_side_of chair
  - person sitting_on chair


Frame 000713:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person in_front_of shoe
  - person holding shoe
  - person wearing shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person on_the_side_of chair
  - person sitting_on chair


Frame 000719:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person in_front_of shoe
  - person holding shoe
  - person wearing shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person behind chair
  - person sitting_on chair


Frame 000726:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person above shoe
  - person beneath shoe
  - person on_the_side_of shoe
  - person touching shoe
  - person not_contacting shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person on_the_side_of chair
  - person sitting_on chair


Frame 000736:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person on_the_side_of shoe
  - person not_contacting shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000740:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person in_front_of shoe
  - person not_contacting shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person on_the_side_of chair
  - person sitting_on chair


Frame 000761:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person looking_at shoe
  - person beneath shoe
  - person on_the_side_of shoe
  - person touching shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person sitting_on chair


Frame 000775:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person not_contacting shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person beneath chair
  - person other_relationship chair


Frame 000787:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person beneath shoe
  - person on_the_side_of shoe
  - person not_contacting shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person behind chair
  - person not_contacting chair


Frame 000791:
Objects:
  - shoe
  - table
  - chair
Relationships:
  - person unsure shoe
  - person in_front_of shoe
  - person not_contacting shoe
  - person not_looking_at table
  - person on_the_side_of table
  - person not_contacting table
  - person not_looking_at chair
  - person behind chair
  - person not_contacting chair

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 5 frames ([801, 802, 813, 1085, 1227]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:34:33,850 - DEBUG - 
===================

2025-02-06 12:34:33,935 - ERROR - Prediction failed: 429 Resource has been exhausted (e.g. check quota).
2025-02-06 12:34:33,936 - ERROR - Failed to process video G4E4S.mp4: 429 Resource has been exhausted (e.g. check quota).
2025-02-06 12:34:33,936 - INFO - 
==================================================
Processing video: NYHD7.mp4
==================================================
2025-02-06 12:34:33,936 - INFO - Processing video: NYHD7.mp4
2025-02-06 12:34:33,937 - INFO - Found 39 frames for video NYHD7.mp4
2025-02-06 12:34:33,938 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,938 - DEBUG - Found scene graph for frame NYHD7.mp4/000015.png
2025-02-06 12:34:33,938 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,938 - DEBUG - Found scene graph for frame NYHD7.mp4/000043.png
2025-02-06 12:34:33,938 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,938 - DEBUG - Found scene graph for frame NYHD7.mp4/000071.png
2025-02-06 12:34:33,939 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,939 - DEBUG - Found scene graph for frame NYHD7.mp4/000082.png
2025-02-06 12:34:33,939 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,940 - DEBUG - Found scene graph for frame NYHD7.mp4/000099.png
2025-02-06 12:34:33,940 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,940 - DEBUG - Found scene graph for frame NYHD7.mp4/000127.png
2025-02-06 12:34:33,941 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,941 - DEBUG - Found scene graph for frame NYHD7.mp4/000161.png
2025-02-06 12:34:33,942 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,942 - DEBUG - Found scene graph for frame NYHD7.mp4/000169.png
2025-02-06 12:34:33,942 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,942 - DEBUG - Found scene graph for frame NYHD7.mp4/000192.png
2025-02-06 12:34:33,942 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,942 - DEBUG - Found scene graph for frame NYHD7.mp4/000233.png
2025-02-06 12:34:33,942 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,943 - DEBUG - Found scene graph for frame NYHD7.mp4/000243.png
2025-02-06 12:34:33,943 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,943 - DEBUG - Found scene graph for frame NYHD7.mp4/000274.png
2025-02-06 12:34:33,943 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,943 - DEBUG - Found scene graph for frame NYHD7.mp4/000288.png
2025-02-06 12:34:33,944 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,944 - DEBUG - Found scene graph for frame NYHD7.mp4/000294.png
2025-02-06 12:34:33,944 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,945 - DEBUG - Found scene graph for frame NYHD7.mp4/000314.png
2025-02-06 12:34:33,945 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,946 - DEBUG - Found scene graph for frame NYHD7.mp4/000355.png
2025-02-06 12:34:33,948 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,949 - DEBUG - Found scene graph for frame NYHD7.mp4/000404.png
2025-02-06 12:34:33,950 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,950 - DEBUG - Found scene graph for frame NYHD7.mp4/000416.png
2025-02-06 12:34:33,951 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,951 - DEBUG - Found scene graph for frame NYHD7.mp4/000420.png
2025-02-06 12:34:33,951 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,952 - DEBUG - Found scene graph for frame NYHD7.mp4/000543.png
2025-02-06 12:34:33,952 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,952 - DEBUG - Found scene graph for frame NYHD7.mp4/000546.png
2025-02-06 12:34:33,952 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,952 - DEBUG - Found scene graph for frame NYHD7.mp4/000565.png
2025-02-06 12:34:33,953 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,953 - DEBUG - Found scene graph for frame NYHD7.mp4/000567.png
2025-02-06 12:34:33,953 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:34:33,953 - DEBUG - Found scene graph for frame NYHD7.mp4/000620.png
2025-02-06 12:34:33,954 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,954 - DEBUG - Found scene graph for frame NYHD7.mp4/000670.png
2025-02-06 12:34:33,954 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,954 - DEBUG - Found scene graph for frame NYHD7.mp4/000671.png
2025-02-06 12:34:33,954 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,954 - DEBUG - Found scene graph for frame NYHD7.mp4/000673.png
2025-02-06 12:34:33,955 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,955 - DEBUG - Found scene graph for frame NYHD7.mp4/000686.png
2025-02-06 12:34:33,956 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,956 - DEBUG - Found scene graph for frame NYHD7.mp4/000715.png
2025-02-06 12:34:33,956 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,956 - DEBUG - Found scene graph for frame NYHD7.mp4/000726.png
2025-02-06 12:34:33,957 - DEBUG - No valid objects found in annotations for frame NYHD7.mp4/000744.png
2025-02-06 12:34:33,957 - WARNING - No scene graph found for frame NYHD7.mp4/000744.png
2025-02-06 12:34:33,958 - DEBUG - No valid objects found in annotations for frame NYHD7.mp4/000772.png
2025-02-06 12:34:33,958 - WARNING - No scene graph found for frame NYHD7.mp4/000772.png
2025-02-06 12:34:33,959 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,959 - DEBUG - Found scene graph for frame NYHD7.mp4/000779.png
2025-02-06 12:34:33,960 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,960 - DEBUG - Found scene graph for frame NYHD7.mp4/000790.png
2025-02-06 12:34:33,965 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,966 - DEBUG - Found scene graph for frame NYHD7.mp4/000801.png
2025-02-06 12:34:33,966 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,966 - DEBUG - Found scene graph for frame NYHD7.mp4/000816.png
2025-02-06 12:34:33,967 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,967 - DEBUG - Found scene graph for frame NYHD7.mp4/000843.png
2025-02-06 12:34:33,967 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,967 - DEBUG - Found scene graph for frame NYHD7.mp4/000869.png
2025-02-06 12:34:33,968 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:33,968 - DEBUG - Found scene graph for frame NYHD7.mp4/000895.png
2025-02-06 12:34:33,968 - INFO - Extracted 37 scene graphs
2025-02-06 12:34:33,968 - INFO - Split 37 graphs chronologically into 29 train and 8 test
2025-02-06 12:34:33,968 - DEBUG - Training frames: NYHD7.mp4/000015.png to NYHD7.mp4/000715.png
2025-02-06 12:34:33,968 - DEBUG - Testing frames: NYHD7.mp4/000726.png to NYHD7.mp4/000895.png
2025-02-06 12:34:33,969 - INFO - Generating 8 sequential predictions using closed vocabulary
2025-02-06 12:34:33,969 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:34:33,969 - DEBUG - Starting with 29 training frames
2025-02-06 12:34:33,969 - DEBUG - Frame numbers: [15, 43, 71, 82, 99, 127, 161, 169, 192, 233, 243, 274, 288, 294, 314, 355, 404, 416, 420, 543, 546, 565, 567, 620, 670, 671, 673, 686, 715]
2025-02-06 12:34:33,969 - DEBUG - ============================

2025-02-06 12:34:33,970 - INFO - Found 10 test frames to predict after frame 715
2025-02-06 12:34:33,971 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:34:33,971 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:34:33,971 - DEBUG - Predicting 5 frames: [726, 744, 772, 779, 790]
2025-02-06 12:34:33,972 - DEBUG - Context has 29 frames
2025-02-06 12:34:33,972 - DEBUG - Last 3 context frames: [673, 686, 715]
2025-02-06 12:34:34,001 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000673:
Objects:
  - phone/camera
Relationships:
  - person unsure phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera

Frame 000686:
Objects:
  - phone/camera
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera

Frame 000715:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera

========================

2025-02-06 12:34:34,001 - DEBUG - 
=======PROMPT========

2025-02-06 12:34:34,001 - DEBUG - Given the sequence of scene graphs below, predict the next 5 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (29 frames, 15 to 715):
            
Frame 000015:
Objects:
  - table
Relationships:
  - person not_looking_at table
  - person in_front_of table
  - person not_contacting table


Frame 000043:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000071:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000082:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000099:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000127:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000161:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000169:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000192:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000233:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000243:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000274:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000288:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000294:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000314:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000355:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000404:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000416:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000420:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000543:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000546:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000565:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000567:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person on_the_side_of phone/camera
  - person holding phone/camera


Frame 000620:
Objects:
  - phone/camera
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person touching phone/camera


Frame 000670:
Objects:
  - phone/camera
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera


Frame 000671:
Objects:
  - phone/camera
Relationships:
  - person unsure phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera


Frame 000673:
Objects:
  - phone/camera
Relationships:
  - person unsure phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera


Frame 000686:
Objects:
  - phone/camera
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera


Frame 000715:
Objects:
  - phone/camera
Relationships:
  - person not_looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 5 frames ([726, 744, 772, 779, 790]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:34:34,002 - DEBUG - 
===================

2025-02-06 12:34:34,112 - ERROR - Prediction failed: 429 Resource has been exhausted (e.g. check quota).
2025-02-06 12:34:34,112 - ERROR - Failed to process video NYHD7.mp4: 429 Resource has been exhausted (e.g. check quota).
2025-02-06 12:34:34,113 - INFO - 
==================================================
Processing video: BPT87.mp4
==================================================
2025-02-06 12:34:34,113 - INFO - Processing video: BPT87.mp4
2025-02-06 12:34:34,114 - INFO - Found 40 frames for video BPT87.mp4
2025-02-06 12:34:34,115 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:34,115 - DEBUG - Found scene graph for frame BPT87.mp4/000205.png
2025-02-06 12:34:34,116 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:34,116 - DEBUG - Found scene graph for frame BPT87.mp4/000216.png
2025-02-06 12:34:34,116 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:34,116 - DEBUG - Found scene graph for frame BPT87.mp4/000221.png
2025-02-06 12:34:34,117 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:34:34,117 - DEBUG - Found scene graph for frame BPT87.mp4/000223.png
2025-02-06 12:34:34,117 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:34,117 - DEBUG - Found scene graph for frame BPT87.mp4/000226.png
2025-02-06 12:34:34,117 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:34,117 - DEBUG - Found scene graph for frame BPT87.mp4/000227.png
2025-02-06 12:34:34,118 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:34,118 - DEBUG - Found scene graph for frame BPT87.mp4/000230.png
2025-02-06 12:34:34,118 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:34,118 - DEBUG - Found scene graph for frame BPT87.mp4/000231.png
2025-02-06 12:34:34,119 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:34,119 - DEBUG - Found scene graph for frame BPT87.mp4/000242.png
2025-02-06 12:34:34,119 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,120 - DEBUG - Found scene graph for frame BPT87.mp4/000244.png
2025-02-06 12:34:34,120 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:34:34,121 - DEBUG - Found scene graph for frame BPT87.mp4/000245.png
2025-02-06 12:34:34,121 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:34:34,121 - DEBUG - Found scene graph for frame BPT87.mp4/000255.png
2025-02-06 12:34:34,121 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,121 - DEBUG - Found scene graph for frame BPT87.mp4/000261.png
2025-02-06 12:34:34,122 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:34:34,122 - DEBUG - Found scene graph for frame BPT87.mp4/000262.png
2025-02-06 12:34:34,122 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:34,122 - DEBUG - Found scene graph for frame BPT87.mp4/000263.png
2025-02-06 12:34:34,123 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,124 - DEBUG - Found scene graph for frame BPT87.mp4/000272.png
2025-02-06 12:34:34,124 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:34:34,124 - DEBUG - Found scene graph for frame BPT87.mp4/000279.png
2025-02-06 12:34:34,124 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:34:34,125 - DEBUG - Found scene graph for frame BPT87.mp4/000280.png
2025-02-06 12:34:34,125 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:34:34,125 - DEBUG - Found scene graph for frame BPT87.mp4/000281.png
2025-02-06 12:34:34,125 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,125 - DEBUG - Found scene graph for frame BPT87.mp4/000282.png
2025-02-06 12:34:34,125 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:34,126 - DEBUG - Found scene graph for frame BPT87.mp4/000299.png
2025-02-06 12:34:34,126 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:34,126 - DEBUG - Found scene graph for frame BPT87.mp4/000300.png
2025-02-06 12:34:34,126 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,126 - DEBUG - Found scene graph for frame BPT87.mp4/000302.png
2025-02-06 12:34:34,127 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:34,127 - DEBUG - Found scene graph for frame BPT87.mp4/000303.png
2025-02-06 12:34:34,127 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:34,127 - DEBUG - Found scene graph for frame BPT87.mp4/000326.png
2025-02-06 12:34:34,127 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:34:34,128 - DEBUG - Found scene graph for frame BPT87.mp4/000329.png
2025-02-06 12:34:34,128 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:34:34,128 - DEBUG - Found scene graph for frame BPT87.mp4/000333.png
2025-02-06 12:34:34,129 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:34,129 - DEBUG - Found scene graph for frame BPT87.mp4/000356.png
2025-02-06 12:34:34,130 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:34,130 - DEBUG - Found scene graph for frame BPT87.mp4/000385.png
2025-02-06 12:34:34,130 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:34,130 - DEBUG - Found scene graph for frame BPT87.mp4/000400.png
2025-02-06 12:34:34,131 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:34,132 - DEBUG - Found scene graph for frame BPT87.mp4/000411.png
2025-02-06 12:34:34,132 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:34,133 - DEBUG - Found scene graph for frame BPT87.mp4/000412.png
2025-02-06 12:34:34,133 - DEBUG - Extracted scene graph with 2 objects and 8 relationships
2025-02-06 12:34:34,133 - DEBUG - Found scene graph for frame BPT87.mp4/000421.png
2025-02-06 12:34:34,133 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:34,133 - DEBUG - Found scene graph for frame BPT87.mp4/000438.png
2025-02-06 12:34:34,134 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:34,134 - DEBUG - Found scene graph for frame BPT87.mp4/000441.png
2025-02-06 12:34:34,134 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,135 - DEBUG - Found scene graph for frame BPT87.mp4/000443.png
2025-02-06 12:34:34,135 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:34,135 - DEBUG - Found scene graph for frame BPT87.mp4/000465.png
2025-02-06 12:34:34,135 - DEBUG - No valid objects found in annotations for frame BPT87.mp4/000466.png
2025-02-06 12:34:34,135 - WARNING - No scene graph found for frame BPT87.mp4/000466.png
2025-02-06 12:34:34,135 - DEBUG - No valid objects found in annotations for frame BPT87.mp4/000469.png
2025-02-06 12:34:34,136 - WARNING - No scene graph found for frame BPT87.mp4/000469.png
2025-02-06 12:34:34,136 - DEBUG - No valid objects found in annotations for frame BPT87.mp4/000486.png
2025-02-06 12:34:34,136 - WARNING - No scene graph found for frame BPT87.mp4/000486.png
2025-02-06 12:34:34,136 - INFO - Extracted 37 scene graphs
2025-02-06 12:34:34,136 - INFO - Split 37 graphs chronologically into 29 train and 8 test
2025-02-06 12:34:34,137 - DEBUG - Training frames: BPT87.mp4/000205.png to BPT87.mp4/000385.png
2025-02-06 12:34:34,137 - DEBUG - Testing frames: BPT87.mp4/000400.png to BPT87.mp4/000465.png
2025-02-06 12:34:34,137 - INFO - Generating 8 sequential predictions using closed vocabulary
2025-02-06 12:34:34,137 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:34:34,137 - DEBUG - Starting with 29 training frames
2025-02-06 12:34:34,138 - DEBUG - Frame numbers: [205, 216, 221, 223, 226, 227, 230, 231, 242, 244, 245, 255, 261, 262, 263, 272, 279, 280, 281, 282, 299, 300, 302, 303, 326, 329, 333, 356, 385]
2025-02-06 12:34:34,138 - DEBUG - ============================

2025-02-06 12:34:34,138 - INFO - Found 11 test frames to predict after frame 385
2025-02-06 12:34:34,138 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:34:34,139 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:34:34,139 - DEBUG - Predicting 5 frames: [400, 411, 412, 421, 438]
2025-02-06 12:34:34,139 - DEBUG - Context has 29 frames
2025-02-06 12:34:34,139 - DEBUG - Last 3 context frames: [333, 356, 385]
2025-02-06 12:34:34,166 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000333:
Objects:
  - towel
  - clothes
  - broom
Relationships:
  - person not_looking_at towel
  - person in_front_of towel
  - person on_the_side_of towel
  - person holding towel
  - person not_looking_at clothes
  - person in_front_of clothes
  - person holding clothes
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom

Frame 000356:
Objects:
  - towel
  - broom
Relationships:
  - person not_looking_at towel
  - person in_front_of towel
  - person on_the_side_of towel
  - person other_relationship towel
  - person looking_at broom
  - person in_front_of broom
  - person holding broom

Frame 000385:
Objects:
  - broom
Relationships:
  - person looking_at broom
  - person in_front_of broom
  - person holding broom

========================

2025-02-06 12:34:34,166 - DEBUG - 
=======PROMPT========

2025-02-06 12:34:34,166 - DEBUG - Given the sequence of scene graphs below, predict the next 5 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (29 frames, 205 to 385):
            
Frame 000205:
Objects:
  - broom
Relationships:
  - person looking_at broom
  - person in_front_of broom
  - person not_contacting broom


Frame 000216:
Objects:
  - broom
Relationships:
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000221:
Objects:
  - broom
Relationships:
  - person not_looking_at broom
  - person in_front_of broom
  - person not_contacting broom


Frame 000223:
Objects:
  - broom
Relationships:
  - person not_looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person not_contacting broom


Frame 000226:
Objects:
  - broom
Relationships:
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000227:
Objects:
  - broom
Relationships:
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000230:
Objects:
  - broom
Relationships:
  - person not_looking_at broom
  - person in_front_of broom
  - person not_contacting broom


Frame 000231:
Objects:
  - broom
Relationships:
  - person not_looking_at broom
  - person in_front_of broom
  - person not_contacting broom


Frame 000242:
Objects:
  - towel
  - broom
Relationships:
  - person unsure towel
  - person in_front_of towel
  - person on_the_side_of towel
  - person holding towel
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000244:
Objects:
  - towel
  - broom
Relationships:
  - person not_looking_at towel
  - person in_front_of towel
  - person touching towel
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000245:
Objects:
  - towel
  - clothes
  - broom
Relationships:
  - person looking_at towel
  - person in_front_of towel
  - person holding towel
  - person unsure clothes
  - person in_front_of clothes
  - person holding clothes
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000255:
Objects:
  - towel
Relationships:
  - person looking_at towel
  - person in_front_of towel
  - person holding towel
  - person touching towel


Frame 000261:
Objects:
  - towel
  - broom
Relationships:
  - person looking_at towel
  - person in_front_of towel
  - person holding towel
  - person looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000262:
Objects:
  - towel
  - clothes
  - broom
Relationships:
  - person looking_at towel
  - person in_front_of towel
  - person holding towel
  - person unsure clothes
  - person in_front_of clothes
  - person holding clothes
  - person not_looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000263:
Objects:
  - towel
  - broom
Relationships:
  - person looking_at towel
  - person in_front_of towel
  - person on_the_side_of towel
  - person holding towel
  - person unsure broom
  - person in_front_of broom
  - person holding broom


Frame 000272:
Objects:
  - towel
  - broom
Relationships:
  - person looking_at towel
  - person in_front_of towel
  - person holding towel
  - person looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000279:
Objects:
  - towel
  - broom
Relationships:
  - person looking_at towel
  - person beneath towel
  - person in_front_of towel
  - person holding towel
  - person looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000280:
Objects:
  - towel
  - clothes
  - broom
Relationships:
  - person looking_at towel
  - person in_front_of towel
  - person holding towel
  - person looking_at clothes
  - person in_front_of clothes
  - person holding clothes
  - person looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000281:
Objects:
  - towel
  - broom
Relationships:
  - person not_looking_at towel
  - person in_front_of towel
  - person beneath towel
  - person on_the_side_of towel
  - person holding towel
  - person looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000282:
Objects:
  - towel
  - broom
Relationships:
  - person looking_at towel
  - person in_front_of towel
  - person holding towel
  - person looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000299:
Objects:
  - towel
  - broom
Relationships:
  - person looking_at towel
  - person in_front_of towel
  - person holding towel
  - person touching towel
  - person looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000300:
Objects:
  - towel
  - broom
Relationships:
  - person looking_at towel
  - person in_front_of towel
  - person on_the_side_of towel
  - person holding towel
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000302:
Objects:
  - towel
  - broom
Relationships:
  - person looking_at towel
  - person on_the_side_of towel
  - person holding towel
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000303:
Objects:
  - towel
  - broom
Relationships:
  - person looking_at towel
  - person in_front_of towel
  - person on_the_side_of towel
  - person holding towel
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000326:
Objects:
  - towel
  - broom
Relationships:
  - person not_looking_at towel
  - person in_front_of towel
  - person on_the_side_of towel
  - person holding towel
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000329:
Objects:
  - towel
  - broom
Relationships:
  - person not_looking_at towel
  - person in_front_of towel
  - person on_the_side_of towel
  - person holding towel
  - person looking_at broom
  - person in_front_of broom
  - person on_the_side_of broom
  - person holding broom


Frame 000333:
Objects:
  - towel
  - clothes
  - broom
Relationships:
  - person not_looking_at towel
  - person in_front_of towel
  - person on_the_side_of towel
  - person holding towel
  - person not_looking_at clothes
  - person in_front_of clothes
  - person holding clothes
  - person not_looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000356:
Objects:
  - towel
  - broom
Relationships:
  - person not_looking_at towel
  - person in_front_of towel
  - person on_the_side_of towel
  - person other_relationship towel
  - person looking_at broom
  - person in_front_of broom
  - person holding broom


Frame 000385:
Objects:
  - broom
Relationships:
  - person looking_at broom
  - person in_front_of broom
  - person holding broom

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 5 frames ([400, 411, 412, 421, 438]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:34:34,167 - DEBUG - 
===================

2025-02-06 12:34:34,240 - ERROR - Prediction failed: 429 Resource has been exhausted (e.g. check quota).
2025-02-06 12:34:34,240 - ERROR - Failed to process video BPT87.mp4: 429 Resource has been exhausted (e.g. check quota).
2025-02-06 12:34:34,241 - INFO - 
==================================================
Processing video: 3G4PN.mp4
==================================================
2025-02-06 12:34:34,241 - INFO - Processing video: 3G4PN.mp4
2025-02-06 12:34:34,243 - INFO - Found 39 frames for video 3G4PN.mp4
2025-02-06 12:34:34,243 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,244 - DEBUG - Found scene graph for frame 3G4PN.mp4/000079.png
2025-02-06 12:34:34,244 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,244 - DEBUG - Found scene graph for frame 3G4PN.mp4/000082.png
2025-02-06 12:34:34,244 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,245 - DEBUG - Found scene graph for frame 3G4PN.mp4/000083.png
2025-02-06 12:34:34,245 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,245 - DEBUG - Found scene graph for frame 3G4PN.mp4/000234.png
2025-02-06 12:34:34,245 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,246 - DEBUG - Found scene graph for frame 3G4PN.mp4/000244.png
2025-02-06 12:34:34,246 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,247 - DEBUG - Found scene graph for frame 3G4PN.mp4/000246.png
2025-02-06 12:34:34,247 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,247 - DEBUG - Found scene graph for frame 3G4PN.mp4/000390.png
2025-02-06 12:34:34,247 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,247 - DEBUG - Found scene graph for frame 3G4PN.mp4/000406.png
2025-02-06 12:34:34,248 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,248 - DEBUG - Found scene graph for frame 3G4PN.mp4/000409.png
2025-02-06 12:34:34,248 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,248 - DEBUG - Found scene graph for frame 3G4PN.mp4/000545.png
2025-02-06 12:34:34,249 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,249 - DEBUG - Found scene graph for frame 3G4PN.mp4/000568.png
2025-02-06 12:34:34,249 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,249 - DEBUG - Found scene graph for frame 3G4PN.mp4/000570.png
2025-02-06 12:34:34,250 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,250 - DEBUG - Found scene graph for frame 3G4PN.mp4/000572.png
2025-02-06 12:34:34,250 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,251 - DEBUG - Found scene graph for frame 3G4PN.mp4/000599.png
2025-02-06 12:34:34,251 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,251 - DEBUG - Found scene graph for frame 3G4PN.mp4/000628.png
2025-02-06 12:34:34,251 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:34:34,252 - DEBUG - Found scene graph for frame 3G4PN.mp4/000654.png
2025-02-06 12:34:34,252 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:34:34,252 - DEBUG - Found scene graph for frame 3G4PN.mp4/000655.png
2025-02-06 12:34:34,252 - DEBUG - Extracted scene graph with 3 objects and 10 relationships
2025-02-06 12:34:34,252 - DEBUG - Found scene graph for frame 3G4PN.mp4/000657.png
2025-02-06 12:34:34,252 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:34:34,253 - DEBUG - Found scene graph for frame 3G4PN.mp4/000673.png
2025-02-06 12:34:34,253 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:34:34,253 - DEBUG - Found scene graph for frame 3G4PN.mp4/000678.png
2025-02-06 12:34:34,254 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:34:34,254 - DEBUG - Found scene graph for frame 3G4PN.mp4/000686.png
2025-02-06 12:34:34,254 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:34:34,254 - DEBUG - Found scene graph for frame 3G4PN.mp4/000689.png
2025-02-06 12:34:34,254 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:34:34,255 - DEBUG - Found scene graph for frame 3G4PN.mp4/000691.png
2025-02-06 12:34:34,255 - DEBUG - Extracted scene graph with 3 objects and 9 relationships
2025-02-06 12:34:34,255 - DEBUG - Found scene graph for frame 3G4PN.mp4/000700.png
2025-02-06 12:34:34,256 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,256 - DEBUG - Found scene graph for frame 3G4PN.mp4/000710.png
2025-02-06 12:34:34,256 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,256 - DEBUG - Found scene graph for frame 3G4PN.mp4/000712.png
2025-02-06 12:34:34,257 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,257 - DEBUG - Found scene graph for frame 3G4PN.mp4/000722.png
2025-02-06 12:34:34,257 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:34,257 - DEBUG - Found scene graph for frame 3G4PN.mp4/000728.png
2025-02-06 12:34:34,257 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,258 - DEBUG - Found scene graph for frame 3G4PN.mp4/000730.png
2025-02-06 12:34:34,258 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,258 - DEBUG - Found scene graph for frame 3G4PN.mp4/000732.png
2025-02-06 12:34:34,258 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:34,259 - DEBUG - Found scene graph for frame 3G4PN.mp4/000735.png
2025-02-06 12:34:34,259 - DEBUG - No valid objects found in annotations for frame 3G4PN.mp4/000745.png
2025-02-06 12:34:34,259 - WARNING - No scene graph found for frame 3G4PN.mp4/000745.png
2025-02-06 12:34:34,259 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:34:34,259 - DEBUG - Found scene graph for frame 3G4PN.mp4/000750.png
2025-02-06 12:34:34,260 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:34,260 - DEBUG - Found scene graph for frame 3G4PN.mp4/000753.png
2025-02-06 12:34:34,260 - DEBUG - No valid objects found in annotations for frame 3G4PN.mp4/000765.png
2025-02-06 12:34:34,260 - WARNING - No scene graph found for frame 3G4PN.mp4/000765.png
2025-02-06 12:34:34,261 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:34,261 - DEBUG - Found scene graph for frame 3G4PN.mp4/000774.png
2025-02-06 12:34:34,261 - DEBUG - No valid objects found in annotations for frame 3G4PN.mp4/000788.png
2025-02-06 12:34:34,261 - WARNING - No scene graph found for frame 3G4PN.mp4/000788.png
2025-02-06 12:34:34,261 - DEBUG - No valid objects found in annotations for frame 3G4PN.mp4/000802.png
2025-02-06 12:34:34,261 - WARNING - No scene graph found for frame 3G4PN.mp4/000802.png
2025-02-06 12:34:34,262 - DEBUG - No valid objects found in annotations for frame 3G4PN.mp4/000827.png
2025-02-06 12:34:34,263 - WARNING - No scene graph found for frame 3G4PN.mp4/000827.png
2025-02-06 12:34:34,263 - INFO - Extracted 34 scene graphs
2025-02-06 12:34:34,263 - INFO - Split 34 graphs chronologically into 27 train and 7 test
2025-02-06 12:34:34,263 - DEBUG - Training frames: 3G4PN.mp4/000079.png to 3G4PN.mp4/000722.png
2025-02-06 12:34:34,263 - DEBUG - Testing frames: 3G4PN.mp4/000728.png to 3G4PN.mp4/000774.png
2025-02-06 12:34:34,264 - INFO - Generating 7 sequential predictions using closed vocabulary
2025-02-06 12:34:34,264 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:34:34,264 - DEBUG - Starting with 27 training frames
2025-02-06 12:34:34,264 - DEBUG - Frame numbers: [79, 82, 83, 234, 244, 246, 390, 406, 409, 545, 568, 570, 572, 599, 628, 654, 655, 657, 673, 678, 686, 689, 691, 700, 710, 712, 722]
2025-02-06 12:34:34,264 - DEBUG - ============================

2025-02-06 12:34:34,265 - INFO - Found 12 test frames to predict after frame 722
2025-02-06 12:34:34,265 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:34:34,265 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:34:34,265 - DEBUG - Predicting 5 frames: [728, 730, 732, 735, 745]
2025-02-06 12:34:34,265 - DEBUG - Context has 27 frames
2025-02-06 12:34:34,266 - DEBUG - Last 3 context frames: [710, 712, 722]
2025-02-06 12:34:34,281 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000710:
Objects:
  - bag
  - bed
Relationships:
  - person looking_at bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed

Frame 000712:
Objects:
  - bag
  - bed
Relationships:
  - person not_looking_at bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed

Frame 000722:
Objects:
  - bag
  - bed
Relationships:
  - person looking_at bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person other_relationship bed

========================

2025-02-06 12:34:34,281 - DEBUG - 
=======PROMPT========

2025-02-06 12:34:34,281 - DEBUG - Given the sequence of scene graphs below, predict the next 5 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (27 frames, 79 to 722):
            
Frame 000079:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000082:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000083:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000234:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000244:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000246:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000390:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000406:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000409:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000545:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000568:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000570:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000572:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000599:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000628:
Objects:
  - phone/camera
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000654:
Objects:
  - phone/camera
  - bag
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person unsure bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000655:
Objects:
  - phone/camera
  - bag
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person unsure bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000657:
Objects:
  - phone/camera
  - bag
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bag
  - person in_front_of bag
  - person on_the_side_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000673:
Objects:
  - phone/camera
  - bag
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000678:
Objects:
  - phone/camera
  - bag
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bag
  - person in_front_of bag
  - person not_contacting bag
  - person unsure bed
  - person beneath bed
  - person lying_on bed


Frame 000686:
Objects:
  - phone/camera
  - bag
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person unsure bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000689:
Objects:
  - phone/camera
  - bag
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person unsure bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000691:
Objects:
  - phone/camera
  - bag
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person not_looking_at bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000700:
Objects:
  - phone/camera
  - bag
  - bed
Relationships:
  - person looking_at phone/camera
  - person in_front_of phone/camera
  - person holding phone/camera
  - person unsure bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000710:
Objects:
  - bag
  - bed
Relationships:
  - person looking_at bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000712:
Objects:
  - bag
  - bed
Relationships:
  - person not_looking_at bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person sitting_on bed


Frame 000722:
Objects:
  - bag
  - bed
Relationships:
  - person looking_at bag
  - person in_front_of bag
  - person not_contacting bag
  - person not_looking_at bed
  - person beneath bed
  - person other_relationship bed

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 5 frames ([728, 730, 732, 735, 745]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:34:34,282 - DEBUG - 
===================

2025-02-06 12:34:34,367 - ERROR - Prediction failed: 429 Resource has been exhausted (e.g. check quota).
2025-02-06 12:34:34,367 - ERROR - Failed to process video 3G4PN.mp4: 429 Resource has been exhausted (e.g. check quota).
2025-02-06 12:34:34,367 - INFO - 
==================================================
Processing video: RXED2.mp4
==================================================
2025-02-06 12:34:34,367 - INFO - Processing video: RXED2.mp4
2025-02-06 12:34:34,368 - INFO - Found 10 frames for video RXED2.mp4
2025-02-06 12:34:34,369 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:34:34,369 - DEBUG - Found scene graph for frame RXED2.mp4/000094.png
2025-02-06 12:34:34,369 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:34:34,370 - DEBUG - Found scene graph for frame RXED2.mp4/000281.png
2025-02-06 12:34:34,370 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:34:34,370 - DEBUG - Found scene graph for frame RXED2.mp4/000347.png
2025-02-06 12:34:34,370 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:34:34,370 - DEBUG - Found scene graph for frame RXED2.mp4/000380.png
2025-02-06 12:34:34,371 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:34:34,371 - DEBUG - Found scene graph for frame RXED2.mp4/000414.png
2025-02-06 12:34:34,371 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:34:34,371 - DEBUG - Found scene graph for frame RXED2.mp4/000447.png
2025-02-06 12:34:34,372 - DEBUG - Extracted scene graph with 3 objects and 11 relationships
2025-02-06 12:34:34,372 - DEBUG - Found scene graph for frame RXED2.mp4/000468.png
2025-02-06 12:34:34,372 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:34:34,372 - DEBUG - Found scene graph for frame RXED2.mp4/000480.png
2025-02-06 12:34:34,373 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,373 - DEBUG - Found scene graph for frame RXED2.mp4/000655.png
2025-02-06 12:34:34,373 - DEBUG - Extracted scene graph with 3 objects and 12 relationships
2025-02-06 12:34:34,373 - DEBUG - Found scene graph for frame RXED2.mp4/000842.png
2025-02-06 12:34:34,373 - INFO - Extracted 10 scene graphs
2025-02-06 12:34:34,374 - INFO - Split 10 graphs chronologically into 8 train and 2 test
2025-02-06 12:34:34,374 - DEBUG - Training frames: RXED2.mp4/000094.png to RXED2.mp4/000480.png
2025-02-06 12:34:34,374 - DEBUG - Testing frames: RXED2.mp4/000655.png to RXED2.mp4/000842.png
2025-02-06 12:34:34,374 - INFO - Generating 2 sequential predictions using closed vocabulary
2025-02-06 12:34:34,374 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:34:34,375 - DEBUG - Starting with 8 training frames
2025-02-06 12:34:34,375 - DEBUG - Frame numbers: [94, 281, 347, 380, 414, 447, 468, 480]
2025-02-06 12:34:34,375 - DEBUG - ============================

2025-02-06 12:34:34,375 - INFO - Found 2 test frames to predict after frame 480
2025-02-06 12:34:34,375 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:34:34,376 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:34:34,376 - DEBUG - Predicting 2 frames: [655, 842]
2025-02-06 12:34:34,376 - DEBUG - Context has 8 frames
2025-02-06 12:34:34,376 - DEBUG - Last 3 context frames: [447, 468, 480]
2025-02-06 12:34:34,384 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000447:
Objects:
  - sofa/couch
  - book
  - paper/notebook
Relationships:
  - person not_looking_at sofa/couch
  - person behind sofa/couch
  - person beneath sofa/couch
  - person sitting_on sofa/couch
  - person leaning_on sofa/couch
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook

Frame 000468:
Objects:
  - sofa/couch
  - book
  - paper/notebook
Relationships:
  - person not_looking_at sofa/couch
  - person beneath sofa/couch
  - person behind sofa/couch
  - person leaning_on sofa/couch
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook

Frame 000480:
Objects:
  - sofa/couch
  - book
  - paper/notebook
Relationships:
  - person not_looking_at sofa/couch
  - person beneath sofa/couch
  - person behind sofa/couch
  - person sitting_on sofa/couch
  - person leaning_on sofa/couch
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person writing_on paper/notebook

========================

2025-02-06 12:34:34,385 - DEBUG - 
=======PROMPT========

2025-02-06 12:34:34,385 - DEBUG - Given the sequence of scene graphs below, predict the next 2 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (8 frames, 94 to 480):
            
Frame 000094:
Objects:
  - sofa/couch
  - book
  - paper/notebook
Relationships:
  - person not_looking_at sofa/couch
  - person beneath sofa/couch
  - person behind sofa/couch
  - person sitting_on sofa/couch
  - person leaning_on sofa/couch
  - person looking_at book
  - person in_front_of book
  - person touching book
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person writing_on paper/notebook


Frame 000281:
Objects:
  - sofa/couch
  - book
  - paper/notebook
Relationships:
  - person not_looking_at sofa/couch
  - person behind sofa/couch
  - person beneath sofa/couch
  - person sitting_on sofa/couch
  - person leaning_on sofa/couch
  - person looking_at book
  - person in_front_of book
  - person touching book
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000347:
Objects:
  - sofa/couch
  - book
  - paper/notebook
Relationships:
  - person not_looking_at sofa/couch
  - person beneath sofa/couch
  - person behind sofa/couch
  - person sitting_on sofa/couch
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000380:
Objects:
  - sofa/couch
  - book
  - paper/notebook
Relationships:
  - person not_looking_at sofa/couch
  - person beneath sofa/couch
  - person behind sofa/couch
  - person sitting_on sofa/couch
  - person leaning_on sofa/couch
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000414:
Objects:
  - sofa/couch
  - book
  - paper/notebook
Relationships:
  - person not_looking_at sofa/couch
  - person beneath sofa/couch
  - person behind sofa/couch
  - person sitting_on sofa/couch
  - person leaning_on sofa/couch
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000447:
Objects:
  - sofa/couch
  - book
  - paper/notebook
Relationships:
  - person not_looking_at sofa/couch
  - person behind sofa/couch
  - person beneath sofa/couch
  - person sitting_on sofa/couch
  - person leaning_on sofa/couch
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000468:
Objects:
  - sofa/couch
  - book
  - paper/notebook
Relationships:
  - person not_looking_at sofa/couch
  - person beneath sofa/couch
  - person behind sofa/couch
  - person leaning_on sofa/couch
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person holding paper/notebook


Frame 000480:
Objects:
  - sofa/couch
  - book
  - paper/notebook
Relationships:
  - person not_looking_at sofa/couch
  - person beneath sofa/couch
  - person behind sofa/couch
  - person sitting_on sofa/couch
  - person leaning_on sofa/couch
  - person looking_at book
  - person in_front_of book
  - person holding book
  - person touching book
  - person looking_at paper/notebook
  - person in_front_of paper/notebook
  - person writing_on paper/notebook

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 2 frames ([655, 842]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:34:34,386 - DEBUG - 
===================

2025-02-06 12:34:34,465 - ERROR - Prediction failed: 429 Resource has been exhausted (e.g. check quota).
2025-02-06 12:34:34,466 - ERROR - Failed to process video RXED2.mp4: 429 Resource has been exhausted (e.g. check quota).
2025-02-06 12:34:34,466 - INFO - 
==================================================
Processing video: A42EF.mp4
==================================================
2025-02-06 12:34:34,466 - INFO - Processing video: A42EF.mp4
2025-02-06 12:34:34,468 - INFO - Found 45 frames for video A42EF.mp4
2025-02-06 12:34:34,468 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000052.png
2025-02-06 12:34:34,469 - WARNING - No scene graph found for frame A42EF.mp4/000052.png
2025-02-06 12:34:34,470 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000063.png
2025-02-06 12:34:34,470 - WARNING - No scene graph found for frame A42EF.mp4/000063.png
2025-02-06 12:34:34,472 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000083.png
2025-02-06 12:34:34,473 - WARNING - No scene graph found for frame A42EF.mp4/000083.png
2025-02-06 12:34:34,473 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000090.png
2025-02-06 12:34:34,474 - WARNING - No scene graph found for frame A42EF.mp4/000090.png
2025-02-06 12:34:34,475 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000093.png
2025-02-06 12:34:34,475 - WARNING - No scene graph found for frame A42EF.mp4/000093.png
2025-02-06 12:34:34,475 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,475 - DEBUG - Found scene graph for frame A42EF.mp4/000113.png
2025-02-06 12:34:34,475 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:34,476 - DEBUG - Found scene graph for frame A42EF.mp4/000118.png
2025-02-06 12:34:34,476 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,476 - DEBUG - Found scene graph for frame A42EF.mp4/000140.png
2025-02-06 12:34:34,476 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,476 - DEBUG - Found scene graph for frame A42EF.mp4/000143.png
2025-02-06 12:34:34,477 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,477 - DEBUG - Found scene graph for frame A42EF.mp4/000145.png
2025-02-06 12:34:34,477 - DEBUG - Extracted scene graph with 2 objects and 7 relationships
2025-02-06 12:34:34,478 - DEBUG - Found scene graph for frame A42EF.mp4/000172.png
2025-02-06 12:34:34,478 - DEBUG - Extracted scene graph with 2 objects and 6 relationships
2025-02-06 12:34:34,478 - DEBUG - Found scene graph for frame A42EF.mp4/000174.png
2025-02-06 12:34:34,479 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:34,480 - DEBUG - Found scene graph for frame A42EF.mp4/000187.png
2025-02-06 12:34:34,481 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000218.png
2025-02-06 12:34:34,482 - WARNING - No scene graph found for frame A42EF.mp4/000218.png
2025-02-06 12:34:34,482 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000233.png
2025-02-06 12:34:34,482 - WARNING - No scene graph found for frame A42EF.mp4/000233.png
2025-02-06 12:34:34,483 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000235.png
2025-02-06 12:34:34,483 - WARNING - No scene graph found for frame A42EF.mp4/000235.png
2025-02-06 12:34:34,483 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000255.png
2025-02-06 12:34:34,483 - WARNING - No scene graph found for frame A42EF.mp4/000255.png
2025-02-06 12:34:34,483 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:34,484 - DEBUG - Found scene graph for frame A42EF.mp4/000273.png
2025-02-06 12:34:34,484 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000276.png
2025-02-06 12:34:34,484 - WARNING - No scene graph found for frame A42EF.mp4/000276.png
2025-02-06 12:34:34,485 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000280.png
2025-02-06 12:34:34,485 - WARNING - No scene graph found for frame A42EF.mp4/000280.png
2025-02-06 12:34:34,485 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:34,485 - DEBUG - Found scene graph for frame A42EF.mp4/000293.png
2025-02-06 12:34:34,485 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:34,486 - DEBUG - Found scene graph for frame A42EF.mp4/000317.png
2025-02-06 12:34:34,486 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000331.png
2025-02-06 12:34:34,486 - WARNING - No scene graph found for frame A42EF.mp4/000331.png
2025-02-06 12:34:34,486 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000336.png
2025-02-06 12:34:34,486 - WARNING - No scene graph found for frame A42EF.mp4/000336.png
2025-02-06 12:34:34,486 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000358.png
2025-02-06 12:34:34,487 - WARNING - No scene graph found for frame A42EF.mp4/000358.png
2025-02-06 12:34:34,487 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000368.png
2025-02-06 12:34:34,487 - WARNING - No scene graph found for frame A42EF.mp4/000368.png
2025-02-06 12:34:34,487 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000399.png
2025-02-06 12:34:34,488 - WARNING - No scene graph found for frame A42EF.mp4/000399.png
2025-02-06 12:34:34,488 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000400.png
2025-02-06 12:34:34,488 - WARNING - No scene graph found for frame A42EF.mp4/000400.png
2025-02-06 12:34:34,488 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000402.png
2025-02-06 12:34:34,489 - WARNING - No scene graph found for frame A42EF.mp4/000402.png
2025-02-06 12:34:34,489 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000463.png
2025-02-06 12:34:34,489 - WARNING - No scene graph found for frame A42EF.mp4/000463.png
2025-02-06 12:34:34,489 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:34,490 - DEBUG - Found scene graph for frame A42EF.mp4/000477.png
2025-02-06 12:34:34,490 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000526.png
2025-02-06 12:34:34,490 - WARNING - No scene graph found for frame A42EF.mp4/000526.png
2025-02-06 12:34:34,490 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000546.png
2025-02-06 12:34:34,490 - WARNING - No scene graph found for frame A42EF.mp4/000546.png
2025-02-06 12:34:34,491 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000553.png
2025-02-06 12:34:34,491 - WARNING - No scene graph found for frame A42EF.mp4/000553.png
2025-02-06 12:34:34,491 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000592.png
2025-02-06 12:34:34,491 - WARNING - No scene graph found for frame A42EF.mp4/000592.png
2025-02-06 12:34:34,492 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000604.png
2025-02-06 12:34:34,492 - WARNING - No scene graph found for frame A42EF.mp4/000604.png
2025-02-06 12:34:34,492 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000628.png
2025-02-06 12:34:34,492 - WARNING - No scene graph found for frame A42EF.mp4/000628.png
2025-02-06 12:34:34,493 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000640.png
2025-02-06 12:34:34,493 - WARNING - No scene graph found for frame A42EF.mp4/000640.png
2025-02-06 12:34:34,494 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000662.png
2025-02-06 12:34:34,494 - WARNING - No scene graph found for frame A42EF.mp4/000662.png
2025-02-06 12:34:34,494 - DEBUG - No valid objects found in annotations for frame A42EF.mp4/000688.png
2025-02-06 12:34:34,495 - WARNING - No scene graph found for frame A42EF.mp4/000688.png
2025-02-06 12:34:34,495 - DEBUG - Extracted scene graph with 1 objects and 4 relationships
2025-02-06 12:34:34,495 - DEBUG - Found scene graph for frame A42EF.mp4/000703.png
2025-02-06 12:34:34,495 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:34,501 - DEBUG - Found scene graph for frame A42EF.mp4/000720.png
2025-02-06 12:34:34,502 - DEBUG - Extracted scene graph with 1 objects and 5 relationships
2025-02-06 12:34:34,502 - DEBUG - Found scene graph for frame A42EF.mp4/000735.png
2025-02-06 12:34:34,502 - DEBUG - Extracted scene graph with 1 objects and 5 relationships
2025-02-06 12:34:34,502 - DEBUG - Found scene graph for frame A42EF.mp4/000778.png
2025-02-06 12:34:34,502 - DEBUG - Extracted scene graph with 1 objects and 3 relationships
2025-02-06 12:34:34,502 - DEBUG - Found scene graph for frame A42EF.mp4/000783.png
2025-02-06 12:34:34,503 - INFO - Extracted 17 scene graphs
2025-02-06 12:34:34,503 - INFO - Split 17 graphs chronologically into 13 train and 4 test
2025-02-06 12:34:34,503 - DEBUG - Training frames: A42EF.mp4/000113.png to A42EF.mp4/000703.png
2025-02-06 12:34:34,503 - DEBUG - Testing frames: A42EF.mp4/000720.png to A42EF.mp4/000783.png
2025-02-06 12:34:34,504 - INFO - Generating 4 sequential predictions using closed vocabulary
2025-02-06 12:34:34,504 - DEBUG - 
=======INITIAL CONTEXT========
2025-02-06 12:34:34,504 - DEBUG - Starting with 13 training frames
2025-02-06 12:34:34,504 - DEBUG - Frame numbers: [113, 118, 140, 143, 145, 172, 174, 187, 273, 293, 317, 477, 703]
2025-02-06 12:34:34,504 - DEBUG - ============================

2025-02-06 12:34:34,505 - INFO - Found 4 test frames to predict after frame 703
2025-02-06 12:34:34,505 - DEBUG - Vocabulary context: Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on
2025-02-06 12:34:34,505 - DEBUG - 
=======BATCH PREDICTION 1========
2025-02-06 12:34:34,505 - DEBUG - Predicting 4 frames: [720, 735, 778, 783]
2025-02-06 12:34:34,506 - DEBUG - Context has 13 frames
2025-02-06 12:34:34,506 - DEBUG - Last 3 context frames: [317, 477, 703]
2025-02-06 12:34:34,516 - DEBUG - 
=======CONTEXT DETAILS========

Frame 000317:
Objects:
  - cup/glass/bottle
Relationships:
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle

Frame 000477:
Objects:
  - cup/glass/bottle
Relationships:
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle

Frame 000703:
Objects:
  - cup/glass/bottle
Relationships:
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle
  - person touching cup/glass/bottle

========================

2025-02-06 12:34:34,516 - DEBUG - 
=======PROMPT========

2025-02-06 12:34:34,516 - DEBUG - Given the sequence of scene graphs below, predict the next 4 scene graphs that naturally follow.
            
            Available objects: person, bag, bed, blanket, book, box, broom, chair, closet_cabinet, clothes, cup_glass_bottle, dish, door, doorknob, doorway, floor, food, groceries, laptop, light, medicine, mirror, paper_notebook, phone_camera, picture, pillow, refrigerator, sandwich, shelf, shoe, sofa_couch, table, television, towel, vacuum, window
Available relationships: looking_at, not_looking_at, unsure, above, beneath, in_front_of, behind, on_the_side_of, in_front_of, carrying, covered_by, drinking_from, eating, have_on_the_back, holding, leaning_on, lying_on, not_contacting, other_relationship, sitting_on, standing_on, touching, twisting, wearing, wiping, writing_on

            Previous frames context (13 frames, 113 to 703):
            
Frame 000113:
Objects:
  - door
  - doorway
Relationships:
  - person not_looking_at door
  - person on_the_side_of door
  - person not_contacting door
  - person not_looking_at doorway
  - person in doorway
  - person not_contacting doorway


Frame 000118:
Objects:
  - door
  - doorway
Relationships:
  - person not_looking_at door
  - person on_the_side_of door
  - person in_front_of door
  - person not_contacting door
  - person not_looking_at doorway
  - person in doorway
  - person not_contacting doorway


Frame 000140:
Objects:
  - door
  - doorway
Relationships:
  - person unsure door
  - person on_the_side_of door
  - person not_contacting door
  - person not_looking_at doorway
  - person in doorway
  - person touching doorway


Frame 000143:
Objects:
  - door
  - doorway
Relationships:
  - person unsure door
  - person on_the_side_of door
  - person not_contacting door
  - person not_looking_at doorway
  - person in doorway
  - person touching doorway


Frame 000145:
Objects:
  - door
  - doorway
Relationships:
  - person unsure door
  - person on_the_side_of door
  - person not_contacting door
  - person not_looking_at doorway
  - person in doorway
  - person touching doorway


Frame 000172:
Objects:
  - door
  - doorway
Relationships:
  - person looking_at door
  - person in_front_of door
  - person not_contacting door
  - person not_looking_at doorway
  - person on_the_side_of doorway
  - person behind doorway
  - person touching doorway


Frame 000174:
Objects:
  - door
  - doorway
Relationships:
  - person not_looking_at door
  - person on_the_side_of door
  - person touching door
  - person not_looking_at doorway
  - person in doorway
  - person touching doorway


Frame 000187:
Objects:
  - door
Relationships:
  - person not_looking_at door
  - person on_the_side_of door
  - person touching door


Frame 000273:
Objects:
  - doorknob
Relationships:
  - person looking_at doorknob
  - person in_front_of doorknob
  - person touching doorknob


Frame 000293:
Objects:
  - doorknob
Relationships:
  - person unsure doorknob
  - person in_front_of doorknob
  - person touching doorknob


Frame 000317:
Objects:
  - cup/glass/bottle
Relationships:
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle


Frame 000477:
Objects:
  - cup/glass/bottle
Relationships:
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle


Frame 000703:
Objects:
  - cup/glass/bottle
Relationships:
  - person not_looking_at cup/glass/bottle
  - person in_front_of cup/glass/bottle
  - person holding cup/glass/bottle
  - person touching cup/glass/bottle

            
            Guidelines for predictions:
            1. Temporal Continuity:
               - Actions and movements should progress naturally from previous frames
               - Consider the direction and speed of ongoing actions
               - Maintain logical transitions between frames
            
            2. Object Persistence and Change:
               - Track existing objects' positions and states
               - Objects shouldn't disappear without reason
               - New objects can appear if contextually appropriate
            
            3. Relationship Evolution:
               - Update spatial relationships as objects move
               - Consider changing attention and interactions
               - Maintain realistic human behavior patterns
            
            4. Scene Dynamics:
               - Capture ongoing activities and their progression
               - Allow for natural changes in focus and attention
               - Consider multiple simultaneous interactions
            
            Predict the next 4 frames ([720, 735, 778, 783]), maintaining natural progression and temporal coherence.
            Return ONLY a JSON array of scene graphs:
            [
                {
                    "frame_num": <frame_number>,
                    "scene_graph": {
                        "objects": [
                            {"object": "<object_name>", "attributes": []},
                        ],
                        "relationships": [
                            {"subject": "<object1>", "predicate": "<relationship>", "object": "<object2>"}
                        ]
                    }
                },
                ...
            ]
            Focus on natural progression and meaningful changes between frames while maintaining scene consistency.
            IMPORTANT: Do not include any other text or formatting, just the JSON array.
2025-02-06 12:34:34,516 - DEBUG - 
===================

2025-02-06 12:34:34,658 - ERROR - Prediction failed: 429 Resource has been exhausted (e.g. check quota).
2025-02-06 12:34:34,659 - ERROR - Failed to process video A42EF.mp4: 429 Resource has been exhausted (e.g. check quota).
2025-02-06 12:34:34,660 - INFO - Pipeline completed successfully
